"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[29641],{35318:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var o=n(27378);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=o.createContext({}),i=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=i(e.components);return o.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=i(n),m=a,h=u["".concat(c,".").concat(m)]||u[m]||d[m]||r;return n?o.createElement(h,s(s({ref:t},p),{},{components:n})):o.createElement(h,s({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var i=2;i<r;i++)s[i]=n[i];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},17465:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>f,contentTitle:()=>m,default:()=>b,frontMatter:()=>u,metadata:()=>h,toc:()=>g});var o=n(35318),a=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,p=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&p(e,n,t[n]);if(l)for(var n of l(t))i.call(t,n)&&p(e,n,t[n]);return e};const u={},m=void 0,h={unversionedId:"coding/Languages/JS/React/react-howto",id:"coding/Languages/JS/React/react-howto",title:"react-howto",description:"- forceUpdate",source:"@site/my-documents/docs/coding/Languages/JS/React/react-howto.md",sourceDirName:"coding/Languages/JS/React",slug:"/coding/Languages/JS/React/react-howto",permalink:"/docs/coding/Languages/JS/React/react-howto",draft:!1,editUrl:"https://github.com/markshawn2020/docusaurus/edit/master/my-documents/docs/coding/Languages/JS/React/react-howto.md",tags:[],version:"current",lastUpdatedAt:1726564669,formattedLastUpdatedAt:"2024\u5e749\u670817\u65e5",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"marknote-electron-prisma-sqlite",permalink:"/docs/coding/Languages/JS/Electron/marknote-electron-prisma-sqlite"},next:{title:"react-whyso",permalink:"/docs/coding/Languages/JS/React/react-whyso"}},f={},g=[{value:"<code>forceUpdate</code>",id:"forceupdate",level:2},{value:"component and re-render",id:"component-and-re-render",level:2},{value:"IMPORTANT \u2b50\ufe0f function as hook, the async understanding",id:"important-\ufe0f-function-as-hook-the-async-understanding",level:2},{value:"get host",id:"get-host",level:2},{value:"configure fs node",id:"configure-fs-node",level:2},{value:"configure proxy pass",id:"configure-proxy-pass",level:2},{value:"how to always scroll bottom",id:"how-to-always-scroll-bottom",level:2}],k={toc:g};function b(e){var t,n=e,{components:a}=n,p=((e,t)=>{var n={};for(var o in e)c.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&l)for(var o of l(e))t.indexOf(o)<0&&i.call(e,o)&&(n[o]=e[o]);return n})(n,["components"]);return(0,o.kt)("wrapper",(t=d(d({},k),p),r(t,s({components:a,mdxType:"MDXLayout"}))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"#forceupdate"}),(0,o.kt)("inlineCode",{parentName:"a"},"forceUpdate"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"#component-and-re-render"}),"component and re-render")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"#important-%EF%B8%8F-function-as-hook-the-async-understanding"}),"IMPORTANT \u2b50\ufe0f function as hook, the async understanding")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"#get-host"}),"get host")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"#configure-fs-node"}),"configure fs node")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"#configure-proxy-pass"}),"configure proxy pass")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"#how-to-always-scroll-bottom"}),"how to always scroll bottom"))),(0,o.kt)("h2",d({},{id:"forceupdate"}),(0,o.kt)("inlineCode",{parentName:"h2"},"forceUpdate")),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-ts"}),"const [_, forceUpdate] = useReducer((x) => x + 1, 0);\n// usage\n<button onClick={forceUpdate}>Force update</button>;\n")),(0,o.kt)("p",null,"ref: ",(0,o.kt)("a",d({parentName:"p"},{href:"https://stackoverflow.com/a/59602379/9422455"}),"https://stackoverflow.com/a/59602379/9422455")),(0,o.kt)("h2",d({},{id:"component-and-re-render"}),"component and re-render"),(0,o.kt)("p",null,"I came to realize it today that if I put the hook under some specific component, then when I switch the top component, the sub component would stop rendering, lose their hook data and need re-rerendering again."),(0,o.kt)("img",{alt:"picture 43",src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/react-howto-1641697284624-d357e3cba5c0b2913428cacb34ded477858c6ca1710d0721b71db58df7f7e6ab.png"}),(0,o.kt)("p",null,"Hence, to solve the problem, we need to consider about what level the data is sharing between components."),(0,o.kt)("p",null,"For example, in my programme, the console data, uploading progress should be shared across tabs, which means though the console, progress are all under the same tab, but the data needs to be across tabs."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"So the data should be defined outside the component (move out or using ",(0,o.kt)("inlineCode",{parentName:"strong"},"redux"),") then, or to be persistent (saving to file and read) then, or something others.")),(0,o.kt)("h2",d({},{id:"important-\ufe0f-function-as-hook-the-async-understanding"}),"IMPORTANT \u2b50\ufe0f function as hook, the async understanding"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-ts"}),'/**\n * \u8fd9\u91cc\u5f88\u6709\u610f\u601d\u7684\u70b9\uff1a\n * 1. \u82e5\u5199\u6210 `setMsgs([...msgs, msg])`\uff0c\u5219`requestReadFile`\u51fd\u6570\u4e2d\u53ea\u4f1a\u5728request\u51fd\u6570\u6574\u4e2a\u7ed3\u675f\u540e\u624d\u4f1a\u66f4\u65b0\u4e00\u6b21\u6d88\u606f\uff0c\u5e76\u4e14\u6f0f\u6389\u4e86"selecting file"\n * 2. \u82e5\u5199\u6210 `setMsgs(() => [...msgs, msg])`\uff0c\u5219`requestReadFile`\u51fd\u6570\u4e2d`selecting file`\u4f1a\u663e\u793a\uff0c\u4f46\u662f\u7b49`once`\u7ed3\u675f\u65f6\u4f1a\u8986\u76d6\u5b83\n * 3. \u53ea\u6709\u5199\u6210 `setMsgs(msgs => [...msgs, msg])`\uff0c\u624d\u4f1a\u8ba9`selecting file`\u548c`once`\u90fd\u80fd\u66f4\u65b0\u5e76\u663e\u793a\u4fe1\u606f\n *\n * \u5206\u6790\uff1a\n * \u8fd9\u80cc\u540e\u5e94\u8be5\u662f\u5f02\u6b65\u66f4\u65b0\u7684\u539f\u56e0~ `once`\u662f\u4e00\u4e2a\u5f02\u6b65\u51fd\u6570\uff0c\u8054\u60f3`redux`\u91cc\u7684`dispatch`\u4e0d\u96be\u60f3\u5230\uff0c\u5b83\u4eec\u4e5f\u662f\u7528\u51fd\u6570\u8fdb\u884c\u66f4\u65b0\u7684\uff0c\u4e5f\u5c31\u662f\uff1a\n * f => g => h\n * @param msg\n */\nconst pushMsg = (msg: ConsoleItem) => {\n  if (!refReadingItems.current) {\n    // \u6ca1\u6709\u5728\u8bfb\u53d6\u8bfb\u53d6\u6587\u4ef6\n    setMsgs((msgs) => [...msgs.slice(msgs.length === 100 ? 1 : 0), msg]);\n    refScroll?.current?.doScroll();\n  } else {\n    // \u6b63\u5728\u8bfb\u53d6\u6587\u4ef6\n    setMsgs((msgs) => [...msgs.slice(0, msgs.length - 1), msg]);\n  }\n};\n')),(0,o.kt)("h2",d({},{id:"get-host"}),"get host"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-js"}),'// will return the host name and port, like: "localhost:3000"\nvar host = window.location.host;\n')),(0,o.kt)("p",null,(0,o.kt)("a",d({parentName:"p"},{href:"https://stackoverflow.com/a/6042031/9422455"}),"https://stackoverflow.com/a/6042031/9422455")),(0,o.kt)("p",null,"In fact, the react frontend is served on the web client, and hence can only achieve some special environments exposed by react backend, in which we can't see those variables like HOST, PORT, etc."),(0,o.kt)("h2",d({},{id:"configure-fs-node"}),"configure fs node"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-js"}),"// cpponfig.js\n  // Some libraries import Node modules but don't use them in the browser.\n  // Tell Webpack to provide empty mocks for them so importing them works.\n  node: {\n    dgram: 'empty',\n    fs: 'empty',\n    net: 'empty',\n    tls: 'empty',\n    child_process: 'empty',\n  },\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"https://github.com/facebook/create-react-app/issues/3074"}),"Can't use native node modules like fs \xb7 Issue #3074 \xb7 facebook/create-react-app"))),(0,o.kt)("h2",d({},{id:"configure-proxy-pass"}),"configure proxy pass"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-json"}),'// package.json\n"proxy":"http://localhost:5000"\n')),(0,o.kt)("p",null,"reference: ",(0,o.kt)("a",d({parentName:"p"},{href:"https://www.jianshu.com/p/4286eaf0425d#:~:text=%22proxy%22%3A%22http%3A//localhost%3A5000%22"}),"https://www.jianshu.com/p/4286eaf0425d#:~:text=%22proxy%22%3A%22http%3A//localhost%3A5000%22")),(0,o.kt)("h2",d({},{id:"how-to-always-scroll-bottom"}),"how to always scroll bottom"),(0,o.kt)("p",null,"The main scene is a console in frontend, and we need to keep the content in this console scrolled to the bottom."),(0,o.kt)("p",null,"In fact, all the content may lay in one container, and then the problem simplified into how to scroll each time when new item comes into the content container."),(0,o.kt)("p",null,"First, how to scroll."),(0,o.kt)("p",null,"It's easy to do that in react just to specify a ",(0,o.kt)("inlineCode",{parentName:"p"},"ref")," element (suppose name it as ",(0,o.kt)("inlineCode",{parentName:"p"},"refEle"),"), and call the following method:"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-js"}),"refEle.current.scrollIntoView({\n  behavior: 'smooth',\n  block: 'end',\n  inline: 'nearest',\n});\n")),(0,o.kt)("p",null,"And keep in mind that we need to put this ",(0,o.kt)("inlineCode",{parentName:"p"},"relEle")," to the end of the inside of the container like this: ",(0,o.kt)("img",{alt:"picture 64",src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640625572054-react-howto-5dd3bcef6a3d965d2b4a7b701b9642a18374fd93202c71f9d3718e77429ae930.png",width:"480"})),(0,o.kt)("p",null,"ref:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"https://stackoverflow.com/questions/37620694/how-to-scroll-to-bottom-in-react"}),"reactjs - How to scroll to bottom in react? - Stack Overflow"))))}b.isMDXComponent=!0}}]);