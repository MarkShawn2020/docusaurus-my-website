<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-alpha.0">
<title data-rh="true">Blog | 南川笔记</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://markshawn2020.github.io/blog/page/6"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" property="og:title" content="Blog | 南川笔记"><meta data-rh="true" name="description" content="A Docusaurus powered blog!"><meta data-rh="true" property="og:description" content="A Docusaurus powered blog!"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://markshawn2020.github.io/blog/page/6"><link data-rh="true" rel="alternate" href="https://markshawn2020.github.io/blog/page/6" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://markshawn2020.github.io/blog/page/6" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="南川笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="南川笔记 Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QFQ00XLDNZ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QFQ00XLDNZ",{anonymize_ip:!0})</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b123addb.css">
<link rel="preload" href="/assets/js/runtime~main.aacdcb6f.js" as="script">
<link rel="preload" href="/assets/js/main.c22735e8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_UHvc">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_qLAv themedImage--light_kaXc"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_qLAv themedImage--dark_ONYO"></div><b class="navbar__title text--truncate">南川笔记</b></a><a class="navbar__item navbar__link" href="/blog/archive">My Blog</a><a class="navbar__item navbar__link" href="/docs/">My Notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/markshawn2020/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source of Framework<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/markshawn2020/docusaurus-my-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source of Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/markshawn2020/my-documents" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source of Documents<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_bT41 colorModeToggle_UolE"><button class="clean-btn toggleButton_x9TT toggleButtonDisabled_Dj8q" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_dnYY"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_OBbf"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_CTO4"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_PEsc"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_P3nc thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_VrjY margin-bottom--md">All Posts</div><ul class="sidebarItemList_OSkG clean-list"><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/2422-INFP与ENTJ的日日夜夜">2024/2422-INFP与ENTJ的日日夜夜</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/2422-从FP走向TJ">2024/2422-从FP走向TJ</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/06/21/Rabbit-R1分享会">Rabbit-R1分享会</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/05/01/2419-信仰一跃">2419-信仰一跃</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/04/30/飞脑">飞脑</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/discarded/微信聊天记录备份指南">微信聊天记录备份指南</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/01/14/觉醒的硅基">觉醒的硅基</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/31/index">[03-27-digital-travel] 南川数字游民之旅01：</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/27/南川骑行川藏线（下）">南川骑行川藏线（下）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/19/十年 —— 一位自学者、技术工作者、理想主义者的独白">十年 —— 一位自学者、技术工作者、理想主义者的独白</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/18/南川骑行川藏线（中）">南川骑行川藏线（中）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/09/25/当我想做一款吹羽毛小游戏……">当我想做一款吹羽毛小游戏……</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/08/31/Poketto.AI 每一个人的哆啦A梦">Poketto.AI: 每一个人的哆啦A梦</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/12/31/this-year">this-year</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/08/29/coding-cries">代码有所能，有所不能</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/08/03/taiwan-data-research">关于台湾进出口临时政策与历史数据的研究</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/08/01/wechat-hack">微信数据库破解</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/07/11/prose-I-am-me">札记 | 我与我周旋久，我亦是我</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/07/02/dev-gaokao">编程 | 使用 pandas 研究高考志愿填报</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/06/16/dev-gopro-2">编程 | GoPro 02: 玩转 OpenLab</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/06/11/dev-gopro-1">编程 | GoPro 01: 全天候自动 4K 延时摄影</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/06/06/dev-ios-automation">编程 | iOS 自动化实现王者荣耀一键换装</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/23/dev-mp3-meta">编程 | 逼哥的音乐元数据修复</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/22/evaluation-breo-dream6">评测 | Breo Dream6 按摩仪</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/15/prose-is-not-easy">札记 | 须知，活好是很不容易的</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/14/dev-voice2srt">编程 | 视频剪辑自动转写字幕</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/04/22/research-mbti/mark_mbti">研究 | 基于 MBTI 的人生复盘与计划（上）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/03/27/prose-321-air-crash">札记 | 愿逝者安息生者坚强，你我迎风奔跑向阳而生</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/03/09/dev-douban-renting">编程 | 北京租房系统设计、研究与经验 0.1.0</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/21/ad-beike-hiring">推广 | 贝壳新业务 VR 全职开发招募</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/12/coding-design-shortcuts/02-12-coding-design-shortcuts">编程设计艺术思考（持续更新）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/03/prose-living">札记 | 2022，活着</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/02/dev-linux">编程 | Linux 笔记</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/01/prose-2022-begining">札记 | 关于近几年的一些感悟</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/01/23/prose-engineer-cultivation">札记 | 一位工程师的自我修养（序）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/01/20/prose-first-job">札记 | 是的，我入职了</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/01/01/prose-my-2021">札记 | 我的 2021：混沌与洞见</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/12/24/dev-webpack">编程 | 记与 Webpack 十二小时的奋战</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/12/04/一道“全军覆灭”的数学题">一道“全军覆灭”的数学题</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/12/04/考研数学试题编辑">考研数学试题编辑</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/11/28/今天南川学习十小时了吗？是的。">关于正态分布表的一个有趣发现</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/11/09/浅谈我自学编程的经历与经验">浅谈我自学编程的经历与经验</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/10/28/关于有人想仲裁我">关于有人想仲裁我</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/10/27/十月：无题">十月：无题</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/10/18/王者荣耀打野上分经验总结（全干货）">王者荣耀打野上分经验总结</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/06/27/毕业一年：我的得与失">南川二一零六：毕业一年，我的失与得</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/05/12/记逆向攻破拼多多加密系统">南川逆向笔记 | 攻破 PDD 风控系统（一）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/04/14/从0到1搭建一个Electron应用">Electron 开发笔记 - 从 0 到 1 搭建一个 Electron 应用</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/03/12/shamghai-rent-lesson">记与上海无良房东斡旋经验与教训</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/01/09/评测-南川Effie使用初体验">南川 Effie 使用初体验</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/11/20/拜登获胜演讲稿">拜登获胜演讲稿</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/10/28/人生 | 五台山论道（节选自《遥远的救世主》）">五台山论道（节选自《遥远的救世主》）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/10/16/大学沉思录：一路失败，我到底学到了什么">大学沉思录：一路失败，我到底学到了什么</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/10/16/大学沉思录：意向调查">大学沉思录：意向调查</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/22/JS、ES、TS、node、Vue、React修炼">JS、ES、TS、node、Vue、React 修炼</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/15/投资：凯利公式">“中一千万”与“挣一千万”到底哪个更容易</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/bug_fix">BUG FIX</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/home">南川笔记中文首页</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/todo-old">待办事项</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/release-notes">更新日志</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/guestbook">留言墙</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/12/经验与发现">经验与发现</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/10/JS、ES、TS、node、Vue、React修炼">JS、ES、TS、node、Vue、React 修炼</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/开发常用命令行">开发常用命令行</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/my_university">谨以此文，纪念我在大学的这四年</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/VuePress-Journal">VuePress你好，VuePres再见</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/vue开发笔记">vue开发笔记</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/08/29/博客开发之导航设计方案">博客开发之导航设计方案</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/08/29/如何向ElementUI一样封装Message全局组件">如何向ElementUI一样封装Message全局组件</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/如何给右键添加任何启动程序">如何给右键添加任何启动程序</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/08/29/我谈《三十而已》">我谈《三十而已》</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/极客运营手册/">极客运营手册</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/13/ssg-ssr">When to Use Static Generation v.s. Server-side Rendering</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/13/pre-rendering">Two Forms of Pre-rendering</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_UBNu" itemprop="headline"><a itemprop="url" href="/blog/2022/05/14/dev-voice2srt">编程 | 视频剪辑自动转写字幕</a></h2><div class="container_x5Un margin-vert--md"><time datetime="2022-05-14T00:00:00.000Z" itemprop="datePublished">2022/05/14</time> · <!-- -->阅读需 15 分钟</div></header><div class="markdown" itemprop="articleBody"><ol><li>语音转写市场概览</li><li>网易见外的缺点<ol><li>FCPX 不支持网易见外导出的 srt 字幕文件</li><li>网易见外的转写结果需要手动进行长度切割</li><li>网易见外只支持后期文本替换，而不支持前期预设词库</li><li>网易见外不支持基于鼠标点击的文本位置智能跳转语音并播放</li></ol></li><li>讯飞转写<ol><li>讯飞服务价格</li><li>讯飞语音转写控制台</li><li>讯飞语音转写的使用</li><li>讯飞语音转写使用分词</li><li>讯飞语音转写程序</li></ol></li><li>基于 Automator 实现右键语音文件后台自动转写</li></ol><h2 class="anchor anchorWithStickyNavbar_rB0w" id="语音转写市场概览">语音转写市场概览<a class="hash-link" href="#语音转写市场概览" title="标题的直接链接">​</a></h2><p>目前国内中文语音转文字，做的最好的应该是科大讯飞（可惜要付费）：</p><ul><li><a href="https://console.xfyun.cn/services/lfasr" target="_blank" rel="noopener noreferrer">控制台-讯飞开放平台</a></li></ul><p>所以其实很多 UP 主用的是网易见外之类的免费转写产品。</p><p>其他转写平台还有，比如：</p><ul><li><a href="https://github.com/PaddlePaddle/PaddleSpeech" target="_blank" rel="noopener noreferrer">百度的飞桨</a></li><li><a href="https://github.com/opensourceteams/google-sdk-speech-to-text" target="_blank" rel="noopener noreferrer">谷歌识别</a></li><li>……</li></ul><h2 class="anchor anchorWithStickyNavbar_rB0w" id="网易见外的缺点">网易见外的缺点<a class="hash-link" href="#网易见外的缺点" title="标题的直接链接">​</a></h2><p>我实际体验下来，网易见外还是不太能满足我的需求的，主要如下：</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="fcpx-不支持网易见外导出的-srt-字幕文件">FCPX 不支持网易见外导出的 srt 字幕文件<a class="hash-link" href="#fcpx-不支持网易见外导出的-srt-字幕文件" title="标题的直接链接">​</a></h3><p>这个我之前就了解了一下，发现大家都是用一些第三方软件再将网易见外的 srt 转换成另一种 srt，不禁引起了我的好奇，到底为啥网易见外的 srt 不支持 fcpx 导入。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652437655118-c3c5e4b27ab7ff01d6860b73a89f616fff6cd87264153c70010e5802280ee68b.png" alt="picture 9" class="img_vXGZ"></p><p>我对比了讯飞转写和网易见外的 srt 文件，发现两者的唯一区别就在于编序下标不同：网易见外从 0 开始标记，而讯飞转写从 1 开始：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652437563419-c6548e1349f50fa454cc6d34842da5852007a8d589514d968974963ce1751cf1.png" alt="picture 8" class="img_vXGZ"></p><p>由此大胆猜测：FCPX 对 srt 文件的硬性要求就是从 1 开始编码！</p><p>于是我将网易见外的第 0 号编码对应的字幕内容去掉，重新导入 FCPX，结果成功了，此即证实了我的猜想。</p><p>了解了原因之后，这个问题就变得不那么恐怖了，随便用什么脚本语言把网易见外的 srt 文件里的序号全部加 1，或者干脆把第一条去掉即可。不是什么难事。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="网易见外的转写结果需要手动进行长度切割">网易见外的转写结果需要手动进行长度切割<a class="hash-link" href="#网易见外的转写结果需要手动进行长度切割" title="标题的直接链接">​</a></h3><p>网易见外的默认转写字幕长度是偏长的。这其实可以理解，因为长一点有助于基于上下文分析提高转写的准确度。</p><p>但问题就在于，想把分好的每句字幕再切小一点，则需要手动的在网页上点击分隔按钮一个个地调整，这个工作量就变得无法接受了。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652437965030-0e0c5d1f23c071c4b8621142912eeb55bdbf32bec4663afaa6854b30f47fbf4c.png" alt="picture 10" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="网易见外只支持后期文本替换而不支持前期预设词库">网易见外只支持后期文本替换，而不支持前期预设词库<a class="hash-link" href="#网易见外只支持后期文本替换而不支持前期预设词库" title="标题的直接链接">​</a></h3><p>对于学过机器学习的程序员或者用过<code>jieba</code>分词之类开源代码库的人都知道，预设词库在文本分析相关领域是非常重要的，显著影响算法识别的准确度和使用体验。</p><p>然而网易见外是不支持转写之前预设词库，只可以转完之后在页面点击文本替换，由此可见网易转写的机器学习模型（如果有的话）比较低级，它只有通用的一个，不支持用户自己输入词库进行模型微调。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="网易见外不支持基于鼠标点击的文本位置智能跳转语音并播放">网易见外不支持基于鼠标点击的文本位置智能跳转语音并播放<a class="hash-link" href="#网易见外不支持基于鼠标点击的文本位置智能跳转语音并播放" title="标题的直接链接">​</a></h3><p>这个是讯飞转写的一个很友好的功能，并且在技术是线上我认为也不是很难的一件事，但很可惜，网易见外也未能把这个用户体验做起来。</p><p>基于以上原因，我认为网易见外是远未达到我对一个智能转写软件平台的目标要求的。</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="讯飞转写">讯飞转写<a class="hash-link" href="#讯飞转写" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="讯飞服务价格">讯飞服务价格<a class="hash-link" href="#讯飞服务价格" title="标题的直接链接">​</a></h3><p>如果没有开通过讯飞的服务，可以申请免费使用。不过有一定要求，比如企业用户需要提交工商执照相关信息，而个人用户，看声明貌似要 19 年的新用户……反正我是不符合了（我以前应该用过）。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652431323538-20c35f16a1a4cedc75b65c5c69614ddc05521d1e6608e1bc485f523af6b8d8e9.png" alt="picture 6" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="讯飞语音转写控制台">讯飞语音转写控制台<a class="hash-link" href="#讯飞语音转写控制台" title="标题的直接链接">​</a></h3><p>在控制台，可以查看自己所购买的讯飞服务详情，最主要的就是确认自己购买的是“讯飞转写”的服务，然后至少要支持中英文转写，最后在个性化热词里可以加入自己的特殊词库（用于提高准确率，非常有用）。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652431465004-4f6c800430b3f09d8917e0e0009af5ba5668169312f800f2e236fcda51ac55a0.png" alt="picture 7" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="讯飞语音转写的使用">讯飞语音转写的使用<a class="hash-link" href="#讯飞语音转写的使用" title="标题的直接链接">​</a></h3><p>可以使用讯飞语音转写的 api，在该页可以下载各大语音（例如 python）的 demo：<a href="https://www.xfyun.cn/doc/asr/lfasr/API.html" target="_blank" rel="noopener noreferrer">语音转写 API 文档 | 讯飞开放平台文档中心</a></p><p>建议直接对着 demo 改，否则从 0 到 1 写会很麻烦，因为要很多加密相关参数。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652431132707-614749d87f3bee0e5b8675061e1330fb9b700080406a936bc8c7f30a4cb929ce.png" alt="picture 5" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="讯飞语音转写使用分词">讯飞语音转写使用分词<a class="hash-link" href="#讯飞语音转写使用分词" title="标题的直接链接">​</a></h3><p>在 <code>/prepare</code> 接口的参数中如果加上 <code>has_participle = true</code>，则会返回带每个词语识别的结果。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652461333188-95a3f302b742e110b3cbdf3f0227cbc525d8869298487f4929c0fa8ad037a333.png" alt="picture 11" class="img_vXGZ"></p><p>不过深入去使用词级别的解析结果也是一件不太容易的事情，因为需要我们自己去处理断句的问题。比如说要通过<code>&#x27;wordsName&#x27;: &#x27;，&#x27;</code>去判别是个断句。</p><p>基于这个角度来看，网易见外不支持按长度的智能分句，似乎也变得不是那么不能接受了。</p><p>但尽管如此，讯飞的结果依旧要比网易见外好很多。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="讯飞语音转写程序">讯飞语音转写程序<a class="hash-link" href="#讯飞语音转写程序" title="标题的直接链接">​</a></h3><p>已同步在个人仓库：<a href="https://github.com/MarkShawn2020/mark_keeps_learning/blob/master/mark_scripts/voice2srt/main.py" target="_blank" rel="noopener noreferrer">https://github.com/MarkShawn2020/mark_keeps_learning/blob/master/mark_scripts/voice2srt/main.py</a></p><p>具体脚本内容如下：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># -*- coding: utf-8 -*-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   author: yanmeng2, xunfei api relative</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   author: markshawn2020, xunfei result to srt-format file, 2022-05-13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   config: https://console.xfyun.cn/services/lfasr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   doc: https://www.xfyun.cn/doc/asr/lfasr/API.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> hashlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> hmac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lfasr_host </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://raasr.xfyun.cn/api&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 请求的接口名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_prepare </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/prepare&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_upload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/upload&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_merge </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/merge&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_get_progress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/getProgress&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_get_result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/getResult&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 文件分片大小10M</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file_piece_sice </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10485760</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ——————————————————转写可配置参数————————————————</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 参数可在官网界面（https://doc.xfyun.cn/rest_api/%E8%AF%AD%E9%9F%B3%E8%BD%AC%E5%86%99.html）查看，根据需求可自行在gene_params方法里添加修改</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 转写类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lfasr_type </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 是否开启分词</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">has_participle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;false&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">has_seperate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 多候选词个数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_alternatives </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 子用户标识</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">suid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 每隔N秒获取一次进度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SliceIdGenerator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;slice id生成器&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__ch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;aaaaaaaaa`&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getNextSliceId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__ch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cj </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ch</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> cj </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;z&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ch</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">ord</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> ch</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">j </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ch</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> ch</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">j </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__ch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__ch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -------------------- 从讯飞结果到srt的转换函数 -----------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">time2stamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    将整数时间（毫秒）转化为srt的时间戳，即 HH:MM:SS,mmm</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :param s:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :return:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mmm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s </span><span class="token operator" style="color:#393A34">//=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s </span><span class="token operator" style="color:#393A34">//=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MM </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s </span><span class="token operator" style="color:#393A34">//=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HH </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">HH</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">02</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">:</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">MM</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">02</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">:</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">SS</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">02</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">mmm</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">03</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pickle_srt_item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mm_start</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mm_end</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    构建srt字幕文件的基本单元</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :param index: 字幕序号，从1开始，手动创建</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :param mm_start: 该字幕单元起始毫秒数</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :param mm_end: 该字幕单元结束毫秒数</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :param content: 该字幕单元的文本内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :return:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">index</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">\n</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">time2stamp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">mm_start</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> --&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">time2stamp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">mm_end</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">\n</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">content</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">xunfei_json2srt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    将讯飞转写的输出转成srt字幕文本内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :param items:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :return:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pickle_srt_item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;bg&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ed&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;onebest&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RequestApi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> appid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> secret_key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> upload_file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_appid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> appid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_secret_key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> secret_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_upload_file_path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> upload_file_path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">srt_fp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">splitext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_upload_file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.srt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;--- initialized ---&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 根据不同的apiname生成不同的参数,本示例中未使用全部参数您可在官网(https://doc.xfyun.cn/rest_api/%E8%AF%AD%E9%9F%B3%E8%BD%AC%E5%86%99.html)查看后选择适合业务场景的进行更换</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">gene_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> apiname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> slice_id</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        appid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_appid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secret_key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_secret_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        upload_file_path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_upload_file_path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        m2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hashlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">md5</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        m2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">appid </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> ts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        md5 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hexdigest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        md5 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">md5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 以secret_key为key, 上面的md5为msg， 使用hashlib.sha1加密结果为signa</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        signa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hmac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">secret_key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> md5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hashlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sha1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        signa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">signa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        signa </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">signa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        file_len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getsize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">upload_file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        file_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">basename</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">upload_file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        param_dict </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> apiname </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> api_prepare</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># slice_num是指分片数量，如果您使用的音频都是较短音频也可以不分片，直接将slice_num指定为1即可</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            slice_num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_len </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> file_piece_sice</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_len </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> file_piece_sice </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;app_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> appid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;signa&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> signa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;ts&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;file_len&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_len</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;file_name&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> file_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;slice_num&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slice_num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> apiname </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> api_upload</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;app_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> appid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;signa&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> signa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;ts&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;task_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> taskid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;slice_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> slice_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> apiname </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> api_merge</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;app_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> appid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;signa&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> signa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;ts&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;task_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> taskid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;file_name&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> file_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> apiname </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> api_get_progress </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> apiname </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> api_get_result</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;app_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> appid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;signa&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> signa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;ts&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            param_dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;task_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> taskid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> param_dict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 请求和结果解析，结果中各个字段的含义可参考：https://doc.xfyun.cn/rest_api/%E8%AF%AD%E9%9F%B3%E8%BD%AC%E5%86%99.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">gene_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> apiname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> files</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lfasr_host </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> apiname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> files</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">files</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ok&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;{} success:&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">apiname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;{} error:&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">apiname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 预处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prepare_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">apiname</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">api_prepare</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_prepare</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 上传</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">upload_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> upload_file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        file_object </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">upload_file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;rb&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SliceIdGenerator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                content </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> file_object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_piece_sice</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> content </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                files </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;filename&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_upload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;slice_id&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_upload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                             data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_upload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                   slice_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getNextSliceId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                             files</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">files</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ok&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># 上传分片失败</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;upload slice fail, response: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;upload slice &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; success&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                index </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;file index:&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tell</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            file_object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 合并</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">merge_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_merge</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_merge</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 获取进度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_progress_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_get_progress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_get_progress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 获取结果</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_result_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_get_result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gene_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_get_result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">all_api_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 1. 预处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pre_result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">prepare_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        taskid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pre_result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 2 . 分片上传</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">upload_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> upload_file_path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_upload_file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 3 . 文件合并</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">merge_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 4 . 获取任务进度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 每隔N秒获取一次任务进度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            progress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_progress_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            progress_dic </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> progress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> progress_dic</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;err_no&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> progress_dic</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;err_no&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">26605</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;task error: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> progress_dic</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;failed&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> progress_dic</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;data&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                task_status </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> task_status</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;status&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;task &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> taskid </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; finished&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;The task &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> taskid </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; is in processing, task status: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">N</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 每次获取进度间隔N S</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 5 . 获取结果</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        srt_json </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_result_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">taskid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">taskid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        srt_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xunfei_json2srt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">srt_json</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">srt_fp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">srt_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;has written converted result into path: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">srt_fp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RequestApi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        appid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;XUNFEI_APP_ID&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secret_key</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;XUNFEI_APP_SK&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        upload_file_path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">all_api_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_rB0w" id="基于-automator-实现右键语音文件后台自动转写">基于 Automator 实现右键语音文件后台自动转写<a class="hash-link" href="#基于-automator-实现右键语音文件后台自动转写" title="标题的直接链接">​</a></h2><p>目前我们写的脚本，输入是一个文件路径，特别的，是指我们待转的音频文件，根据讯飞接口要求，对输入的文件有以下限制：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652533014083-ec6a9f68a140717a16bb63397a987c5ce2e8abc80fe3f8a0959e1ca0ad3c0dbc.png" alt="picture 8" class="img_vXGZ"></p><p>从音频格式来看，除了<code>aac</code>格式不支持，其他常用的例如<code>mp3, wav, m4a</code>都支持了，所以还是挺广泛的。</p><p>但是每次手动调用程序去转写一个音频文件，未免还是感觉有点麻烦，尤其是对于程序员来说。</p><p>比如现在我们转写一个音频文件，需要在命令行执行如下命令：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">python3 </span><span class="token operator" style="color:#393A34">~</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mark_keeps_learning</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mark_scripts</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">voice2srt</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py 目标音频文件路径</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>虽然我们也可以使用<code>alias</code>手段，把这一串命令缩短成一个词，以方便我们直接使用<code>voice2srt 目标音频文件路径</code> 的命令完成目标，但还是要基于命令行，多有不便。</p><p>主要是，我们也不需要修改其他参数（基本按照默认即可，热词已经在讯飞官网配好了）。</p><p>那么这种纯粹基于文件的操作，在 mac 平台上最好的办法是写一个<code>automator</code>脚本：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652532742053-608328c5fa3dc43bb127e4acf67d24ca3a9b96c3dc785f182745c4301b002348.png" alt="picture 7" class="img_vXGZ"></p><p>这样我们就可以直接在 finder 里面右键我们的音频文件，然后在快捷菜单中找到我们的 automator 脚本选项，鼠标一点就自动转成了，非常方便！</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652533417457-750a70456486d620a0f3e313e6e431fbe6530aa99aa51b04b6899cb39f4defa9.png" alt="picture 9" class="img_vXGZ"></p><p>十秒钟之后，就自动在当前文件夹内生成一个讯飞转写后的字幕文件了，非常方便：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652533472130-84eedb0ba0b9f481f2ae1d09fffb8d14c58ff3543e83d8225237eed6627be5f3.png" alt="picture 10" class="img_vXGZ"></p><p>并且我将标准输出重定位到了根目录的 log 文件，这样就可以在程序出错时复查：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/auto-voice2srt-1652533562489-e40a4b0b90122321cf4ca18cc2a9ffdf12deaa944aa86ca2cc3fcc421d5809e7.png" alt="picture 11" class="img_vXGZ"></p><p>Automator 是一个很有用的工具，我也对它越来越感兴趣了，比如说还写了一个网易云音乐 ncm 转 mp3 的快捷操作，这样右键一个 ncm 文件，就能转成 mp3 了，非常方便。</p><p>但愿本文对你有帮助~</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_rTaS padding--none margin-left--sm"><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/开发笔记">开发笔记</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/字幕">字幕</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_UBNu" itemprop="headline"><a itemprop="url" href="/blog/2022/04/22/research-mbti/mark_mbti">研究 | 基于 MBTI 的人生复盘与计划（上）</a></h2><div class="container_x5Un margin-vert--md"><time datetime="2022-04-22T00:00:00.000Z" itemprop="datePublished">2022/04/22</time> · <!-- -->阅读需 40 分钟</div></header><div class="markdown" itemprop="articleBody"><p>很久以前就知道这个测试，但一直都没重视。</p><p>最近因缘际会之下，认真研究了一番，确有所获，故记之。</p><p>本文将分上、中、下，共记录自己对 MBTI 官网 60 道题的思考与复盘，以期明确自己的性格与未来规划。</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="什么是-mbti">什么是 MBTI<a class="hash-link" href="#什么是-mbti" title="标题的直接链接">​</a></h2><p>在微信搜索 MBTI 可以发现有大量相关的文章：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650191510091-869f49efefa5c82cbd0498200c946d0c25184af482573e2138fc8d5135e1dfc0.png" alt="picture 2" class="img_vXGZ"></p><p>在 MBTI 官网可以找到这个理论的一些定义： <a href="https://www.16personalities.com/articles/our-theory" target="_blank" rel="noopener noreferrer">Our Framework | 16Personalities</a></p><p>想要获得大概认识的话，可以看 B 站这个，讲的生动有趣： <a href="https://www.bilibili.com/video/BV1a44y1L7Yw/?spm_id_from=333.788.recommend_more_video.-1" target="_blank" rel="noopener noreferrer">全网最详细 MBTI 解析！|满满干货！|迷茫必看！<!-- -->_<!-- -->哔哩哔哩<!-- -->_<!-- -->bilibili</a></p><p>想知道影视人物表现出的十六种性格类型，可以看： <a href="https://www.bilibili.com/video/BV1Sp4y1e7rd/?spm_id_from=trigger_reload" target="_blank" rel="noopener noreferrer">通过影视人物表现的 16 种性格类型<!-- -->_<!-- -->哔哩哔哩<!-- -->_<!-- -->bilibili</a></p><p>简单来说：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650334147954-04a55bf30f67666f993ad5b229ae481425b91249ed1ce5958aca572e67b0d6a7.png" alt="picture 5" class="img_vXGZ"></p><p>为方便理解，我们姑且称这四类人格属性记为：<strong>能量（EI）、感知（SN）、决策（TF）、行动（JP）</strong>。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="能量ei">能量（E/I）<a class="hash-link" href="#能量ei" title="标题的直接链接">​</a></h3><p>很多人会把 MBTI 的 EI 题用来判断自己是否外向，再进一步退化，叫是否“social”，其实我觉得不是这样的。</p><p>我们看上面那个英文解释，叫“Direction of energy and attention focus”，这个解释听起来很高大上，甚至让我联想到了火影忍者里的查克拉：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650528165570-2e2c83e637efc29b22e77bd29ad1c493397a85d5106c8225afe475326fe4ca9c.png" alt="picture 4" class="img_vXGZ"></p><p>具体来讲，就是注意力集中在何处（内心还是世界），从哪里（内心还是世界）获得动力（能量的流向）。</p><p>在这个问题上，我觉得我是坚定的更关注内心的一派，我心即宇宙，我的社交也是为了更好地构筑我的内心，所以我现在其实是 I，以后也会是 I，当然这并不意味着我未来会减少社交（尽管有这个可能，也可能相反）。</p><p>阅读/学习 --&gt; 社交/交流 --&gt; 实践 --&gt; 阅读/学习，对我来说，这是一个闭环的过程。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="感知sn">感知（S/N）<a class="hash-link" href="#感知sn" title="标题的直接链接">​</a></h3><p>其实这个我不是特别懂~</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="决策tf">决策（T/F）<a class="hash-link" href="#决策tf" title="标题的直接链接">​</a></h3><p>基于逻辑（T）还是感觉（F）。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="行动jp">行动（J/P）<a class="hash-link" href="#行动jp" title="标题的直接链接">​</a></h3><p>基于计划（J）还是冲动（P）。</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="我的-mbti-分析">我的 MBTI 分析<a class="hash-link" href="#我的-mbti-分析" title="标题的直接链接">​</a></h2><p>根据 MBTI 官网的规则，每道题的选项空间有七个，我们标记如下：</p><ul><li>3：极其同意</li><li>2：比较同意</li><li>1：相对同意</li><li>0：中立</li><li>-1：相对不同意</li><li>-2：比较不同意</li><li>-3：极其不同意</li></ul><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650539429940-14379162bf5bf19ae2c692bd1eb5c110fcd3e0a44b4b3837408555c74d5fdcaa.png" alt="picture 9" class="img_vXGZ"></p><p>考虑到我个人的独特成长经历，以下每道题，我将给出我的分析过程，并且分别给出我现在（特指目前工作期间）、我期望（特指终极人生目标）等两种不同状态的答案。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="1-you-regularly-make-new-friends">1. You regularly make new friends<a class="hash-link" href="#1-you-regularly-make-new-friends" title="标题的直接链接">​</a></h3><p>我是否经常结交新朋友？</p><p>EI 题。是的。</p><p>通常情况下，人都喜欢交朋友，比如交越来越多的朋友与质量越来越高的朋友。不过这也并非人人如此。</p><p>最简单的，我注意到大学毕业时，不同学生的微信好友数目天差地别，有的只有两三百个，甚至更少；而有的则有两三千个，甚至更多。我应该属于中间水平。</p><p>从经验上看，大部分年轻人交友少的最大原因，可能是沉迷自己的兴趣或者缺乏自信，他们在认识新朋友时会更容易紧张与不安。也就是说，更多的是一种被动结果。</p><p>而一些有名望的人则是另一种局面，他们更多地可能会选择主动避免与回避某些社交，比如冯唐，因为他们认为这些潜在的朋友不能带给自己更多的价值。</p><p>我觉得我大学时期看起来还是比较 E（Extravert）的，因为那时候我在班级里公开募资炒股、参加了一个社团、创办了一个社团、经常要打需要上台展示的商赛、经常参加某些商业或学术会议等。</p><p>但怎么说呢，其实我知道我的骨子里是 I（Introvert）的，因为如果非无必要，我更倾向于独处，比如就像现在这般，好好地码会字，这让我感到很安详。</p><p>我在社交平台上的话绝对属于不算少的那类，但更多的情况下，（我觉得）那是因为我 FP 的性格底色让我想要发表更多，而非想要获得更多。</p><p>所以我之前应该是比较喜欢交朋友，现在也是比较喜欢，最后我希望自己是较为喜欢（从 2 降到 1）。</p><p>ANS: 2, 1</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="2-you-spend-a-lot-of-your-free-time-exploring-various-random-topics-that-pique-your-interest">2. You spend a lot of your free time exploring various random topics that pique your interest<a class="hash-link" href="#2-you-spend-a-lot-of-your-free-time-exploring-various-random-topics-that-pique-your-interest" title="标题的直接链接">​</a></h3><p>我是否花很多时间在一些引起兴趣的随机话题上？</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650536422237-de67e0eb440c23f578f517213c56442c737d0a21d15c7a930f139af17d30fb47.png" alt="picture 8" class="img_vXGZ"></p><p>感觉是 TF 题。是的，比如小花梅、上海疫情等。</p><p>很显然，目前应该是的，毕竟上海疫情一个月以来，由于其前所未有的三观崩裂，我几乎是上海瓜田里乱窜的猹钻来钻去，已经花费了很长的时间。</p><p>但怎么说呢，这个东西，既有优点又有缺点，其实本质问题就是是否有足够的好奇心，代价就是容易影响到自己既有的计划。</p><p>我应该一直都是比较容易花时间研究感兴趣的事情的人（并不惜改变牺牲一些既定需要完成的任务，以至于……我最后毕业后竟然跨行工作了……）。</p><p>未来我可能还会继续关注投资、潮流等领域，因此对于这道题，应该来说，不可能完全选不同意，比较合理的答案是曾经比较同意，未来相对不同意（毕竟那时候三观较为稳定了，不太需要一直关注外界的新东西）。</p><p>ANS: 2, -1</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="3-seeing-other-people-cry-can-easily-make-you-feel-like-you-want-to-cry-too">3. Seeing other people cry can easily make you feel like you want to cry too<a class="hash-link" href="#3-seeing-other-people-cry-can-easily-make-you-feel-like-you-want-to-cry-too" title="标题的直接链接">​</a></h3><p>我是否看见别人哭时也容易哭？</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650531710336-50117e102315a84601fd2742f15a8316b657e1ed35d0dd4ce096661ef638017d.png" alt="https://www.pinterest.com/pin/10344274142071053/" class="img_vXGZ"></p><p>TF 题。是的。</p><p>我真心觉得我泪点还是比较低的，比如看红楼梦、人世间等， 真能把我哭个半死，抑郁好长时间。</p><p>以前是见不得女孩哭，后来慢慢地，基于众所周知的原因，更见不得男人哭。</p><p>不过我不觉得这是个什么丢人的事，同理心，人皆有之，而且我的职业也不需要我过多的压抑自己的情绪。</p><p>我并不想变得过于冷血，但我也希望未来自己情绪能更稳定一些、更客观一些（-1 到 1 之间），但具体想偏向哪边说实话我还真不能确定。</p><p>我未来到底还希不希望自己看到别人哭时自己也愿意稍微哭一点呢？</p><p>或许可以从佛学中得到点启示，平和心吧，所以未来希望是 0，不悲也不喜。</p><p>但考虑到尽量不要选中性答案，既然生而为人，还是选相对同意吧。</p><p>ANS: 2, 1</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="4-you-often-make-a-backup-plan-for-a-backup-plan">4. You often make a backup plan for a backup plan<a class="hash-link" href="#4-you-often-make-a-backup-plan-for-a-backup-plan" title="标题的直接链接">​</a></h3><p>我经常为 B 计划准备 C 计划吗？</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650531918847-2d9b44b3cf77e6820e9f289cee4c5c1edd97adaa1a9e460678296f478b8d98b8.png" alt="picture 6" class="img_vXGZ"></p><p>JP 题。否。</p><p>hmm，这道题，我应该是坚定地选否了，我甚至一般都没有 B 计划，只有 A 计划。</p><p>我向来不是很喜欢做策划、执行类工作，而且未来大概率也不会。</p><p>也向来是一个敢爱敢恨、敢拼敢做的人，经常在自己只有 59 分的时候去挑战 99 分的任务，最终可能只有 79 分。</p><p>有些时候赢了，有些时候输了。</p><p>坦白说，很多时候真没想过输了后会怎么做。</p><p>只有一条：无论输赢，我们的人生都将继续下去。</p><p>每每想到这，我也就没有什么好怕的，只要想，便往前冲就是。</p><p>所以，目前是-3，未来有孩子之类的话，大概率是-1。</p><p>ANS: -3, -1</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="5-you-usually-stay-calm-even-under-a-lot-of-pressure">5. You usually stay calm, even under a lot of pressure<a class="hash-link" href="#5-you-usually-stay-calm-even-under-a-lot-of-pressure" title="标题的直接链接">​</a></h3><p>我经常在高压状态之下也能保持冷静？</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650532878798-6bc68acc10908ff74441338a18fe6d16500b0b74634dcd1617551dee5a81a368.png" alt="picture 7" class="img_vXGZ"></p><p>TF 题。是的。</p><p>接上题，我觉得很多情况下，之所以有勇气去承接一些新的项目、面对一些新的风暴、挑战一些新的极限，其很重要的一个原因，是我确实经常能够保持冷静，我也有段时间刻意去控制、训练自己的这种特质。</p><p>在高压状态下，比如临考前、项目攻关之时，我会刻意地去冲澡、冥想、听舒缓或激动的音乐，压力极大的情况下也可能考虑抽两根烟，保持头脑的镇定，审视自己能调用的所有资源，仔细去思考问题的可行方案。</p><p>这些一次又一次的艰难考验，磨练了我的意志力，并不断内化为心中的平稳与自信，最终外化为情绪的稳定与镇静，进一步增大我做成一件事的概率。</p><p>正如马斯克所言，比起悲观，他更倾向于乐观。</p><p>我也如此，在此基础之上，比起慌乱，我更倾向于冷静。</p><p>不过其实，我也曾经有过巨大的怀疑过，大学里有一次因为一件很小的社团矛盾，顿感过人生的不值得，当时我在宿舍楼的楼顶，说实话真有一股向下的冲动，还好当时有着封锁起来的玻璃门，现在想来也是十分地幼稚的。尽管这么说并不够负责，我们不能把现在的心态去作用在当时上面。</p><p>人的内心是逐渐成长的，但未来的问题也会越来越大，它就像一追一赶的关系，你真地不知道什么时候你会有完全撑不住的时候，maybe 买房还贷资金锻炼的时候？or maybe 亲人……</p><p>May peace with us all.</p><p>ANS: 3, 3</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="6-at-social-events-you-rarely-try-to-introduce-yourself-to-new-people-and-mostly-talk-to-the-ones-you-already-know">6. At social events, you rarely try to introduce yourself to new people and mostly talk to the ones you already know<a class="hash-link" href="#6-at-social-events-you-rarely-try-to-introduce-yourself-to-new-people-and-mostly-talk-to-the-ones-you-already-know" title="标题的直接链接">​</a></h3><p>在社交场合，我是否经常与熟人交谈，而非向陌生人介绍自己？</p><p>EI 题。是的。</p><p>如非职业需要，我想大多数人应该都倾向于与熟人交流，而非与陌生人吧~</p><p>但这不代表这问题就不重要，毕竟 MBTI 可辅助作为职业性格测试。</p><p>也许真地有天生就喜欢认识新人的人存在？</p><p>遗憾的是，我不属于这类；幸运的是，我的职业同样不需要我主动地去认识更多的人。</p><p>所以在这点上我不拧巴，也不需要拧巴。</p><p>但其实在这点上我做的应该还好，我也曾试过在社交场合主动地去认识我感兴趣的人，最后的效果其实还不错。大部分当时就得到了回应，后续还成为了不错的朋友。</p><p>在社交场合，适当地主动认识自己感兴趣的人，应该是我的主基调，因此我选较为认同。</p><p>ANS: 1, 1</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="7-you-prefer-to-completely-finish-one-project-before-starting-another">7. You prefer to completely finish one project before starting another<a class="hash-link" href="#7-you-prefer-to-completely-finish-one-project-before-starting-another" title="标题的直接链接">​</a></h3><p>我更倾向于在完成一个项目之后再开启另一个？</p><p>JP 题。是的。</p><p>我记得我在大学的某个大课堂上，对着学弟学妹们公开说我是一个比较喜欢多线程的人，比如同时聊天同时忙着学习等。</p><p>但事实上，我后来意识到，其实不是这样的。</p><p>我反思我若能同时进行某些东西，它们一般是比较平凡的、不需要太多脑力的。</p><p>但这其实已经与我这几年的真实工作场景有所区别，目前我的很多项目压力还是较大的、有不可预期的失败风险，因此需要我全身心的投入，比如考研和一些商业开发项目。</p><p>而经过这些项目的历练，我意识到，我其实并不擅长同时进行多个项目。具体地说，我其实并不适合项目管理那种职业角色，我现在很喜欢目前的开发工作，那种全程从 0 到 1、完全掌握自己的进度，最终把东西完美结项的感觉是我非常享受的。</p><p>因此，这道题，我目前是很同意的，因为比起多条线同时操作导致的意外风险，我更希望能一个个来，这样会更有信心一些，all-in 的感觉说实话真地很不错。</p><p>之前看马斯克说他在最艰难的时候面临两家公司的取舍问题，最终他坚持了两个一起搞并且都成功了。</p><p>我不确定我是否也会面临那样的抉择，但大概率是会的；我也不确定最终是否也能那么顺利，也许也是会的。</p><p>但我内心还是希望，能一个个来的。</p><p>ANS: 2, 2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="8-you-are-very-sentimental">8. You are very sentimental<a class="hash-link" href="#8-you-are-very-sentimental" title="标题的直接链接">​</a></h3><p>我是否多愁善感？</p><p>TF 题。是的。</p><p>我是一个典型的巨蟹座，多愁善感。（当然这也与我很多比较坎坷的人生经历有关）</p><p>我自己虽然不信星座，但是巨蟹的多愁善感倒是逐渐刻进了我的基因，并且接受了这种设定。</p><p>根据<a href="https://www.zhihu.com/question/19621312" target="_blank" rel="noopener noreferrer">星座合理性在哪里？ - 知乎</a>，整理星座有效性的背后理论如下：</p><ol><li>巴纳姆效应：人倾向于相信一个笼统的、抽象的人格描述，并认为适合自己</li><li>证实性偏见：人倾向于寻找支持预设观点的证据，并忽略相反证据</li><li>罗森塔尔效应：心理暗示让人按照暗示的方向去实现自己</li></ol><p>我的理解是星座就是个潘多拉魔盒，在你不了解之前，你觉得自己是多面性的、有无限发展潜能的。而当你接触之后，你首先会接受该星座的某些预设成见，并逐步相信，按照这个去发展自己，而同时，身边也有越来越多的人加入这个队伍，并进一步巩固这个理论的科学性。</p><p>于是，这个理论，便持久地在这个世界上运转了，除非有猛烈的文章去抨击它，致使所有人都觉得这个理论的荒谬。然而，大家普遍又没有去推翻这个机制的动机，因为星座本身，是中性的、无害的，与其所有人都完全清醒地活着，不如多一个可以找乐子、并且确实有很多被证实的先例的理论，用以发展社交。</p><p>同时根据 MBTI，相信星座的可能更多的是 N 型人格，情侣或者朋友之间如果恰好都相信星座，可以多一条维系情感的纽带，属于同一磁场的人；当然基于星座再衍生出来的配对理论，情侣之间如果恰好处于不那么准的一对的话，据我的直觉与经验，他们也会选择无视。</p><p>从这个角度上来说，相信星座的人把星座当做自己工具箱中的一个有利工具，他们会在这个工具合适的时候拿出来用，不合适的时候就放在那。</p><p>基于以上，我也不打算对我多愁善感的性格多有什么其他的想法，顺其自然即可。</p><p>ANS: 3, 2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="9-you-like-to-use-organizing-tools-like-schedules-and-lists">9. You like to use organizing tools like schedules and lists<a class="hash-link" href="#9-you-like-to-use-organizing-tools-like-schedules-and-lists" title="标题的直接链接">​</a></h3><p>我喜欢使用计划表、列表等组织工具？</p><p>JP 题。是的。</p><p>很显然，是否有使用计划工具的偏好与习惯，是能体现一个人的自律性。而近几年烂大街推崇的自律，又是每个人都无法绕开的一个命题。</p><p>但很可惜的是，我们喜欢与拥有计划工具，却并不意味着我们就能贯彻执行。</p><p>从我自己出发，我在大学里的时候说实话，计划性不强，因为其实每天都有很多事要做，立即要做，而非有一个长远的目标。</p><p>关于这点，有一位学长对我的分析特别到位，他说我更喜欢做那些紧急但不重要的事（例如比赛），而非那些不紧急但重要的事（例如考研）。</p><p>确实如此，我绝大多数比赛的结果都较为乐观，但在考研上确实付出了较为沉重的代价。这是值得反思的。</p><p>不过考研也确实锻炼了我的计划能力，我曾经给自己定制了极其充实的日程表，也确实严格执行了：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650561197857-3298ddc49b513140b522a5321953f7d8b34c63cde6e72a8ee204d47e6f931c57.png" alt="picture 10" class="img_vXGZ"></p><p>在那之后，又经过了某些高强度项目的淬炼，对计划（尤其是 TODO）之类的管理更加重视，但随着数目的增长也确实越来越难以管理。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_mbti-1650561373371-a78bfa618506879b11a26d0582069974dfad3db3d9994e0f93bd16138298813f.png" alt="picture 11" class="img_vXGZ"></p><p>但不管怎样，承认自己的脑子不如一些计划工具好用，我将尽量使用与坚持使用计划工具管理自己。</p><p>ANS: 3, 3</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="10-even-a-small-mistake-can-cause-you-to-doubt-your-overall-abilities-and-knowledge">10. Even a small mistake can cause you to doubt your overall abilities and knowledge<a class="hash-link" href="#10-even-a-small-mistake-can-cause-you-to-doubt-your-overall-abilities-and-knowledge" title="标题的直接链接">​</a></h3><p>我会因为一个小错误而自我怀疑自己的整体能力吗？</p><p>可能是 TP 题。不会。</p><p>错误是在所难免的，关键是错在哪一层，以及错到哪一层。</p><p>这让我不禁想起机器学习的原理，即不断地从误差中完善自身，以减少最终的误差。</p><p>我们接受了十多年的教育，对我们所学习的理论、人文知识有着充足的信心，不大可能轻易地动摇对我们自身能力系统的信任基础。</p><p>但容易崩溃的场景确实存在，并且很难避免。</p><p>我的看法是，保持开诚互、敏捷反应、终身学习！</p><p>ANS: -3, -3</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="11-you-feel-comfortable-just-walking-up-to-someone-you-find-interesting-and-striking-up-a-conversation">11. You feel comfortable just walking up to someone you find interesting and striking up a conversation<a class="hash-link" href="#11-you-feel-comfortable-just-walking-up-to-someone-you-find-interesting-and-striking-up-a-conversation" title="标题的直接链接">​</a></h3><p>我是自来熟吗？</p><p>EI 题。是的。</p><p>尽管大多数时候我其实并不够自信，同时也因为没有正式学习过一些社交礼仪、技巧相关的经历，所以其实类似自来熟的能力，我是不怎么具备的。</p><p>但我联想到我的过往，我确实会愿意去主动与我感兴趣的人交流，比如讲座过后去追问老师一些问题甚至所要联系方式，以及曾经当着女朋友面去问别的女孩微信以体现自己的社牛（这是后来反思做过的最傻逼的事情之一）。</p><p>因此，这道题还是偏同意为主。未来并不打算变得更加主动，也不打算变得相反，维持目前这个级别的社交意愿与能力即可。</p><p>ANS: 1, 1</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="12-you-are-not-too-interested-in-discussing-various-interpretations-and-analyses-of-creative-works">12. You are not too interested in discussing various interpretations and analyses of creative works<a class="hash-link" href="#12-you-are-not-too-interested-in-discussing-various-interpretations-and-analyses-of-creative-works" title="标题的直接链接">​</a></h3><p>我是否对开发性的、分析性的创意工作的交流不太感兴趣？</p><p>TF 题。否。</p><p>我还是比较喜欢开放性的话题的。</p><p>而且众所周知，一部电影（例如误杀）/一本书（例如红楼梦），留给大家的是一个开放性的结尾，会让人觉得很意味深长。</p><p>也许会有人更加喜欢确定的、被安排好的结局（大概真地存在吧！），但我一定是投开放票的（如果有的话）。</p><p>而在实际工作中，我们往往需要具备全局统筹的能力，照顾安排各方的想法意见等，例如对于上海疫情到底是封城好还是放开好等，我是相对比较喜欢去研究这些问题。（参见： <a href="https://www.youtube.com/watch?v=Y4HqXP47lPQ" target="_blank" rel="noopener noreferrer">《正義：一場思辨之旅》之電車問題 (雙語字幕) - YouTube</a>）</p><p>但这也有一定的缺点，那就是讨论的越激烈越容易迷失，花费很多时间但其实大多数情况下不能得出一个实际可操作的解，例如我曾经和基友通宵讨论“灵魂伴侣是否存在”……</p><p>ANS: -2, -2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="13-you-are-more-inclined-to-follow-your-head-than-your-heart">13. You are more inclined to follow your head than your heart<a class="hash-link" href="#13-you-are-more-inclined-to-follow-your-head-than-your-heart" title="标题的直接链接">​</a></h3><p>我更愿意听从我的理智而非内心？</p><p>TF 题。否。</p><p>这道题，其实……怎么说呢，应该说是一个经典的问题了，听从理智，亦或顺从内心。</p><p>在回答这个问题之前，我觉得我们得首先做个较为明确的定义，即什么是理智什么是内心。</p><p>我个人认为理智就是更关注外界的条件如何，而内心则更关注自己能做到什么地步。</p><p>而当我们讨论到底是顺从理智还是顺从内心时，可能更多的是在考虑：面临客观的条件，我们在多大程度上愿意发挥主观能动性？</p><p>很多电影都喜欢植入这样的理念：主人公在关键的时候，听从了自己的内心，经历了非凡的考验，最终得到一个圆满的结果的。比如《毕业生》里男主的理智告诉自己和罗宾逊夫人是不可能的，但还是听从了内心，大胆地去尝试。</p><p>很有意思的是，当我们产生某些情愫时，好像心脏部分确实有更大的反应，我不是很懂心理学与生理学，但似乎这些反应确实导致了我们将“心”和“脑”分成两部分去独立看待，一部分叫感性，一部分叫理性。然而近几年“上头”或者“下头”的网络词又不胫而走，似乎开始模糊理智和内心之间的界线。</p><p>我的观点，我觉得强制把心和脑分开去讨论，可能是有点偷懒的。无论做什么决定，其实都是经过我们思考的。就拿表白来说，我不认为鼓起勇气表白属于顺心，反之顺脑；我可能更倾向于认为前者只是更有勇气、风险偏好较高，后者相反而已。</p><p>理智与内心可能并非对立的，更多的时候，它们两，我觉得，是综合的，即最终合起来进入大脑的决策，而非要么进入理智的门、要么进入内心的门，好像我们的身体中有两个决策机构一样。</p><p>比如 21 年我决定去骑行川藏线，那几乎就是一晚上做完的决定，其实从理智层面我知道会有很大的风险，我在尚未认识到足够多的风险之前，就直接光速上阵了，后续路上我重摔过两次，还在在羊湖的山顶差点冻死，因此比起理智与审慎，我确实更倾向于坚持内心想做的事，未来大概率也不会变。</p><p>我宁可后悔而不想留有遗憾。</p><p>未来我其实希望自己更理智一些，不过估计做不到，那就略微从-3 提到-2 吧。</p><p>ANS: -3, -2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="14-you-usually-prefer-just-doing-what-you-feel-like-at-any-given-moment-instead-of-planning-a-particular-daily-routine">14. You usually prefer just doing what you feel like at any given moment instead of planning a particular daily routine<a class="hash-link" href="#14-you-usually-prefer-just-doing-what-you-feel-like-at-any-given-moment-instead-of-planning-a-particular-daily-routine" title="标题的直接链接">​</a></h3><p>比起循规蹈矩，我更喜欢基于当时的感觉做自己想做的事？</p><p>JP 题。是的。</p><p>循规蹈矩、按流程办事，很适合执行人员风格。</p><p>但我逐渐地意识到，按照既定计划做事而无视其他临时的冲动，当且仅当这个既定的计划是有效的、是我愿意去执行的，才行。</p><p>但很多时候，我们发现我们不得不去做一些我们当时不愿意去乖乖执行的事。</p><p>这些事中，有些我们后悔了，比如学生时代的眼保健操、正楷书法等，不重视、不愿意去好好地练，未来都吃到了不同程度的苦头。</p><p>无可否认的是，即使站在当下这个时间点，再去审视从前，以及现在，会发现很多情况下，我们还是公然地在自己的既定计划上“为非作歹”：不够自律，思想飘忽，并且绝大多数这些本可以用于工作的时间和精力投入到其他地方后，并没有给自己带来多少的增益。</p><p>很难说这些思想的自由流动，是否真正构建了灵魂的自由，我多多少少难以说服自己说：不要再乱想了，先把手头任务完成再说吧！</p><p>不过，我还是希望尽量吧。</p><p>ANS: 3, 2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="15-you-rarely-worry-about-whether-you-make-a-good-impression-on-people-you-meet">15. You rarely worry about whether you make a good impression on people you meet<a class="hash-link" href="#15-you-rarely-worry-about-whether-you-make-a-good-impression-on-people-you-meet" title="标题的直接链接">​</a></h3><p>我很少担心自己给别人留下的印象好不好？</p><p>EI 题。是的。</p><p>其实一般来说，我们但不担心给别人留下坏印象，主要取决于对方在自己心中重不重要（包括情感方面或者利益方面）。</p><p>不过抛开上者不谈，我也确实曾经因为某些事，了解到某些人对我的负面评价，自那之后，我深刻地明白这个世界想让所有人都满意是不可能的。</p><p>哪怕是雷锋，好人至此，都被一群小人所记恨呢。</p><p>现在我就倾向于做好自己，走自己的路，让别人去说；当然，适当了解一下别人的看法，有助于自己的进一步提高。</p><p>ANS: 2, 2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="16-you-enjoy-participating-in-group-activities">16. You enjoy participating in group activities<a class="hash-link" href="#16-you-enjoy-participating-in-group-activities" title="标题的直接链接">​</a></h3><p>我喜欢参与集体活动？</p><p>EI 题。否。</p><p>不是很喜欢，更加喜欢独立做些东西，发挥自己的主导作用而非螺丝钉作用。</p><p>不过如果有很好的朋友在里面，倒是很乐意一起。</p><p>ANS: -2, -2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="17-you-like-books-and-movies-that-make-you-come-up-with-your-own-interpretation-of-the-ending">17. You like books and movies that make you come up with your own interpretation of the ending<a class="hash-link" href="#17-you-like-books-and-movies-that-make-you-come-up-with-your-own-interpretation-of-the-ending" title="标题的直接链接">​</a></h3><p>我喜欢开放性结尾的书籍和电影？</p><p>TF 题。是。</p><p>接近第 12 题。</p><p>ANS: 2, 2</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="18-your-happiness-comes-more-from-helping-others-accomplish-things-than-your-own-accomplishments">18. Your happiness comes more from helping others accomplish things than your own accomplishments<a class="hash-link" href="#18-your-happiness-comes-more-from-helping-others-accomplish-things-than-your-own-accomplishments" title="标题的直接链接">​</a></h3><p>我的快乐更多地来自于帮助别人，而非来自于自己？</p><p>EI 题。否。</p><p>我其实一直都是一个挺乐意帮助别人的人。</p><p>在大学期间，真地抱着去改变一些东西的想法，去办社团、开展编程教学等。</p><p>当然，这中间，有没有掺杂一些表现欲，肯定还是有的。</p><p>但是后来，我发现，从客观角度来说，这样的时间、精力成本太高了，简而言之就是：一个人可以走的很快，一群人走的很远。</p><p>但问题是，话虽这么说，这个“一群人”却往往不是那么牢固的，今天是这群人，明天就是那群人，这是很多问题的一些根源。</p><p>这个想法，非我一人。</p><p>我有一位学长，在我们社团也是出了名的乐于助人。很遗憾的是，后来他读研后告诉我，他已经不那么热衷于改变身边的人了（主要是硕士阶段的同学思维已经快成型，不热衷于听别人的想法与建议了）。</p><p>我从他语气中读出的那种失望，至今仍印象深刻。</p><p>我希望能更多地去帮助确实需要帮助、并且对彼此成长都有益的人（比如今年创了个行业交流群，独乐乐不如众乐乐），而非盲目地、非选择性地来者不拒。</p><p>但总体来说，我还是倾向于自己完成一些东西，这样更有成就感，这么想的原因也可能是因为认识到了自己羽翼确实不够丰满。</p><p>也许有朝一日，可以完全不需要在乎自己的目前水平，而致力于投身于从别人的成功那里获取快乐，尽管不知道这种转变有没有足够的必要。</p><p>ANS: -1, -1</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="19-you-are-interested-in-so-many-things-that-you-find-it-difficult-to-choose-what-to-try-next">19. You are interested in so many things that you find it difficult to choose what to try next<a class="hash-link" href="#19-you-are-interested-in-so-many-things-that-you-find-it-difficult-to-choose-what-to-try-next" title="标题的直接链接">​</a></h3><p>我的兴趣实在过于广泛以至于经常在选择上犯难？</p><p>TF 题。绝对是的！</p><p>这题我有绝对的发言权，毕竟我是那么深入地同时研究金融与计算机过，从我大二开始，我就在要不要投入到计算机行业这个问题上十分纠结。</p><p>大三在投行实习时，我老板跟我聊我的未来规划的问题，她直截了当地说总有一天我是要必须做出选择的：金融亦或计算机，而非两个同时学。</p><p>也许是命中注定，后来，可能是因为我过于明确地表达我有考研的意愿，我最终在华兴投行的 hr 面试中被拒绝。</p><p>再之后，我领导开发了很多初中期公司的商业项目，深知自己非全身心投入到某个具体领域中去炮炼成长不可，因此便再也不考虑金融行业的择业方向了。</p><p>我相信，金融与计算机的择业问题，仅仅还是我人生生涯中的第一个较大的选择问题。以我的性格，未来还将继续饱受折磨。</p><p>ANS: 3, 3</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="20-you-are-prone-to-worrying-that-things-will-take-a-turn-for-the-worse">20. You are prone to worrying that things will take a turn for the worse<a class="hash-link" href="#20-you-are-prone-to-worrying-that-things-will-take-a-turn-for-the-worse" title="标题的直接链接">​</a></h3><p>你很容易担心事情会往坏的方向去发展？</p><p>SN 题。否。</p><p>没啥可担心的，兵来将挡水来土掩，能乐观绝不悲观（但会做好最悲观的打算）。</p><p>ANS: -3, -3</p><hr><p>【待续！】</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="21-you-avoid-leadership-roles-in-group-settings">21. You avoid leadership roles in group settings<a class="hash-link" href="#21-you-avoid-leadership-roles-in-group-settings" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="22-you-are-definitely-not-an-artistic-type-of-person">22. You are definitely not an artistic type of person<a class="hash-link" href="#22-you-are-definitely-not-an-artistic-type-of-person" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="23-you-think-the-world-would-be-a-better-place-if-people-relied-more-on-rationality-and-less-on-their-feelings">23. You think the world would be a better place if people relied more on rationality and less on their feelings<a class="hash-link" href="#23-you-think-the-world-would-be-a-better-place-if-people-relied-more-on-rationality-and-less-on-their-feelings" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="24-you-prefer-to-do-your-chores-before-allowing-yourself-to-relax">24. You prefer to do your chores before allowing yourself to relax<a class="hash-link" href="#24-you-prefer-to-do-your-chores-before-allowing-yourself-to-relax" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="25-you-enjoy-watching-people-argue">25. You enjoy watching people argue<a class="hash-link" href="#25-you-enjoy-watching-people-argue" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="26-you-tend-to-avoid-drawing-attention-to-yourself">26. You tend to avoid drawing attention to yourself<a class="hash-link" href="#26-you-tend-to-avoid-drawing-attention-to-yourself" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="27-your-mood-can-change-very-quickly">27. Your mood can change very quickly<a class="hash-link" href="#27-your-mood-can-change-very-quickly" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="28-you-lose-patience-with-people-who-are-not-as-efficient-as-you">28. You lose patience with people who are not as efficient as you<a class="hash-link" href="#28-you-lose-patience-with-people-who-are-not-as-efficient-as-you" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="29-you-often-end-up-doing-things-at-the-last-possible-moment">29. You often end up doing things at the last possible moment<a class="hash-link" href="#29-you-often-end-up-doing-things-at-the-last-possible-moment" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="30-you-have-always-been-fascinated-by-the-question-of-what-if-anything-happens-after-death">30. You have always been fascinated by the question of what, if anything, happens after death<a class="hash-link" href="#30-you-have-always-been-fascinated-by-the-question-of-what-if-anything-happens-after-death" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="31-you-usually-prefer-to-be-around-others-rather-than-on-your-own">31. You usually prefer to be around others rather than on your own<a class="hash-link" href="#31-you-usually-prefer-to-be-around-others-rather-than-on-your-own" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="32-you-become-bored-or-lose-interest-when-the-discussion-gets-highly-theoretical">32. You become bored or lose interest when the discussion gets highly theoretical<a class="hash-link" href="#32-you-become-bored-or-lose-interest-when-the-discussion-gets-highly-theoretical" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="33-you-find-it-easy-to-empathize-with-a-person-whose-experiences-are-very-different-from-yours">33. You find it easy to empathize with a person whose experiences are very different from yours<a class="hash-link" href="#33-you-find-it-easy-to-empathize-with-a-person-whose-experiences-are-very-different-from-yours" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="34-you-usually-postpone-finalizing-decisions-for-as-long-as-possible">34. You usually postpone finalizing decisions for as long as possible<a class="hash-link" href="#34-you-usually-postpone-finalizing-decisions-for-as-long-as-possible" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="35-you-rarely-second-guess-the-choices-that-you-have-made">35. You rarely second-guess the choices that you have made<a class="hash-link" href="#35-you-rarely-second-guess-the-choices-that-you-have-made" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="36-after-a-long-and-exhausting-week-a-lively-social-event-is-just-what-you-need">36. After a long and exhausting week, a lively social event is just what you need<a class="hash-link" href="#36-after-a-long-and-exhausting-week-a-lively-social-event-is-just-what-you-need" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="37-you-enjoy-going-to-art-museums">37. You enjoy going to art museums<a class="hash-link" href="#37-you-enjoy-going-to-art-museums" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="38-you-often-have-a-hard-time-understanding-other-peoples-feelings">38. You often have a hard time understanding other people’s feelings<a class="hash-link" href="#38-you-often-have-a-hard-time-understanding-other-peoples-feelings" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="39-you-like-to-have-a-to-do-list-for-each-day">39. You like to have a to-do list for each day<a class="hash-link" href="#39-you-like-to-have-a-to-do-list-for-each-day" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="40-you-rarely-feel-insecure">40. You rarely feel insecure<a class="hash-link" href="#40-you-rarely-feel-insecure" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="41-you-avoid-making-phone-calls">41. You avoid making phone calls<a class="hash-link" href="#41-you-avoid-making-phone-calls" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="42-you-often-spend-a-lot-of-time-trying-to-understand-views-that-are-very-different-from-your-own">42. You often spend a lot of time trying to understand views that are very different from your own<a class="hash-link" href="#42-you-often-spend-a-lot-of-time-trying-to-understand-views-that-are-very-different-from-your-own" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="43-in-your-social-circle-you-are-often-the-one-who-contacts-your-friends-and-initiates-activities">43. In your social circle, you are often the one who contacts your friends and initiates activities<a class="hash-link" href="#43-in-your-social-circle-you-are-often-the-one-who-contacts-your-friends-and-initiates-activities" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="44-if-your-plans-are-interrupted-your-top-priority-is-to-get-back-on-track-as-soon-as-possible">44. If your plans are interrupted, your top priority is to get back on track as soon as possible<a class="hash-link" href="#44-if-your-plans-are-interrupted-your-top-priority-is-to-get-back-on-track-as-soon-as-possible" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="45-you-are-still-bothered-by-mistakes-that-you-made-a-long-time-ago">45. You are still bothered by mistakes that you made a long time ago<a class="hash-link" href="#45-you-are-still-bothered-by-mistakes-that-you-made-a-long-time-ago" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="46-you-rarely-contemplate-the-reasons-for-human-existence-or-the-meaning-of-life">46. You rarely contemplate the reasons for human existence or the meaning of life<a class="hash-link" href="#46-you-rarely-contemplate-the-reasons-for-human-existence-or-the-meaning-of-life" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="47-your-emotions-control-you-more-than-you-control-them">47. Your emotions control you more than you control them<a class="hash-link" href="#47-your-emotions-control-you-more-than-you-control-them" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="48-you-take-great-care-not-to-make-people-look-bad-even-when-it-is-completely-their-fault">48. You take great care not to make people look bad, even when it is completely their fault<a class="hash-link" href="#48-you-take-great-care-not-to-make-people-look-bad-even-when-it-is-completely-their-fault" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="49-your-personal-work-style-is-closer-to-spontaneous-bursts-of-energy-than-organized-and-consistent-efforts">49. Your personal work style is closer to spontaneous bursts of energy than organized and consistent efforts<a class="hash-link" href="#49-your-personal-work-style-is-closer-to-spontaneous-bursts-of-energy-than-organized-and-consistent-efforts" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="50-when-someone-thinks-highly-of-you-you-wonder-how-long-it-will-take-them-to-feel-disappointed-in-you">50. When someone thinks highly of you, you wonder how long it will take them to feel disappointed in you<a class="hash-link" href="#50-when-someone-thinks-highly-of-you-you-wonder-how-long-it-will-take-them-to-feel-disappointed-in-you" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="51-you-would-love-a-job-that-requires-you-to-work-alone-most-of-the-time">51. You would love a job that requires you to work alone most of the time<a class="hash-link" href="#51-you-would-love-a-job-that-requires-you-to-work-alone-most-of-the-time" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="52-you-believe-that-pondering-abstract-philosophical-questions-is-a-waste-of-time">52. You believe that pondering abstract philosophical questions is a waste of time<a class="hash-link" href="#52-you-believe-that-pondering-abstract-philosophical-questions-is-a-waste-of-time" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="53-you-feel-more-drawn-to-places-with-busy-bustling-atmospheres-than-quiet-intimate-places">53. You feel more drawn to places with busy, bustling atmospheres than quiet, intimate places<a class="hash-link" href="#53-you-feel-more-drawn-to-places-with-busy-bustling-atmospheres-than-quiet-intimate-places" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="54-you-know-at-first-glance-how-someone-is-feeling">54. You know at first glance how someone is feeling<a class="hash-link" href="#54-you-know-at-first-glance-how-someone-is-feeling" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="55-you-often-feel-overwhelmed">55. You often feel overwhelmed<a class="hash-link" href="#55-you-often-feel-overwhelmed" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="56-you-complete-things-methodically-without-skipping-over-any-steps">56. You complete things methodically without skipping over any steps<a class="hash-link" href="#56-you-complete-things-methodically-without-skipping-over-any-steps" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="57-you-are-very-intrigued-by-things-labeled-as-controversial">57. You are very intrigued by things labeled as controversial<a class="hash-link" href="#57-you-are-very-intrigued-by-things-labeled-as-controversial" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="58-you-would-pass-along-a-good-opportunity-if-you-thought-someone-else-needed-it-more">58. You would pass along a good opportunity if you thought someone else needed it more<a class="hash-link" href="#58-you-would-pass-along-a-good-opportunity-if-you-thought-someone-else-needed-it-more" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="59-you-struggle-with-deadlines">59. You struggle with deadlines<a class="hash-link" href="#59-you-struggle-with-deadlines" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_rB0w" id="60-you-feel-confident-that-things-will-work-out-for-you">60. You feel confident that things will work out for you<a class="hash-link" href="#60-you-feel-confident-that-things-will-work-out-for-you" title="标题的直接链接">​</a></h3></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_rTaS padding--none margin-left--sm"><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/札记">札记</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/人生">人生</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/性格">性格</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/mbti">MBTI</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_UBNu" itemprop="headline"><a itemprop="url" href="/blog/2022/03/27/prose-321-air-crash">札记 | 愿逝者安息生者坚强，你我迎风奔跑向阳而生</a></h2><div class="container_x5Un margin-vert--md"><time datetime="2022-03-27T00:00:00.000Z" itemprop="datePublished">2022/03/27</time> · <!-- -->阅读需 8 分钟</div></header><div class="markdown" itemprop="articleBody"><p>三月二十一日，于某些人，某些家庭，是一个无法面对的日子。</p><p>这一天，于我，同样难以承受。</p><p>那天前夜，我困倦地倒趴床上不慎入眠，凌晨三点醒来后才拾掇进入被窝，之后五点、七点又醒，像往日一样洗漱后坐在椅子上吃着面包，稍坐直时突发左背剧疼，不能动弹，紧接着脖子就几乎不能转到。势头十分猛烈，前所未有。</p><p>我料想可能是休息不足，或者欠佳，于是回到床上艰难地躺下，企图希望能有好转。</p><p>然而，命运总是这样的无情：当你发现某些疾病有显著的爆发症状时，往往为时已晚。</p><p>这次临时休息历经半小时后，并无任何好转，而我近乎无法起床了，仿佛左肩胛骨处有一根骨头已被抽走，无法肌肉用力。</p><p>我连忙查询相关原因，左背疼痛大致有两种，肌肉痛与心肌痛。由于我按压左背并无明显的压痛感差异，所以不属于肌肉痛，那就属于后者心肌痛，即由心机梗塞突发导致的连带的左背疼痛。</p><p>了解至此，我不禁胆战心惊，立即准备前往附近的医院，最近的是 3 公里外的一家中医院。</p><p>医生首先想的是确定是否心脏问题，于是开单做心电图检测与心肌酶谱七项血检。</p><p>一小时后拿到报告，心电图似乎显示一切正常。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/image-20220327142103975.png" alt="image-20220327142103975" class="img_vXGZ"></p><p>中午挣扎着吃外卖（半跪着在医院的椅子上吃完的，因为脖子没法动）时拿到了血检报告，似乎也是一切正常……</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/image-20220327142206665.png" alt="image-20220327142206665" class="img_vXGZ"></p><p>于是等到下午一点半医生上班后看完报告，认定是软组织挫伤问题，在征求我中西药意见时见我对是否能开中药拿不定主意后开了西药，氟比洛芬凝胶贴膏用于外敷，塞来昔布胶囊用于内服。</p><p>我其实是比较抗拒这个诊断结果的，毕竟从一个医学门外汉的角度看，也许确是软组织的问题，但挫伤，尤其这个“挫”字可能禁不起推敲。</p><p>但总之，既然医生都这么诊了，我也没有什么理由再去辩驳，按医生的建议好好调休一周就是，于是打道回府了。</p><p>回到家后先服了药，打算再躺床上休息会。</p><p>然而真正的噩梦才刚刚开始：下午四五点的时候醒来，发现完全起不来了！</p><p>上半身几乎瘫痪，手一抬起来背就巨疼，一小时内先后数次尝试翻身跪起，结果都以惨叫告终。</p><p>后来打开手机一看，飞机失事了。</p><p>我才真正意识到，原来我们离死亡、瘫痪、意外是如此的近。</p><p>时间一点点消逝，我望着天花板十分绝望，手机电量也开始告急，充电线就在旁边的床前柜上，但因为脖子无法动弹手也无法任意操纵，充电也成了不可能任务。</p><p>那一刻，人生中第一次想喊救护车。</p><p>但为了避免引起小区骚动，我还是打消了这个念头。</p><p>大概两小时后，天色渐渐暗了下来，我尝试着通过胸肌腹肌和大腿直直地坐起来，就仿佛模拟我当时如何躺下去的那样。</p><p>幸运的是，大概一分钟后，我成功了！我坐起来了！这样我就可以给手机充电、点外卖、取快递，我至少可以像个机器人一样慢慢地移动了！</p><p>我们还是要抱着对生的希望的吧，不是吗？比起东航的他们，我已经好太多，我至少还有选择。</p><p>而有些人，别无选择。</p><p>晚上，我听从了好朋友的现身建议，去做了一场按摩，就在楼下的中医按摩店，按摩小哥第一反应就是我受凉了，中途也很仔细地给我按摩左背，全部按完后还让我试试脖子能不能转，并针对性地固定住我胳膊然后砖头又鼓捣了几下，我说实话，还是有效果的，明显比做按摩前舒服多了，起床几乎无压力，就是脖子不能往右转超过 15 度。</p><p>三天过去后，身体又好了些！觉得确实是积劳成疾+受凉导致的，因此从那天开始计划积极锻炼！</p><p>可以看到，确实跑的很慢，尽管去年骑行过西藏，减重 20 斤，然而半年过去，现在的身体实际素质还是进一步堪忧了。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/image-20220327151039794.png" alt="image-20220327151039794" class="img_vXGZ"></p><p>六天过去后，脖子已经基本能正常转动，直到最大角度时才会感觉到左背肌肉拉扯疼痛，而左背正常情况下也只是隐隐作痛而已了。</p><p>随着东航事件最终的收官定论，我觉得也是时候到了一个可以总结的时间点，我们要真地开始认真对待自己的身体、生活与工作了。</p><p>毕竟，你真地不知道明天与意外谁先到。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/13.44.46.png" alt="Screen Shot 2022-03-18 at 13.44.46" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/13.44.50.png" alt="Screen Shot 2022-03-18 at 13.44.50" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/AlwaysLikeThis.jpeg" alt="AlwaysLikeThis" class="img_vXGZ"></p><p>愿逝者安息，愿生者坚强。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/image-20220327151705196.png" alt="image-20220327151705196" class="img_vXGZ"></p><p>愿你我始终能迎风奔跑，向阳而生。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.13.png" alt="Screen Shot 2022-03-17 at 16.52.13" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.17.png" alt="Screen Shot 2022-03-17 at 16.52.17" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.19.png" alt="Screen Shot 2022-03-17 at 16.52.19" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.22.png" alt="Screen Shot 2022-03-17 at 16.52.22" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.25.png" alt="Screen Shot 2022-03-17 at 16.52.25" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.29.png" alt="Screen Shot 2022-03-17 at 16.52.29" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.31.png" alt="Screen Shot 2022-03-17 at 16.52.31" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.33.png" alt="Screen Shot 2022-03-17 at 16.52.33" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.36.png" alt="Screen Shot 2022-03-17 at 16.52.36" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/16.52.39.png" alt="Screen Shot 2022-03-17 at 16.52.39" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/14.21.19.png" alt="Screen Shot 2022-03-18 at 14.21.19" class="img_vXGZ"> <img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_our-lives-1648367989625-73b343bb9fcc4dfa3af82f109848af3d16e37733e4c73427d232a34fc899f550.png" alt="picture 57" class="img_vXGZ"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_rTaS padding--none margin-left--sm"><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/札记">札记</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/养身">养身</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_UBNu" itemprop="headline"><a itemprop="url" href="/blog/2022/03/09/dev-douban-renting">编程 | 北京租房系统设计、研究与经验 0.1.0</a></h2><div class="container_x5Un margin-vert--md"><time datetime="2022-03-09T00:00:00.000Z" itemprop="datePublished">2022/03/09</time> · <!-- -->阅读需 66 分钟</div></header><div class="markdown" itemprop="articleBody"><blockquote><p>通过一天使用程序化手段获取两万多套房源转租信息，继而再通过程序化粗筛成两百多套，紧接着人工细筛出十几套，最后两天内实地考察九套。</p><p>在北京快速的、低成本的找房，我是如何做到的，我又有什么经验心得与启示，这是本文所要阐述的。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_rB0w" id="个人背景概要">个人背景概要<a class="hash-link" href="#个人背景概要" title="标题的直接链接">​</a></h2><p>大学实习基本都是在上海，租过远到嘉定每天来回四小时的自如、租过虹口差点要不回钱的蛋壳，租过和别人同睡一张床第二天赶紧溜走连押金都不想要的复旦老破小，租过闵大荒开始闹到威胁后续被窗外幼儿园治愈的公寓式开间，也为把项目做好租过浦东近万的酒店。</p><p>所以租房，尤其是在一线租房，确实是个头疼的问题。</p><p>现在，作为一名北漂狗，是时候认真研究一下了。</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="租房方案设计">租房方案设计<a class="hash-link" href="#租房方案设计" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="个人需求分析">个人需求分析<a class="hash-link" href="#个人需求分析" title="标题的直接链接">​</a></h3><p>在每个人讨论租房这个问题之前，第一个就是个人需求的剖析。</p><p>就我接触下来，99%的人对价格还是相对敏感的，在此基础之上， 有些人更重视通勤时间（比如我），有些人更重视独卫的便利性（比如某互联网男生），有些人更重视卫生条件（某金融业女生）。</p><p>而预算方面也会因为因人而异，有预算 2000 的，3000 的，4000 的，甚至 6000 的，等等。</p><p>因此从需求、预算角度，每个人所适合的策略就不太一样。</p><p><strong>本文主要介绍的是汇总租房帖然后逐步筛选的方案，理论上适合一切找房群体，同时更适合希望较低成本找房的朋友</strong>。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="公寓-vs-民宅">公寓 vs 民宅<a class="hash-link" href="#公寓-vs-民宅" title="标题的直接链接">​</a></h3><p>我过往的经历，应该来说，住公寓与酒店比较多，现在的年轻人应该大多都是这样。</p><p>公寓也并非不好，尤其是身边同学或者朋友一起住青年公寓那种，就特有氛围。</p><p>但如果是长租，以下问题就不能忽视：</p><ol><li>首先是价格方面，同面积情况下，公寓普遍租金更高，另外商水商电大概是民水民电费用的三倍左右，比如夏天可能开着空调，民水民电的民宅花 150，但公寓就可能是 450，当然这个估算可能不准确，也因人而异</li><li>公寓由于自建等原因，隔音效果普遍不是很好，如果喜欢安静的一定要注意这一点</li><li>公寓往往缺少家的感觉</li></ol><p>如果你能容忍或者确认以上几点，那就很适合选住公寓，因为公寓的配套设施一般更完善，比如自习室、健身房、大厅，甚至食堂等等。</p><p>总之，考虑到我的个人经历与接下来的规划，我就没有考虑公寓了。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="线上-vs-线下">线上 vs 线下<a class="hash-link" href="#线上-vs-线下" title="标题的直接链接">​</a></h3><p>租房大致分纯线上、线上转线下与纯线下三种方式。</p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="纯线下方案">纯线下方案<a class="hash-link" href="#纯线下方案" title="标题的直接链接">​</a></h4><p>首先讲一下纯线下，如果你是经济非常紧张、对居住环境不是很重视，同时社交能力较强（或长的比较友好），希望以最低成本租房的，根据一些文章指出，你可以线下走街串巷，多和低收入人群（保安、清洁工等等）聊一聊，他们通常能给你非常具有性价比的推荐。</p><p>我虽然没有通过这种方式找房，但我确实曾经在拉萨坐人力拉车时和车夫聊过，他就住在大昭寺附近，一个月印象中好像是 300（也有可能是 600）的房子，总之，是很低了，即使我们住青旅，也要三四十一天，一个月下来也是近千的。</p><p>其实吧，我觉得纯线下的最主要条件，还是你要能来事，理论上不单单是光和低收入人群聊，你有能耐的话，也可以和包租婆聊，说不定更能找到非常具有吸引力的房源，对不~</p><p>但对于北漂狗来说，纯线下方案并不是那么容易操作。</p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="纯线上方案">纯线上方案<a class="hash-link" href="#纯线上方案" title="标题的直接链接">​</a></h4><p>接着是纯线上方案，这个方案，应该是很多学生党比较喜欢的方式，照片视频一看，或者根据平台品牌，一下就入了。</p><p>我便是这么走过来的。我甚至是线上看好后，直接拖着箱子再去看房的，这绝对是大忌！</p><p>当然这也不是不行，比如嫌麻烦与不缺钱，就可以无脑 all in 自如（公寓相关的分析接下来章节会说），至少能保证下限。</p><p>但如果你想选民宅的话，纯线上的最大挑战，是要有足够的鉴别能力。比如某中介在朋友圈发了某套房的房源信息，一般是位置加文字加图片，你需要第一时间能够识别出信息的真实度如何，另外，同步查询这个小区的相关信息：小区建成于什么年代、附近的设施情况如何等等。</p><p>而在你未曾亲自线下跑楼之前，你其实对这些都没什么太大概念，比如什么是筒子楼、什么叫隔断、什么是团结户等等。</p><p>不过一旦你对这些概念逐步熟悉之后，看房，尤其是看中介与平台的线上房源，心中就会相对有数了，也就是说，至少不太容易出现预期差太多的情况了。</p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="线上转线下方案">线上转线下方案<a class="hash-link" href="#线上转线下方案" title="标题的直接链接">​</a></h4><p>相对来说，先在线上看够足够多的房源，再精挑几个去线下调研，应该是最好的。</p><p>这里，有两点，第一点就是尽量以正常通勤工具去看房，你不能因为远或者啥的去打车看房，毕竟你是来租房通勤用的，你必须还原你的真实使用场景去体会这是不是你想要的，所以从我的感受来看，离地铁超过 1 公里的房我就不会要了，走路实在需要太久。</p><p>第二点，就是怎么说呢，并不需要刻意排斥中介。</p><p>是，中介这个职业，总让人爱恨交加，尤其是碰到就为了多坑点你钱的，我也碰到过，并且不少。但别人也确实给你提供了一定帮助，或者说，insight。</p><p>你得明白整个租房市场是怎么回事，在一线城市，绝大多数租房都是相对饱和的，好的、性价比高的房子确实很抢手，比如在国贸上班的金融白领们租房一般就是围绕这一块，相应的就会有中介专门负责这几块小区的生意，一旦有一个房间空出来就会立马挂出来，然后数个中介就能找到数个客户对该房源感兴趣。</p><p>如果你排斥中介，拒绝接受中介，你怎么能获得这些房源信息？并不是所有人都会在豆瓣、咸鱼发帖转租什么的，所以中介仍旧是找房的一个重要途径，关键是看你怎么用。</p><p>我的看法是，不要只 follow 一个中介，你可以多加几个中介，综合他们的 insight，最终逐渐形成你的租房目标。但所谓的多加，也不是随便加，一定是你目标区域内的中介才是有效的，因此如何加到你目标区域内尽可能多的中介，依旧需要我们后续所用到的技术。</p><p>再总结一下，不需要排斥中介，但也不要随意加中介，如果碰到目标区域内的中介，不妨加了多和他们聊聊，可以更快地帮你熟悉目标区域。最重要的是，不要拖着箱子，然后坦诚地、大方地线下去走走，实地看看。说不定想去看的某套是不符合期望的，但其他套却很吸引你，这也是可能的。</p><p>当然，中介有风险，后面也会讲一些中介的平常套路。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="线上平台选择">线上平台选择<a class="hash-link" href="#线上平台选择" title="标题的直接链接">​</a></h3><p>现在其实有很多租房的平台，比如微信、豆瓣小组、咸鱼、小红书、贝壳找房、链家、58、安居客、自如、泊寓等等。</p><p>其中，个人房源主要集中在微信、豆瓣小组、咸鱼、58 等平台上，贝壳找房我试了试房源基本对接的自如的。这其中，58 和安居客据说假房源特别多，所以也未在我选择之列。咸鱼和小红书是我后来才知道的，但不在本次找房所使用工具之类。</p><p>本次找房主要使用的是微信和豆瓣小组，其实主要是豆瓣小组，微信的租房群也是通过豆瓣才找到的。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="总体设计">总体设计<a class="hash-link" href="#总体设计" title="标题的直接链接">​</a></h3><div class="language-mermaid codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-mermaid codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">flowchart TB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subgraph day1[Day 1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">direction TB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subgraph platforms[租房平台]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        douban[豆瓣小组-北京租房]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        --&gt; wechat[微信群聊-北京租房]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    douban</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- 爬虫 --&gt; input[2w+近期租房条目数据]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wechat -- 表格 --&gt; input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input -- 清洗 --&gt; washed[100+符合基本条件的租房条目数据]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- 一一标记确认 --&gt; marked[10+候选租房目标]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subgraph day2[Day 2-3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    marked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- 微信逐个联系 --&gt; connected[&lt;10个线下考察目标]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- 线下考察 --&gt; favorite[1-3个最终候选]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- 抉择 --&gt; final[1个最终目标]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_rB0w" id="租房前期准备">租房前期准备<a class="hash-link" href="#租房前期准备" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="了解行政区域规划">了解行政区域规划<a class="hash-link" href="#了解行政区域规划" title="标题的直接链接">​</a></h3><p>访问 <a href="https://www.zhihu.com/question/26731387" target="_blank" rel="noopener noreferrer">有没有一种电子地图，可显示详细的行政区域边界 ？ - 知乎</a> 可以很方便地查看行政区域规划地图，例如北京的：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646042680293-b001d7afd4943a6e57041a22a615e5db3bba163a70866a5c2b8e22154ce68c91.png" alt="picture 1" class="img_vXGZ"></p><p>我也是第一次看行政区域地图，一一审查他们的区号发现还挺有规律，核心第一圈东西城区 01 和 02，接着第二圈从朝阳开始顺时针——朝阳（05）、丰台（06）、石景山（07）、海淀（08），接着第三圈从房山开始逆时针——房山（11）、通州（12）、顺义（13）、昌平（14），最后第四圈有点杂乱但整体依旧是逆时针：大兴（15）、怀柔（16）、平谷（17）、密云（18）、延庆（19）。</p><p>了解行政区划的目的，主要是分清自己大概会租什么位置的房子，因为现在大多数租房软件都会提供基于行政区划与地铁等多种筛选方式，也许地铁比行政区域更重要一些，但提前了解一下行政区域也会有一个比较重要的区位概念。</p><p>至少，我了解下来，断定，我大概会在朝阳与丰台这两个区之间做选择，这是比较重要的信息。也就是说，后续看到转租帖，不是这两个区的基本都可以 pass 了。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="了解地铁线路规划">了解地铁线路规划<a class="hash-link" href="#了解地铁线路规划" title="标题的直接链接">​</a></h3><p>从我的角度，行政区域对自己的实际参考意义并不大，作为北漂狗，最重要的依据还是地铁，谁能把握住地铁的脉络，谁就能把握住性价比的尾巴。</p><p>所以首先找一张地铁线路图，这个随便一搜就能找到，比如这是百度地图里的北京地铁图：<a href="https://map.baidu.com/@12964228,4821466,13z" target="_blank" rel="noopener noreferrer">北京市地铁图 - 百度地图</a></p><p>由于公司在四惠南边，所以我从四惠站出发，沿各个方向延伸七站左右，其中遇到换乘加算一站。（七站大概是半小时）</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646439758370-c9709e7459acccd134efbdcd75ae097f557ce607223c072ea906e13f7d56c31c.png" alt="picture 1" class="img_vXGZ"></p><p>如此来看，其实我的可选范围还是挺多的，整个北京东南方向的一大块都包括了。</p><p>但为了控制成本，我特意标记了地铁外环的几个拐角，直觉上这里价格会略低些：</p><ol><li>百子湾，位于 7 号线拐角，同时也是离公司最近的侯选处，可以步行上班</li><li>北工大西门，位于 14 号线拐角，这里的最大优势是可以直达望京</li><li>分钟寺与成寿寺，位于 10 号线上，这两个地方是某北漂朋友推荐的地儿，确实便宜</li><li>青年路，6 号线，正好在环外，旁边就是朝阳公园</li><li>通州北苑，低处通州区，价格更低，旁边还有万达广场</li></ol><p>这几个锚定的区域都需要重点观察。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="了解周遭小区分布">了解周遭小区分布<a class="hash-link" href="#了解周遭小区分布" title="标题的直接链接">​</a></h3><p>我们可以在 <a href="https://map.lianjia.com/map/110000/ESF" target="_blank" rel="noopener noreferrer">北京地图找房<em>北京小区地图</em>北京房产地图(北京链家)</a> 简单看到大部分小区的分布情况，例如定位到我司附近的百子湾小区：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646616950694-d0638ca5546f123f967191de4f05b4dc2150e859c4a739c13f751e8bc4c05ec5.png" alt="picture 2" class="img_vXGZ"></p><p>再点击一次可以看到具体到每个小区的情况，下面部分有一大块的空白看样子是商区（不确定）。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646616997536-91182e25417bd9bb8aedf65b1a78970868219ee4c5d7b84c93ed4469bbbaabb6.png" alt="picture 3" class="img_vXGZ"></p><p>由于我司位于源创空间大厦，离周围的地铁都比较远，步行距离接近 2 公里（通勤时间可以以步行的 10 分钟/公里计算），因此光是从最近的地铁站步行到公司都要花 20 分钟，所以在租房时要考虑这个问题。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646620679319-1651e3b2677652a26cd35557358018cb66cf2487a19d110410f4f89fb0ba5b3c.png" alt="picture 5" class="img_vXGZ"></p><p>具体地说，如果我的通勤时间要控制在半小时以内，那么大概率远距离的长地铁方案就要 GG 了。（长地铁方案：选择离公司较远、离地铁较近、具有较高性价比租房的方案）比如以我司以及周围的三/四个地铁站为中心，附近有数个小区（高德地图，链家看起来太费劲了，且不全）：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646623707128-38cbad4291bfbf319eb81efa360e5cfb2d716cb4d1fd4bd8187a44dab56d3a12.png" alt="picture 6" class="img_vXGZ"></p><p>这些小区中，最优先考虑的应该是在四惠东、四惠、大郊亭、百子湾（逆时针）这几个地铁站之间的小区：金海国际、金都杭城、沿海赛洛城和百子湾家园。其中金海国际可能地铁位置最优（仅次于九龙山附近的珠江帝景）但最贵（二手房价格 6w+），沿海赛洛城性价比最高（离地铁次近，二手房价格 4w+），金都杭城与百子湾家园离地铁更远。</p><p>其次就是四惠河北部的惠民园、东恒时代、十里堡等。</p><p>最后是其他地区，例如大郊亭左边的后现代城、百子湾下面的光华新城、百子湾右边的燕宝保湾家园、四惠东右下角的西店村等。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="小区的选择依据">小区的选择依据<a class="hash-link" href="#小区的选择依据" title="标题的直接链接">​</a></h3><p>个人认为，无论预算是否充沛，最终是否直接选择离公司最近的小区，适当地过一遍周遭小区还是比较重要的，因为你选择这里的概率会比较大。</p><p>但并非必须选项，因为我们往往会考虑地铁沿线更远的区域，尤其是在我们把通勤时间放宽到一小时、公司本身离地铁也很近、最后一公里选择骑车而非步行等前提下。</p><p>但这样，我们就需要看<a href="#%E4%BA%86%E8%A7%A3%E5%9C%B0%E9%93%81%E7%BA%BF%E8%B7%AF%E8%A7%84%E5%88%92">了解地铁线路规划</a>中所圈点的更多地铁站旁边的更多小区，工作量指数级上升。</p><p>因此，关于其他小区的通勤距离这部分，我倾向于通过程序计算，找到后再单独看~</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="豆瓣小组租房条目的数据获取">豆瓣小组租房条目的数据获取<a class="hash-link" href="#豆瓣小组租房条目的数据获取" title="标题的直接链接">​</a></h2><p>基于我们在<a href="#%E5%B9%B3%E5%8F%B0%E9%80%89%E6%8B%A9">平台选择</a>中的分析，豆瓣小组是本文的重点考察对象（后续可能会考虑再加入闲鱼，据说个人房源信息也不错）。</p><p>另外，至少有两种获取豆瓣小组租房信息的方式，一种是基于网络流传的 API，一种是基于我们自己的爬虫。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="豆瓣小组租房信息获取的目标设计">豆瓣小组租房信息获取的目标设计<a class="hash-link" href="#豆瓣小组租房信息获取的目标设计" title="标题的直接链接">​</a></h3><ol><li>支持搜索小组名以获得所有相关的小组<ol><li>例如：“北京租房”</li><li>豆瓣支持小组名字相同，所以其实会有很多个同名小组</li><li>为了信息的完整性，我们最好捕捉所有符合要求的小组，然后一一进行处理</li></ol></li><li>支持基于小组名（实际是 id）获得该小组下的所有话题</li><li>基于话题的标题，进行地名提取与位置确认，进行转租筛选</li><li>支持基于话题再获得话题下的图片与文字<ol><li>如果有了图片，是很方便可以做一些可视化网站的，势必会比较方便</li><li>另外也可以做筛选，你说对方要把房子租出去，结果图都不晒一张，这合适吗，这不合适，这能要吗，这肯定不能要</li><li>尽管势必会有大量照骗党，杀猪磨盘，但是也不能因为这个而畏惧呢</li></ol></li><li>其他</li></ol><h3 class="anchor anchorWithStickyNavbar_rB0w" id="豆瓣小组-api-方案之分析与准备">豆瓣小组 API 方案之分析与准备<a class="hash-link" href="#豆瓣小组-api-方案之分析与准备" title="标题的直接链接">​</a></h3><p>之前就听说国内电影体系都是靠豆瓣的 api，因此首先就是先谷歌一下“豆瓣 api”，结果发现果然有 <a href="https://www.doubanapi.com/" target="_blank" rel="noopener noreferrer">豆瓣 Api V2（测试版） | doubanapi</a>，注意这两个 api_key，我一开始表示怀疑，后来发现竟然真能用……</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">0df993c66c0c636e29ecbb5344252a4a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0b2bdeda43b5688921839c8ecb20399b</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646069015501-f3babe3e1f58f4114ac50bf658a3da52d79e200b28b72ced5c3076d1fe45edd5.png" alt="picture 6" class="img_vXGZ"></p><p>但这个网页其实没有提供豆瓣小组的 api，于是我们继续搜索豆瓣小组是否有 api 的信息 <a href="https://www.zhihu.com/question/19889922" target="_blank" rel="noopener noreferrer">豆瓣小组是否提供 API？ - 知乎</a>：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646069095482-cd7bde3bddd77cf5f4c62e6e81840d8fb51af0ffafb4d482264517946f766c0d.png" alt="picture 8" class="img_vXGZ"></p><p>有几个有趣的回答，第一个给出了 api 地址与形式，并且附送了一个链接：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646069147214-a4f1aa82861ed7aaecfc5ab9288b7fecb49b93b375fc6f684769dd5983c4b856.png" alt="picture 9" class="img_vXGZ"></p><p>不过这个所谓的”出处“链接到很有意思，是 2012 年的，最关键的是，打开后一闪而过，倒也没那么快，大概一秒钟之后跳转到了新的页面，看最后一个网址就知道，是被重定位了。</p><p>刚刚是手快，截了一下，但是光截图看不到后面的内容，而想中途拉动又不可能。</p><p>这个时候，抓包神器的作用就体现了，所有网页加载都有记录，直接把 html 文件导出，再在本地打开，就发现全出来了：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646069414627-ac205b0b2a3e63c2d70881af9db7713beaf7a6acbc183a13ff3bfc6e73b575d3.png" alt="picture 13" class="img_vXGZ"></p><p>最有意思的是，这个帖子似乎是有两个“小黑客”在尝试破译豆瓣的接口，好吧，也就是我正在做的事了。</p><p>读下来饶有味道：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646069515981-f924e7f446421c41878794949b567c207dab0d410a2e8f57dc20317bc26ca0e0.png" alt="picture 14" class="img_vXGZ"></p><p>不过他们所描述的获取 access_token 的形式，我也不清楚豆瓣是怎么想的，可能他们同时有两套接口吧，一套 oauth2，一套 api_key。总之，我们目前应该是不需要 access_token 的，直接用 api_key 就可以，并且是固定的。</p><p>比如按照上面的截图，获取豆瓣小组里话题列表的 api 是<code>https://api.douban.com/v2/group/${GROUP_NAME}/topics</code>，例如：<code>https://api.douban.com/v2/group/husttgeek/topics</code>，这个时候如果我们在浏览器中直接打开这个网址，会遇到缺少 api_key 的警告：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646069782706-7895041f12fbe4b18f9ee659be5f9a4fe6ae923807f0c070d73c32550a3abf33.png" alt="picture 15" class="img_vXGZ"></p><p>这不，我们一开始搜的豆瓣 api 就有用了吗，把那个 api，比如<code>0df993c66c0c636e29ecbb5344252a4a</code>复制过来，拼接到网址上去，重新访问，结果就有了：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646069859534-e798528b3ca706fde7d6b4c1e0736d259c35d77969cd40a7810b6bdee936a845.png" alt="picture 16" class="img_vXGZ"></p><p>得来全不费工夫！</p><p>至此，其实我们的思路已经大致确定了，不过那个知乎帖子下面还有两个 git 项目，其中一个是监控小组的，倒是确有一点意义，可供闲暇参考，分别罗列如下：</p><ul><li><a href="https://github.com/yaodi833/rental_house_douban" target="_blank" rel="noopener noreferrer">yaodi833/rental_house_douban: 本项目基于（非公开）豆瓣 api，实时监控多个豆瓣租房小组发布租房信息，并支持小组订制，关键词订制，邮件推送等功能</a></li><li><a href="https://gist.github.com/iamsk/1bc0760dfeeeb950f18e" target="_blank" rel="noopener noreferrer">doubangroupapi</a></li></ul><p>基于以上分析，可见，豆瓣的 api 还是比较稳定可用的，否则该失效早失效了。</p><p>不过有些东西还差一点。其中，我们目前只知道第二点（罗列话题）与第四点（获取话题内容）应该是有了现成的 api，而第一点（搜索小组）则没有，需要我们自己破解。另外第三点是我们后续的算法部分，与豆瓣 api 无关，故暂且可以先不谈。</p><blockquote><p>豆瓣小组 API 方案之如何获取搜索小组的 API</p></blockquote><p>按照直觉，我们可以通过对比正常访问的网页地址与已经明确了的 api 之间的关系，得到 $f(x) = y$，然后再把这个 $f$ 作用到正常搜索网页的网址上去。</p><p>我们先试试。</p><p>但是很快我发现搜索接口是比较独立的，是一个集中式的接口，和那些分别对应的不太一样。</p><p>紧接着我又意识到，其实这么多小组，取前几个就已经比较够了。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646074421380-f0780837200fe37fca1e9afb372a7bca1320e805c7dd6730ccd6eed4add691a0.png" alt="picture 17" class="img_vXGZ"></p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">function getGroups() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl https://www.douban.com/search\?q\=$1 2&gt; /dev/null \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | grep -E &quot;小组.*&lt;a href&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | gsed -E &quot;s/.*group%2F(.*?)%2F.*/\1/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这样我们就得到了豆瓣小组的前几个小组的 id，例如：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646074500899-e2a15145ced09f9749a69989d26e2156bf8958d2d5f78adbdd550f752fd5cc08.png" alt="picture 18" class="img_vXGZ"></p><p>这样，我们的第一步就也痛了，于是乎，第一步获取小组 id 列表，第二步获取小组内的主题，第四步获取小组主题内容，这几步都没有技术上的问题了，接下来就是写程序，以及加上第三步算法部分。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="豆瓣小组-api-方案之设计与实现">豆瓣小组 API 方案之设计与实现<a class="hash-link" href="#豆瓣小组-api-方案之设计与实现" title="标题的直接链接">​</a></h3><p>可以直接访问 <code>https://api.douban.com/v2/group/beijingzufang/topics?apikey=0df993c66c0c636e29ecbb5344252a4a</code> 获取 demo 结果：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646644258095-3634cb35cb1b70e95cb77450a2e48ea9636d06dbcf5789fdb02cdbe5c19567fc.png" alt="picture 2" class="img_vXGZ"></p><p>基于这个返回结果，可设计数据结构如下：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Author</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    is_suicide</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avatar</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uid</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># UserType</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    large_avatar</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Dimension</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    width</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Photo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    size</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Dimension</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    topic_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    seq_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    author_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    creation_date</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># datetime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">DoubanApiTopic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    is_private</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    locked</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    liked</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    like_count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    comment_count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    created</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># datetime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    updated</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># datetime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    share_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    screenshot_title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    screenshot_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    screenshot_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    author</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Author</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    photos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Photo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">DoubanApiTopicResultSuccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    请求成功时的结构体</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 0 - 100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default: 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    total</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    topics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DoubanApiTopic</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">DoubanApiTopicResultFailure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    当请求失败时，就会返回这个结构体</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    msg</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># &quot;access_error&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 403</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    localized_message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>有了 apikey 可以直接调用 api，获取 json 结果，然后解析，因此本过程省略，以下主要记录一下核心续爬代码：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">start </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_get_topics_of_group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> limit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;code&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">403</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        finished_reason </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;此请求已触及该apikey&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">_apikey</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&gt;限制&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;topics&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"> DoubanApiTopic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">**</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;start&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;count&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;total&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        finished_reason </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;不容易，所有数据已全部提取完毕&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;finished, reason: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> finished_reason</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_rB0w" id="豆瓣小组爬虫方案之设计与实现">豆瓣小组爬虫方案之设计与实现<a class="hash-link" href="#豆瓣小组爬虫方案之设计与实现" title="标题的直接链接">​</a></h3><p>豆瓣的前端页面并不复杂，就是一个传统的 table 结构，按序解析即可。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646637351707-b2675d6892f4102387b6588f435516597ca8711072a5e22543218683452c6c05.png" alt="picture 1" class="img_vXGZ"></p><p>豆瓣小组的特定小组内条目的字段主要有：<code>讨论 | 作者 | 回应 | 最后回应</code>四个基本字段，相应的在程序设计中我编码成了六个字段：<code>post_title | post_url | author_name | author_url | response_count | response_latest_time</code>。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646635247259-62e1f827aaf997bd418f03538e9fe955b1fd5f371ab15ccbe1e47eeb05999b8e.png" alt="picture 7" class="img_vXGZ"></p><p>有一个问题，是关于多个小组的，由于豆瓣小组针对某一话题会有多个不同的小组，甚至名字相同（但 id 唯一），这就导致需要我们对每个小组分别进行数据提取。有一种办法可以避免这样，那就是集中采集 <a href="https://www.douban.com/group/" target="_blank" rel="noopener noreferrer">我的小组讨论</a>页面。</p><p>比如，我所有的小组都是关于租房的，一共有三个小组：<code>北京租房 | 北京无中介租房 | 北京租房房东联盟（中介勿扰）</code>，因此这个页面就是这些小组里所有最新的帖子情况。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646635533016-b6ae0771f901dd12faed61e6d68875d1deb95c60645d5ccc84f7dda033394837.png" alt="picture 8" class="img_vXGZ"></p><p>但这种办法的缺点有二，一个是你要主动过滤非租房相关的小组，另一个就是不支持提供发帖者相关的信息，这在筛选上，缺失了一个比较有用的维度（不过其实我并没有使用这个维度）。</p><p>于是，基于特定小组的话题列表的字段设计如下：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Topic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response_latest_time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    post_title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    post_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    author_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    author_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response_count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TopicColumns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;response_latest_time&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;post_title&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;post_url&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;author_name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;author_url&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;response_count&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>直接使用 python 的爬虫基操（<code>requests + beautifulsoup4</code>）即可，核心解析代码如下：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">rows </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> soup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;#content .article tr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> row </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    post_title </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;td:nth-of-type(1) a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    post_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;td:nth-of-type(1) a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;href&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    author_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;td:nth-of-type(2) a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;href&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    author_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;td:nth-of-type(2) a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response_count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;td:nth-of-type(3)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    datetime_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;td:nth-of-type(4)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">match</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;20&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> datetime_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># test if it&#x27;s year of 20XX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        datetime_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">datetime</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">now</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">year</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">-</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">datetime_str</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response_latest_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strptime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">datetime_str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%Y-%m-%d %H:%M&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"> Topic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">post_title</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">post_title</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> post_url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">post_url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> author_url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">author_url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                author_name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">author_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response_count</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">response_count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                response_latest_time</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">response_latest_time</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_rB0w" id="豆瓣小组租房条目的数据分析">豆瓣小组租房条目的数据分析<a class="hash-link" href="#豆瓣小组租房条目的数据分析" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="筛选条件分析">筛选条件分析<a class="hash-link" href="#筛选条件分析" title="标题的直接链接">​</a></h3><p>在获取到豆瓣租房的目标条目之后，第一步要做的就是程序化筛选。</p><p>目前使用的可供筛选的组合条件如下：</p><ul><li>（推荐）发布日期在近十日之内（好房子一般都会较快被租出，因此过长还未租出的房子不值得一看，N 目前可设置为 7 或者 10，是一个比较合理的值）</li><li>（推荐）如果是男生求租，标题中带“女生”、“限女”等字样的一般不予考虑，并且此类房间不在少数</li><li>（参考）基于一些简单规则提取标题中的价格信息，例如“3000”或者“3 千”等，如果匹配上，便使用预设的价格区间进行筛选</li><li>（参考）对评论数进行筛选，评论数一定程度上代表着房源的质量，或发帖者的积极性（有些发帖者会自己给自己顶帖，说明不是中介），因此筛选评论数大于 0 是非常有意义的，但需要谨慎，因为有很多帖子评论数为 0 但房源确实是有效的</li><li>（参考）继续下爬发帖者的个人信息，鉴定其豆瓣的活跃度，以筛选出非中介的发帖者，但这个就涉及到二级页面的爬取，是一个比较大的开销，需要平衡是否有必要</li><li>（参考）由于帖子的标题比较个性化，小区名、地铁线路信息、行政区域信息等的曝光度均不同，因此基于正向筛选有可能会误杀一些帖子（例如以标题中存在朝阳二字筛选帖子，就有可能把只写了朝阳内部小区名字的帖子给误过滤掉），与此相比反向筛选比较有效（例如如果标题中出现了大兴二字，一般就肯定不是朝阳区域的房源）</li><li>（推荐）本项目最有意思的一点是做了智能测距筛选，具体做法就是将豆瓣标题信息喂给高德的区位编码 api 得到经纬度，再结合目标公司经纬度使用高德的线路规划 api 算出通勤时间，然后再进行筛选，该解决方案应该是目前网络上独一份，实际使用下来，也许有误杀，但很有效。</li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="高德-api-之申请-key-配置">高德 API 之申请 Key 配置<a class="hash-link" href="#高德-api-之申请-key-配置" title="标题的直接链接">​</a></h3><p>访问 <code>https://console.amap.com/dev/user/permission/authenticate/person</code> 基于支付宝实名认证申请 key：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646230621370-8e2266b9ff7e8ae36a3ea31057a1e1ced330b6dec2dd177fc03103ef979b4c41.png" alt="picture 1" class="img_vXGZ"></p><p>很快，认证成功：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646230728166-e6eac393225fbb258d38f3bd15ec765cdc5c21d207d055e3e4b4be8af345347e.png" alt="picture 2" class="img_vXGZ"></p><p>创建一个 key:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646236116312-8c6441396a6cf4bbbb00be0cb9a0bc1b1a6404dd3bea04ea196ccef0ded3888f.png" alt="picture 4" class="img_vXGZ"></p><p>获得 key：<code>33e2719dbfXXXXXXXX1b2e6786052</code></p><p>最后再看一下服务配额：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_douban-group-api-1646230812661-489a0477c092e063fb341624a4dcdd16a23746e3b9d336e1bc81564ae095e8db.png" alt="picture 3" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="高德-api-调用之地理编码与逆地理编码">高德 API 调用之地理编码与逆地理编码<a class="hash-link" href="#高德-api-调用之地理编码与逆地理编码" title="标题的直接链接">​</a></h3><p>参考 <a href="https://lbs.amap.com/api/webservice/guide/api/georegeo#geo" target="_blank" rel="noopener noreferrer">地理/逆地理编码-API 文档-开发指南-Web 服务 API | 高德地图 API</a> 可以知道，高德地理编码就是将地址文本转成经纬度。而后续的比如说查询两个点之间的通勤距离都是基于经纬度的，因此地理编码 api 非常重要。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646663384858-3009c4fcd2cc161deb9d658141155664cf851d0516e307136276acf599deb7b0.png" alt="picture 3" class="img_vXGZ"></p><p>重点参数是 <code>address</code>，即输入的地址。尽管 api 介绍说是一个结构化地址信息，但实际经过我的测试，一个非结构化的但包含地址的句子也是可以的，高德比较智能，会提取出它认为最有可能的地址，这个非常有用！因为允许我们将豆瓣帖子标题直接喂进地理编码而不需要预先提取出地理信息，这让我原先设想的基于 jieba 分词并多次调用高德 api 进行测试的复杂、低效、高耗方案变得不再需要！</p><p>第二个重要参数是<code>city</code>，我们只需要指定为<code>北京</code>，这样便免去了全国搜索，速度更快准确度更高。</p><p>第三个重要参数是<code>batch</code>，这个允许我们在一次 api 调用里同时返回多个关键字的搜索结果，这或许可以大幅降低我们的 api 开销，因为高德 api 有额度限制（但我不确定最终计算时，是以单词算，还是 N 次算，我暂时没用）</p><hr><p>同样，参考 <a href="https://lbs.amap.com/api/webservice/guide/api/georegeo#regeo" target="_blank" rel="noopener noreferrer">地理/逆地理编码-API 文档-开发指南-Web 服务 API | 高德地图 API</a> 我们可以知道逆地理编码就是从经纬度得到结构化地址。</p><p>但值得注意的是，地理编码与逆地理编码之间的输入输出并不完全互逆，因为输入的地理信息也许是非标准化的地址，但输出的逆地理编码信息一定是高德内部标准化的。</p><p>这个 api，可以用，也可以不用。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="高德-api-调用之公线路规划与步行规划">高德 API 调用之公线路规划与步行规划<a class="hash-link" href="#高德-api-调用之公线路规划与步行规划" title="标题的直接链接">​</a></h3><p>在同城通勤线路规划中，我们主要用公交地铁线路规划（长距离），或者步行规划（短距离）。</p><p>参考 <a href="https://lbs.amap.com/api/webservice/guide/api/direction#bus" target="_blank" rel="noopener noreferrer">路径规划-API 文档-开发指南-Web 服务 API|高德地图 API</a> 可以知道公交路径规划的实际含义是<code>transit/integrated</code>，也就是综合了各类公共（火车、公交、地铁）交通方式的通勤方案。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646664403794-18935acd99bfc9137a34d5e208c8f25f12d681b528371e7a58e4b01164ca63f0.png" alt="picture 4" class="img_vXGZ"></p><p>因此，这个 api 就是我们在手机高德地图里最常用的导航方案之一，基于公交、地铁、步行的灵活规划。其中<code>origin</code>和<code>destination</code>是出发地和目的地的经纬度，这个可以通过我们之前说的地理编码 api 获得，city 依旧和之前的 city 保持一致即可（比如：北京）。值得注意的是<code>strategy</code>参数，我个人倾向于使用<code>3：最少步行模式</code>，也许也会有人倾向于使用<code>1：最经济模式</code> 或者 <code>0：最快捷模式</code>，这个因人而异。</p><p>而我们最关心的输出则是里面的<code>duration</code>字段，它是我们通勤方案所需要的秒数，我们将基于这个进行地点筛选。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646666336508-39ff1c9464c7afd16b7973b6c4cbc8ae6f2e6fc9a1d63ffa62a2eb2e37a23b2a.png" alt="picture 5" class="img_vXGZ"></p><hr><p>但仅通过公交线路规划是不够的，因为如果出发地和目的地距离很近（例如不超过一站），则会没有结果，此时就需要使用步行规划接口。</p><p>参考 <a href="https://lbs.amap.com/api/webservice/guide/api/direction#walk" target="_blank" rel="noopener noreferrer">路径规划-API 文档-开发指南-Web 服务 API|高德地图 API</a> ，我们只需要输入起始地和目的地的经纬度即可。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646666508845-8a7fae2f2f3c84f2da90243b3897cc1a7a43042a02a7176ad315776659a725c0.png" alt="picture 6" class="img_vXGZ"></p><p>结果里依旧只需要提取<code>duration</code>字段，单位还是秒。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646666555658-15a4764c18044c987c8b7e3b1fcefef6caee19597b5cf68516de5a8034b36a8f.png" alt="picture 7" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="高德-api-封装设计与实现">高德 API 封装设计与实现<a class="hash-link" href="#高德-api-封装设计与实现" title="标题的直接链接">​</a></h3><p>理清我们需要的输入与输出。</p><p>我们通过豆瓣的 API 或者爬虫可以获得 N 条租房帖条目，其中包括标题，但是不包括具体地址，我们需要通过标题知道这个帖子是否符合自己的通勤目标。</p><ol><li>将标题直接喂入高德地理编码 api，得到经纬度 A1</li><li>将经纬度 A1 与提前算好的目的地（公司）的经纬度 A2 同时喂进公交路径规划<ol><li>如果公交路径规划有结果，则选取第一条；否则再将 A1、A2 喂进步行路径规划</li><li>如果步行路径规划有结果，则选第一条；否则报错、丢弃（推荐）或者人工审查</li></ol></li><li>基于算好的通勤时间进行筛选，例如控制在 30 分钟以内或者 60 分钟以内，因人而异</li></ol><p>由于每个高德 api 都需要 key，因此可以使用<code>requests.Session</code>直接预先设置好固定的 key 参数。</p><p>设计如下：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;XXXXXXXXXXX&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CITY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;北京&quot;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 地理编码更快</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">STRATEGY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 步行距离最短方案</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 配置全局字典，减少高德调用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ADDR_NAME2LOC_DICT </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 地理编码全局字典</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DURATION_DICT </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># 计算两个经纬度之间的距离，统一用&quot;-&quot;拼接成字符串，方便序列化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 初始化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;key&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 调用地理编码api</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_addr_loc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">addr_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    使用全局字典减少高德api调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> addr_name </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> ADDR_NAME2LOC_DICT</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://restapi.amap.com/v3/geocode/geo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;city&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;address&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;count&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 不报错，但是赋值为空</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ADDR_NAME2LOC_DICT</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">addr_name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ADDR_NAME2LOC_DICT</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">addr_name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;geocodes&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;location&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ADDR_NAME2LOC_DICT</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">addr_name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 调用步行路径规划api</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_get_walking_duration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://restapi.amap.com/v3/direction/walking&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   params</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       </span><span class="token string" style="color:#e3116c">&quot;origin&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       </span><span class="token string" style="color:#e3116c">&quot;destination&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;count&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 用一个不可能的值表示没有找到任何规划</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;route&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;paths&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;duration&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># minutes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 调用公交路径规划api</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_get_transit_duration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://restapi.amap.com/v3/direction/walking&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        params</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;origin&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;destination&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;strategy&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 0：最快捷模式, 1：最经济模式, 2：最少换乘模式, 3：最少步行模式, 5：不乘地铁模式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;city&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;count&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 如果没有公交路径，就使用步行路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> _get_walking_duration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;route&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;transits&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;duration&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># minutes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_duration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    使用全局字典减少高德api调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">from_loc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">-</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">to_loc</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> key </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> DURATION_DICT</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DURATION_DICT</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _get_transit_duration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> DURATION_DICT</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    测试demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from_addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;天坛公园&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    to_addr   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;天安门广场&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from_loc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_addr_loc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">from_addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    to_loc   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_addr_loc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">to_addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    duration </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_duration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;from_addr&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> from_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;from_loc&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> from_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;to_addr&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> to_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;to_loc&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> to_loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;duration&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> duration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_rB0w" id="基于-pandas-进行筛选">基于 pandas 进行筛选<a class="hash-link" href="#基于-pandas-进行筛选" title="标题的直接链接">​</a></h3><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> gaode </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_coords_from_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> get_transit_duration_between_coords</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    get_addr_name_from_coords</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TARGET_ADDRESS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token builtin">globals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> dump_dict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DATA_FROM_DOUBAN_DIR </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;data_from_douban&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FILENAME </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2022-03-02-zhufang.csv&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filepath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DATA_FROM_DOUBAN_DIR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FILENAME</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;reading file from: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> filepath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filepath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># convert response_latest_time format into datetime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">response_latest_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_datetime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">response_latest_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># filter datetime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&#x27;2022-02-25&#x27; &lt; response_latest_time&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># filter personal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post_title</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;女生&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> s </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;个人&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> s </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;直租&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> s </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;转租&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;shape: &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get coords from title</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;getting coords from title&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;addr_coords&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post_title</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">get_coords_from_addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dump_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get addr from coords</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;getting addr name from coords&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;addr_name&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;addr_coords&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">get_addr_name_from_coords</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dump_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get duration between coords</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;getting distance from coords&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;transit_minutes&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;addr_coords&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> get_transit_duration_between_coords</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> get_coords_from_addr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TARGET_ADDRESS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dump_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># filter duration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;filter duration&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;transit_minutes &lt; 60&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># sort</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;sort&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">by</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;transit_minutes&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ascending</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;dump&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filepath</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;.csv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;_filter.csv&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;utf-8&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>结果如下，注意右边的三列<code>addr_coords | addr_name | transit_minutes</code>，就是我们基于程序计算出来的通勤相关数据：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646678956572-83aed2a3ecc8f6bb14055492003109ec2080830b354fabf54d76a91ba877bd00.png" alt="picture 8" class="img_vXGZ"></p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="人工筛选环节">人工筛选环节<a class="hash-link" href="#人工筛选环节" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="表格迭代标注法">表格迭代标注法<a class="hash-link" href="#表格迭代标注法" title="标题的直接链接">​</a></h3><p>我个人初步的预算其实是 2000-3000、通勤在一小时内、最好能有个独卫，后续证明这在大北京确实是一个相当困难的目标。</p><p>所以后续为了能有合适的标的，把预算上升到了 4000。</p><p>在经过我的程序化简单筛选后（基于明显不符合自己要求的标题、日期，以及基于标题与高德求解的路径耗时），两张 1w+的表格均被晒成了不足 100 个。</p><p>紧接着，我将逐一打开这些链接，进一步确定是否尝试联系或者直接 pass，并进行标记：<code>-</code>表示 pass，<code>+</code>表示有意愿。</p><p>例如，这是“北京租房”小组的表格经过手动标注后按照 choice 列降序的结果：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646726767185-88d0b9e7e4790687cbbf2f2a6a9368728ca195d7369b6c77b449d73a57f6ff64.png" alt="picture 9" class="img_vXGZ"></p><p>在处理“北京无中介租房”小组时，觉得单纯的加与减的级别控制还不太够，所以又使用了<code>+ | ++ | +++</code>三种级别，加号越多表示越想要，从而排序。而这些加号前面的<code>-</code>号，则表示后续在线联系或者线下考察后决定拒绝或者放弃。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646726999168-01d44eca006d3e7ca282d70a8cb76a7d681b77b1a9b2a45b4fb97f8e5ca77276.png" alt="picture 10" class="img_vXGZ"></p><p>因此标注、再标注，这是一个循环迭代的过程，最终我们将只会有很少甚至没有符合目标期望的房源。亦或者，我们将选用最后一个被排除的房源。</p><p>这有点像相亲，硬性条件不达标我们一定会 pass，可容忍的缺点我们尝试去磨合，宁缺毋滥。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="线上联系也有一些困难">线上联系也有一些困难<a class="hash-link" href="#线上联系也有一些困难" title="标题的直接链接">​</a></h3><p>因为豆瓣其实不是一个主打即时社交的平台，很多朋友只是在这里发个帖子，然后就可能……人都找不到了， 或者好几天才回。</p><p>在我的目标候选房源中，有一个超小的单身独卫房，非常廉价，但却始终联系不上： <a href="https://www.douban.com/group/topic/261047442/?_i=62974230uaXoRO" target="_blank" rel="noopener noreferrer">6 号线青年路 次卧转租—无隔断 独立卫生间 独立阳台 6 号线青年路 次卧转租—无隔断 独立卫生间 独立阳台</a></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646727973605-f7e07f6c93ee80ae944c877722d1ce688d18242edf52e4a8597e5311c32f61d9.png" alt="picture 11" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646727993779-1a8c7a3e89a723fe1e013399fe0c42bbbd4053acefa71e1ea17238d236383448.png" alt="picture 12" class="img_vXGZ"></p><p>但也许是很快就租出去了吧？反正，豆瓣私信一直联系不上。</p><p>所以，错过了见识一下目前认知里最小的独卫房的机会。</p><p>其他的基本联系上了，但有些确实比较慢。</p><p>通过线上联系直接被 pass 的主要分三种吧，发现是中介、限女生、价格过高等。</p><p>也有一些非常热情的朋友（小姐姐居多），聊天、谈房的感觉还是很愉悦的，所以转租确实比冷冰冰的中介体验感要好很多，你更大概率能感觉到真实、安心。</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="线下跑房环节">线下跑房环节<a class="hash-link" href="#线下跑房环节" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="时间与路线规划">时间与路线规划<a class="hash-link" href="#时间与路线规划" title="标题的直接链接">​</a></h3><p>再经过一两个小时的手动筛选与一一联系之后，就基本决定了线下跑房的计划。</p><p>基于豆瓣租房的筛选，我两天内一共跑了九套房，其中第一天晚上原定五套实看四套，第二天下午原定四套实看五套。</p><p>当时还挺天真，每两套之间计划只用半小时，结果发现严重不够，最后还鸽了几个……</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646733639926-a1dc3ab4dacead50365079b9c1be3c22ea480862b978ff0d3bee9762b41ee8cb.png" alt="picture 13" class="img_vXGZ"></p><p>第二天吸取教训，把每套房控制在了一小时的间隔：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646733824670-2066610fc106663cd5f2fb5821b0a98df72743c52a53180a1451908df1b9f6c5.png" alt="picture 14" class="img_vXGZ"></p><p>以及路线方面：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646733878429-bb6209a0e6373d216a3fe35736356a6bcbcdb3254c2655273a474e34cff91ac2.png" alt="picture 15" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房110-望京附近3000">跑房（1/10）: 望京附近，3000<a class="hash-link" href="#跑房110-望京附近3000" title="标题的直接链接">​</a></h3><p>第一个房是在望京附近，因为我们甲方爸爸在那，我可能较长一段时间都在那。</p><p>当时也是第一次使用豆瓣租房找房，于是找了一所，是个小姐姐，某天晚上过去看了一下。</p><p>后续觉得还是得以公司为中心比较好，所以之后开始使用程序手段进行豆瓣小组租房信息爬取与筛选。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房2103-31陆翔佳园_3200">跑房（2/10）：3-3<em>1</em>陆翔佳园<!-- -->_<!-- -->3200<a class="hash-link" href="#跑房2103-31陆翔佳园_3200" title="标题的直接链接">​</a></h3><p>三月三号晚上整体的跑房策略，就是一路向东，第一个房是在百子湾附近，是一个中介，谈的是金海国际，初步价格是在 3200-3500。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646735935957-362e48d3bd873cdcc856122bbcbc548d0af445ff1da3523964a440eaef02ea83.png" alt="picture 16" class="img_vXGZ"></p><p>我看着房子还算不错，另外也 check 了地图，是离大郊亭地铁站（这个地铁站位置还行，比百子湾更近中心一点，左边一站就是 14 号线上的九龙山）最近的一个小区。</p><p>然而，当我到了之后，有两个中介，好像一位是另一位的上级，我跟着另一位坐上了小电驴……路上问我的价位预期和要求……</p><p>我千辛万苦筛选的豆瓣租房，还是从中介的一辆小电驴，开始出发了……</p><p>然而，我们最后还是没有去金海国际，因为如果想要金海国际的独卫，预算至少估计要 4000 起，我说我最多只愿意开到 3500，于是我们到了一个小区：陆翔佳园。</p><p>【视频：3-3<em>1</em>陆翔佳园<!-- -->_<!-- -->3200.mp4】</p><p>这个小区的开价是 3500，有独卫，空间也不小，朝南，有飘窗，听说是部委房。我特意还去看了一下其他次卧的公共洗手间，非常狭窄，说实话觉得“他们”真地很不容易。</p><p>中介一直劝说我不用看客厅走廊别人的卫生间什么的，因为我住在主卧，但走廊什么的都很挤很暗，因此觉得还是难以让我满意。</p><p>另外，还有一个把我怵到了的地方，就是独卫里竟然还有个大石墩子。中介说可能是用于坐的，房东的，搬也搬不走。我当时竟然还脑补了 maybe 是一个小浴桶……但后续却始终想不明白……</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646737156337-a1e512119b3d4cbdcb0abce22e4499e2bba278bb577d3b0e426ff036ec46d50d.png" alt="picture 17" class="img_vXGZ"></p><p>和这个令人想不明白的石墩墩同处一室的还有一个高级马桶，是所有房中最高级的，有点像外滩外企的马桶，emm，也忘记看是啥牌子了……</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房3103-32珠江绿洲_3800">跑房（3/10）：3-3<em>2</em>珠江绿洲<!-- -->_<!-- -->3800<a class="hash-link" href="#跑房3103-32珠江绿洲_3800" title="标题的直接链接">​</a></h3><p>看完第一个陆翔佳园的房子其实已经 7 点 40 多了印象中， 于是原定于 7 点半的慈云寺的房子就肯定早已经被鸽了，事实上，最后即使租完房也没去成，彻彻底底地鸽了……</p><p>因此直接奔赴预定 8 点钟传媒大学附近珠江绿洲的房源，不过看起来是一路向东， 其实并没有那么简单……饶了一个大圈呢：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646755819160-19479abe2a639272ae78addccc932d891f19bce62b217873cf1dcae7f78c0d60.png" alt="picture 18" class="img_vXGZ"></p><p>珠江绿洲这个房源让我很放心，因为是个人，并且是刚毕业的两个小姐姐，非常热情，早早地在小区门口等待我。交流下来，非常地纯粹、坦诚，而且有趣地是她们竟然也是（准）程序员，一个做前端，一个做数据分析。</p><p>珠江绿洲给我的感觉怎么说呢，房间很大，是主卧，并且有独卫，据小姐姐反馈，原先她们是住三个人的……现在是住两个，并且有两张床……显然，对于我来说，一方面有点多余，另一方面则有点奢侈了。</p><p>【视频：3-3<em>2</em>珠江绿洲<!-- -->_<!-- -->3800.mp4】</p><p>我也开始动摇对独卫的执着，房源未必没有，但独卫的主要适用对象真不是我这种单身狗……而且价格实在太贵了，有 3800……是所有我看的房源中最贵的，并且离公司更远，也离市中心更远。</p><p>不过这个小区倒是很繁华，一楼的各种店铺一应俱全，游乐场、小公园的什么的都有，说实话，很宜居。</p><p>由于两位小姐姐其实已经找到了新的合租房，并且不在这里，所以我看完后就一起下楼了，一直亲送我到天桥附近，这份真诚让我很是感动，我也是真地很想接手她们的房源以免刚毕业的她们承受不菲的违约费用。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房4103-33周井大院_2900">跑房（4/10）：3-3<em>3</em>周井大院<!-- -->_<!-- -->2900<a class="hash-link" href="#跑房4103-33周井大院_2900" title="标题的直接链接">​</a></h3><p>从珠江路景出来后，继续往东，奔赴周井大院，下了地铁后还要走大概 1.5 公里……</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646756354749-459044fa0477642f9d914944bad4ee836f95a78c9819e8aa9a423d0bb9177a56.png" alt="picture 19" class="img_vXGZ"></p><p>这个房是两室一厅一卫，内部空间还是挺大的，小屋也被布置的比较温馨，地面还铺了条毯子。租客是一位在北京工作八年多的小姐姐，做餐饮行业，不知道是原来在大兴现在要去望京还是原来在望京现在要去大兴于是想转租出去。</p><p>【视频：3-3<em>3</em>周井大院<!-- -->_<!-- -->2900.mp4】</p><p>我仔细问了小姐姐平常她的交通工具是什么，毕竟离地铁比较远，她说自己是骑小电驴到地铁的，我便恍然大悟了。</p><p>不过有一说一，对于长租的人来说，离地铁远一点，配个小电驴，确实能显著提升生活体验，拥有近乎最高的性价比。</p><p>不过这个房除了区位较偏、地铁较远、小区较老（没有电梯）外还有个问题，原先帖子里说的是隔壁是有个很 nice 的小哥哥，现在被告知是一对情侣。除此之外，我觉得还行。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房5103-34珠江帝景_3500">跑房（5/10）：3-3<em>4</em>珠江帝景<!-- -->_<!-- -->3500<a class="hash-link" href="#跑房5103-34珠江帝景_3500" title="标题的直接链接">​</a></h3><p>接下来就是当晚最后一间房了，位于九龙山附近的珠江帝景。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646756511567-fa68bd26a7de703442cb9107f378812e2decbc602e8c25d61ff357e92537cf87.png" alt="picture 20" class="img_vXGZ"></p><p>理论上来说，这个房的地理位置应该是最好的，因为九龙山这里连通 14、7 号线，到达望京只需 50 分钟，到达四惠的公司只要 3.5 公里，比较适合骑车，地铁路线里只有大郊亭到百子湾段是重合的。</p><p>珠江帝景也是中介推荐房，两个人把我领了上去。</p><p>【视频：3-3<em>4</em>珠江帝景<!-- -->_<!-- -->3500.mp4】</p><p>看了一圈下来，空间肯定没有珠江绿洲的大，但其实有的一拼，不过珠江帝景对于我来说，这个阳台的造型与风景更加的有范，比较中我意，但没有独卫则是它的硬伤，否则 3500 的价格在这个地段、这个小区，那是相当值得。</p><p>但让我感到不是很舒服的两点之一，珠江帝景这个房是转租，在豆瓣帖上写的很清楚不要中介费和服务费，但是在问中介费用时却仍在算，说给个 500 什么的，我说帖子上不是这么写的，中介立即反应说是嘛，这块晚点确认一下，然后又聊了几句之后我再次确认费用核算时，中介已经没有提中介费相关问题，你细评。</p><p>第二点是关于服务费的，因为正常转租，人比较好的或者急于转的一般都会在帖子里说服务费就让给你了不用你交了，等到期再自己和房东与中介谈，这种就是比较友好的，比如珠江绿洲的两个小姐姐就是这样做的。但这里情况就不一样，是要我继续交接下来几个月服务费的，关键是，租客非常同意这一点，说不要在意那么点钱，他自己交了一年都不讲究。租客是一个 tony，也许工资确实比我高？但我觉得我就是很在意这个问题，中介凭什么能收两次服务费，除非，是转给“你”的吧。</p><p>不过说来也巧，过了几天后我刷到了一个动画视频，里面的房型竟然几乎和珠江帝景一样！让我哭笑不得。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646757175331-7eddac638f1b4110912d1a32f334b43e4112505667211f27767cec1670beda00.png" alt="picture 21" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房6103-41劲松七区_3000">跑房（6/10）：3-4<em>1</em>劲松七区<!-- -->_<!-- -->3000<a class="hash-link" href="#跑房6103-41劲松七区_3000" title="标题的直接链接">​</a></h3><p>第二天，吸取昨天的教训，放弃独卫的要求，从而尝试更多高性价比与高质量的房源。</p><p>从中午一点起，第一个房源是位于二环的劲松七区，价格 3000。</p><p>当天风超级大，出门时打电话都听不大清的那种。而在劲松七区内还看到一条被拴住的小狗，非常可怜。</p><p>【视频：大风中的小狗】</p><p>这个小区没有电梯，款式较老，有一个小学，感觉像学区房。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646759356077-ee8948e1bb0b902624d92c0d035e876b3ab249324021e64c6019284cc48b8089.png" alt="picture 22" class="img_vXGZ"></p><p>“受命”转租的是一位非常 nice 的小姐姐，待转租的是她的一位已经结婚准备回去生孩子的室友。另一位室友也是女生，做行政工作。</p><p>房间在六楼，从地铁走过来一点几公里还要再爬六楼着实还是有一点辛苦。</p><p>好在小姐姐很热情，消除了我很多的顾虑，我想的是如果租这个房至少能有一个非常好的室友关系，因为这位室友是做财务的，和我本科专业很有联系。</p><p>【视频：3-4<em>1</em>劲松七区<!-- -->_<!-- -->3000.mp4】</p><p>但最大的问题是，这个房子需要三月底才能搬，这对于我来说，并不太可行，因为这几天为了租房一直在住酒店，我需要尽快搞定租房问题。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房7103-42惠生园_3300">跑房（7/10）：3-4<em>2</em>惠生园<!-- -->_<!-- -->3300<a class="hash-link" href="#跑房7103-42惠生园_3300" title="标题的直接链接">​</a></h3><p>紧接着就是惠生园，我预留了两小时，正好能赶上。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646760068701-a4e3d80f9d7d21ca18d4d1620e0b2a285aa9918a657be930231932b012b94f16.png" alt="picture 23" class="img_vXGZ"></p><p>其实从地图上看，惠生园已经离地铁很近了，但我依旧走了较长时间，所以，一点几公里的步行，可能才是人生常态……</p><p>带我看房的是租户的室友，一位刚辞职可能准备创业的很斯文的男生，房间里还有一台大打印机。租户是位女生，房间很明亮。</p><p>【视频：3-4<em>2</em>惠生园<!-- -->_<!-- -->3300.mp4】</p><p>我能够接受房子价格高于 3000，但我不能接受高于 3000 还没有独卫……另一方面，它似乎离地铁与公司有点远。</p><p>但事实上，这也有可能是出于路线偏差。在来看这个房前因为已经走了很长的路（包括去劲松七区、走错地铁、走到惠生园等），看这个房之后又走了很长的路（2-4 公里）到公司附近得了另一套房，所以强化了惠生园走路很远的印象，然而事实上可能并不是，不过惠生园到公司确实不近，并且没法做地铁。</p><p>又查了下地图，好像只要两公里，可能当时走绕了……</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646804776040-338f544c70d3599e48ad4bfd90021c2641f9dde09acca9cad3aa95363b276bce.png" alt="picture 24" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房8103-43沿海赛洛城_2200">跑房（8/10）：3-4<em>3</em>沿海赛洛城<!-- -->_<!-- -->2200<a class="hash-link" href="#跑房8103-43沿海赛洛城_2200" title="标题的直接链接">​</a></h3><p>下一站是沿海赛洛城，就在公司南边 1.2 公里，是一个中介介绍，只要 2200 很便宜的房子。</p><p>实际上惠生园到公司与沿海赛洛城到公司距离差不多，两者到地铁距离也差不多，惠生园接近 1 号线，沿海赛洛城接近 7 号线（也可以往上去 1 号线），所以惠生园应该来说地理位置更好一些，但沿海赛洛城去公司不需要经过快速路，相对比较安全。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646804990842-99ab1be20299a833b54627c41b174f1ce625702af781d63bc91fe0b2be2b4f71.png" alt="picture 25" class="img_vXGZ"></p><p>房客是一个看起来很精致、大方的女孩，经问住了两年了，这次是到期搬走而不像其他的转租一样是中途搬走（因此需要重新交中介费与服务费等）。</p><p>【视频：3-4<em>3</em>沿海赛洛城<!-- -->_<!-- -->2200.mp4】</p><p>也许是受这女孩感染，查看了她的房后，觉得这个房间虽小，却也能够容纳很多人的生活与梦想，有种很温馨的感觉。</p><p>但让我觉得比较遗憾的是，这个窗户太小，并且是朝东的……</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房9103-44百子湾家园_2500">跑房（9/10）：3-4<em>4</em>百子湾家园<!-- -->_<!-- -->2500<a class="hash-link" href="#跑房9103-44百子湾家园_2500" title="标题的直接链接">​</a></h3><p>看完上个房后，中介说还有一个房，更大一些，要 2500，我看现在离下一个房还有点时间，所以也答应去看了。</p><p>【视频：3-4<em>4</em>百子湾家园<!-- -->_<!-- -->2500.mp4】</p><p>这个房确实就比 2200 的更明亮许多了，窗户很大，但是厨房比较脏，洗手间的水龙头竟然还打不开，这让我很不能接受。也许是正在维修什么的，但毕竟我今天是来“查房”，第一印象不好那后续就更麻烦了。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="跑房10103-45垂杨柳百里_3500">跑房（10/10）：3-4<em>5</em>垂杨柳百里<!-- -->_<!-- -->3500<a class="hash-link" href="#跑房10103-45垂杨柳百里_3500" title="标题的直接链接">​</a></h3><p>看的最后一套房是一个很奇葩的户型：团结户，我也过来见见世面。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_hire-house-research-1646806309702-f56180da34c2a4773bcddb09896f13e275eabd23d460a8fd4e15fede6b331cce.png" alt="picture 26" class="img_vXGZ"></p><p>接待我的是一个中介，屋子还坐着一个，好像也是中介，地道的北京人。</p><p>【视频：3-4<em>5</em>垂杨柳百里<!-- -->_<!-- -->3500.mp4】</p><p>这个房是个老房子了，据说墙体十分结实，后来过来一个 89 岁高龄的老爷爷，跟我们说住这已经五十多年了，唐山大地震那会对面 70 年代的“新”楼都裂缝了，这个房一点事都没有，还是十二人十二天盖一层楼搞定的……听的我直愣。</p><p>【照片：老爷爷】</p><p>老爷爷问了这个房的价格，中介来之前说是 3500，然后今早房东说要加价 100，所以是 3600，老爷爷听完说那还好，一楼的那个房厨房面积比这小一半前两年还要 3800……</p><p>由于这是我看的最后一套房了，所以聊了很久，中介也很会看人，见我已经从原来的室内站到门口了，说让我进来再坐会再聊聊，聊我的工作和家乡地，还讲了点南京的段子，还是挺有意思的。北京人就是实诚，有话就说，也能说会道，这个我还挺欣赏的。</p><p>以上就是全部跑房相关内容的记录了，更多问题可以私聊我。</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="投票环节">投票环节<a class="hash-link" href="#投票环节" title="标题的直接链接">​</a></h2><p>如果是您，您会选择哪一所房源：</p><p>【投票：房源】</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="info">info<a class="hash-link" href="#info" title="标题的直接链接">​</a></h2><ul><li>author: 南川</li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="version-010">version: 0.1.0<a class="hash-link" href="#version-010" title="标题的直接链接">​</a></h3><ul><li>date: 2022-03-09</li><li>content:<ol><li>完成全部代码封测，并开源，项目地址： <a href="https://github.com/mark-applications/data-science_douban-houses" target="_blank" rel="noopener noreferrer">mark-applications/data-science_douban-houses</a></li><li>使用该项目为身边某位正为租房而发愁的朋友无偿提供帮助</li></ol></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="version-004">version: 0.0.4<a class="hash-link" href="#version-004" title="标题的直接链接">​</a></h3><ul><li>date: 2022-03-08</li><li>content: 增加人工筛选与线下跑房环节</li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="version-003">version: 0.0.3<a class="hash-link" href="#version-003" title="标题的直接链接">​</a></h3><ul><li>date: 2022-03-07</li><li>content: 完成高德 API 部分</li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="version-002">version: 0.0.2<a class="hash-link" href="#version-002" title="标题的直接链接">​</a></h3><ul><li>date: 2022-03-05</li><li>content: 完成豆瓣小组 api 部分</li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="version-001">version: 0.0.1<a class="hash-link" href="#version-001" title="标题的直接链接">​</a></h3><ul><li>date: 2022-02-28</li><li>content: 完成租房方案设计部分</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_rTaS padding--none margin-left--sm"><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/开发笔记">开发笔记</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/租房">租房</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/豆瓣">豆瓣</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_UBNu" itemprop="headline"><a itemprop="url" href="/blog/2022/02/21/ad-beike-hiring">推广 | 贝壳新业务 VR 全职开发招募</a></h2><div class="container_x5Un margin-vert--md"><time datetime="2022-02-21T00:00:00.000Z" itemprop="datePublished">2022/02/21</time> · <!-- -->阅读需 4 分钟</div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_rB0w" id="工作职责">工作职责<a class="hash-link" href="#工作职责" title="标题的直接链接">​</a></h2><ol><li>负责贝壳 VR 实景项目海外业务的设计与开发工作</li><li>参与贝壳 VR 实景项目海外业务的架构设计与性能优化</li></ol><h2 class="anchor anchorWithStickyNavbar_rB0w" id="工作地点base-北京">工作地点：base 北京<a class="hash-link" href="#工作地点base-北京" title="标题的直接链接">​</a></h2><h2 class="anchor anchorWithStickyNavbar_rB0w" id="工作福利">工作福利<a class="hash-link" href="#工作福利" title="标题的直接链接">​</a></h2><p>包三餐，16 薪</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="任职要求">任职要求<a class="hash-link" href="#任职要求" title="标题的直接链接">​</a></h2><ol><li>统招本科及以上学历</li><li>熟练掌握以下一种或几种技术：<ul><li>一到三年 web 系统设计开发经验，熟悉常用设计模式</li><li>优秀的数据库设计优化能力，熟悉一种数据库应用，精通 mysql 者优先</li><li>熟悉 linux，能熟练使用一门或几门以下语言：C/C++/shell/python/java/javascript 等</li></ul></li><li>扎实的计算机基础，熟悉数据结构，有较强的算法设计能力</li><li>学习能力强，有较好的沟通能力，能迅速融入团队</li><li>较强的逻辑思维能力，具有较强产品意识</li></ol><h2 class="anchor anchorWithStickyNavbar_rB0w" id="联系方式">联系方式<a class="hash-link" href="#联系方式" title="标题的直接链接">​</a></h2><ul><li>联系电话：18995654993</li><li>邮箱：<a href="mailto:xiangchaoran001@ke.com" target="_blank" rel="noopener noreferrer">xiangchaoran001@ke.com</a></li></ul><h2 class="anchor anchorWithStickyNavbar_rB0w" id="公司简介">公司简介<a class="hash-link" href="#公司简介" title="标题的直接链接">​</a></h2><blockquote><p>贝壳起于链家，但不同于链家网的垂直自营模式，其使命是缔造平台。</p><p>2020 年 8 月，贝壳以 1000 亿元人民币市值位列《苏州高新区·2020 胡润全球独角兽榜》第 14。</p><p>2020 年 8 月 13 日，贝壳找房在纽交所正式挂牌上市，IPO 发行定价为 20 美元/ADS，股票代码“BEKE”，成为中国居住服务平台第一股。上市当天，贝壳股价上涨 87.2%，收于 37.44 美元，公司市值达到了 421.95 亿美元。9 月 25 日—10 月 30 日，贝壳找房携全国众多房企倾力打造的“全民新房节”将登陆全国 60 多个城市。</p><p>2020 年 12 月 12 日，由人民日报社指导、人民网主办的“2020 人民企业社会责任高峰论坛暨第十五届人民企业社会责任奖颁奖典礼”在北京举行。贝壳找房“线上贷签”获“年度案例奖”。</p><p>2021 年 4 月 9 日，贝壳找房推出签约服务中心，通过专属签约服务场景、培养专业签约经理，并深度联动整合资金存管、线上贷签等多项服务，为用户和行业带来安全、高效、优质体验的新一代签约服务。全国铺设超 300 家 已营业超 100 家。</p></blockquote><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_beike-hr-1645444261146-f9b6279e34887f5354ed2c1ed052596605f73d23a99c8bf6accbd5cb1d8314aa.png" alt="每个月的生日会" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_beike-hr-1645444282112-51b06f859a8b9ba416238eba8ffe68ba12feec6f8e709969369b9424ec6edcb1.png" alt="技术分享研讨会" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_beike-hr-1645444299855-fff9d2e2e18d38a61d82613ad54632c74dc1c23c55226c8cf2359a4af8f239d9.png" alt="办公区域" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mark_beike-hr-1645444181393-d555e335181ba87a0993166ca18c597e061b8fed6d8d96816d4c59cd99722784.png" alt="办公大厦" class="img_vXGZ"></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>标签：</b><ul class="tags_rTaS padding--none margin-left--sm"><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/推广">推广</a></li><li class="tag_l5va"><a class="tag_Nd8t tagRegular_TiLs" href="/blog/tags/vr">VR</a></li></ul></div><div class="col text--right col--3"><a aria-label="阅读 推广 | 贝壳新业务 VR 全职开发招募 的全文" href="/blog/2022/02/21/ad-beike-hiring"><b>阅读更多</b></a></div></footer></article><nav class="pagination-nav" aria-label="博文列表分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/page/5"><div class="pagination-nav__label">较新的博文</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/page/7"><div class="pagination-nav__label">较旧的博文</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Core</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/archive">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Docusaurus</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/category/guides" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://joshcena.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Case: Joshua Chen<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://vercel.com/markshawn2020/docusaurus/deployments" target="_blank" rel="noopener noreferrer" class="footer__link-item">Vercel Deploy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://analytics.google.com/analytics/web/#/p324822374/reports/reportinghub?params=_u.dateOption%3DthisWeekSatToToday" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Analytics<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ap-east-1.console.aws.amazon.com/ec2/home?region=ap-east-1#InstanceDetails:instanceId=i-02fffe2800e2025e1" target="_blank" rel="noopener noreferrer" class="footer__link-item">AWS EC2 Monitor (VPN)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.aacdcb6f.js"></script>
<script src="/assets/js/main.c22735e8.js"></script>
</body>
</html>