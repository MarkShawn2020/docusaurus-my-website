<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-alpha.0">
<title data-rh="true">微信数据库破解 | 南川笔记</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://markshawn2020.github.io/blog/2022/08/01/wechat-hack"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="微信数据库破解 | 南川笔记"><meta data-rh="true" name="description" content="- 项目展示"><meta data-rh="true" property="og:description" content="- 项目展示"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-08-01T00:00:00.000Z"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://markshawn2020.github.io/blog/2022/08/01/wechat-hack"><link data-rh="true" rel="alternate" href="https://markshawn2020.github.io/blog/2022/08/01/wechat-hack" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://markshawn2020.github.io/blog/2022/08/01/wechat-hack" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="南川笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="南川笔记 Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QFQ00XLDNZ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QFQ00XLDNZ",{anonymize_ip:!0})</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b123addb.css">
<link rel="preload" href="/assets/js/runtime~main.aacdcb6f.js" as="script">
<link rel="preload" href="/assets/js/main.c22735e8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_UHvc">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_qLAv themedImage--light_kaXc"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_qLAv themedImage--dark_ONYO"></div><b class="navbar__title text--truncate">南川笔记</b></a><a class="navbar__item navbar__link" href="/blog/archive">My Blog</a><a class="navbar__item navbar__link" href="/docs/">My Notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/markshawn2020/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source of Framework<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/markshawn2020/docusaurus-my-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source of Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/markshawn2020/my-documents" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source of Documents<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_bT41 colorModeToggle_UolE"><button class="clean-btn toggleButton_x9TT toggleButtonDisabled_Dj8q" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_dnYY"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_OBbf"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_CTO4"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_PEsc"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_P3nc thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_VrjY margin-bottom--md">All Posts</div><ul class="sidebarItemList_OSkG clean-list"><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/2422-INFP与ENTJ的日日夜夜">2024/2422-INFP与ENTJ的日日夜夜</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/2422-从FP走向TJ">2024/2422-从FP走向TJ</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/06/21/Rabbit-R1分享会">Rabbit-R1分享会</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/05/01/2419-信仰一跃">2419-信仰一跃</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/04/30/飞脑">飞脑</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/discarded/微信聊天记录备份指南">微信聊天记录备份指南</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2024/01/14/觉醒的硅基">觉醒的硅基</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/31/index">[03-27-digital-travel] 南川数字游民之旅01：</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/27/南川骑行川藏线（下）">南川骑行川藏线（下）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/19/十年 —— 一位自学者、技术工作者、理想主义者的独白">十年 —— 一位自学者、技术工作者、理想主义者的独白</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/12/18/南川骑行川藏线（中）">南川骑行川藏线（中）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/09/25/当我想做一款吹羽毛小游戏……">当我想做一款吹羽毛小游戏……</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2023/08/31/Poketto.AI 每一个人的哆啦A梦">Poketto.AI: 每一个人的哆啦A梦</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/12/31/this-year">this-year</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/08/29/coding-cries">代码有所能，有所不能</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/08/03/taiwan-data-research">关于台湾进出口临时政策与历史数据的研究</a></li><li class="sidebarItem_WJ0y"><a aria-current="page" class="sidebarItemLink_Qrfg sidebarItemLinkActive_nUeK" href="/blog/2022/08/01/wechat-hack">微信数据库破解</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/07/11/prose-I-am-me">札记 | 我与我周旋久，我亦是我</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/07/02/dev-gaokao">编程 | 使用 pandas 研究高考志愿填报</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/06/16/dev-gopro-2">编程 | GoPro 02: 玩转 OpenLab</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/06/11/dev-gopro-1">编程 | GoPro 01: 全天候自动 4K 延时摄影</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/06/06/dev-ios-automation">编程 | iOS 自动化实现王者荣耀一键换装</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/23/dev-mp3-meta">编程 | 逼哥的音乐元数据修复</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/22/evaluation-breo-dream6">评测 | Breo Dream6 按摩仪</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/15/prose-is-not-easy">札记 | 须知，活好是很不容易的</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/05/14/dev-voice2srt">编程 | 视频剪辑自动转写字幕</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/04/22/research-mbti/mark_mbti">研究 | 基于 MBTI 的人生复盘与计划（上）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/03/27/prose-321-air-crash">札记 | 愿逝者安息生者坚强，你我迎风奔跑向阳而生</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/03/09/dev-douban-renting">编程 | 北京租房系统设计、研究与经验 0.1.0</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/21/ad-beike-hiring">推广 | 贝壳新业务 VR 全职开发招募</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/12/coding-design-shortcuts/02-12-coding-design-shortcuts">编程设计艺术思考（持续更新）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/03/prose-living">札记 | 2022，活着</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/02/dev-linux">编程 | Linux 笔记</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/02/01/prose-2022-begining">札记 | 关于近几年的一些感悟</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/01/23/prose-engineer-cultivation">札记 | 一位工程师的自我修养（序）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/01/20/prose-first-job">札记 | 是的，我入职了</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2022/01/01/prose-my-2021">札记 | 我的 2021：混沌与洞见</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/12/24/dev-webpack">编程 | 记与 Webpack 十二小时的奋战</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/12/04/一道“全军覆灭”的数学题">一道“全军覆灭”的数学题</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/12/04/考研数学试题编辑">考研数学试题编辑</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/11/28/今天南川学习十小时了吗？是的。">关于正态分布表的一个有趣发现</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/11/09/浅谈我自学编程的经历与经验">浅谈我自学编程的经历与经验</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/10/28/关于有人想仲裁我">关于有人想仲裁我</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/10/27/十月：无题">十月：无题</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/10/18/王者荣耀打野上分经验总结（全干货）">王者荣耀打野上分经验总结</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/06/27/毕业一年：我的得与失">南川二一零六：毕业一年，我的失与得</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/05/12/记逆向攻破拼多多加密系统">南川逆向笔记 | 攻破 PDD 风控系统（一）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/04/14/从0到1搭建一个Electron应用">Electron 开发笔记 - 从 0 到 1 搭建一个 Electron 应用</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/03/12/shamghai-rent-lesson">记与上海无良房东斡旋经验与教训</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2021/01/09/评测-南川Effie使用初体验">南川 Effie 使用初体验</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/11/20/拜登获胜演讲稿">拜登获胜演讲稿</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/10/28/人生 | 五台山论道（节选自《遥远的救世主》）">五台山论道（节选自《遥远的救世主》）</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/10/16/大学沉思录：一路失败，我到底学到了什么">大学沉思录：一路失败，我到底学到了什么</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/10/16/大学沉思录：意向调查">大学沉思录：意向调查</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/22/JS、ES、TS、node、Vue、React修炼">JS、ES、TS、node、Vue、React 修炼</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/15/投资：凯利公式">“中一千万”与“挣一千万”到底哪个更容易</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/bug_fix">BUG FIX</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/home">南川笔记中文首页</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/todo-old">待办事项</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/release-notes">更新日志</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/guestbook">留言墙</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/12/经验与发现">经验与发现</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/10/JS、ES、TS、node、Vue、React修炼">JS、ES、TS、node、Vue、React 修炼</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/开发常用命令行">开发常用命令行</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/my_university">谨以此文，纪念我在大学的这四年</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/VuePress-Journal">VuePress你好，VuePres再见</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/vue开发笔记">vue开发笔记</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/08/29/博客开发之导航设计方案">博客开发之导航设计方案</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/08/29/如何向ElementUI一样封装Message全局组件">如何向ElementUI一样封装Message全局组件</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/如何给右键添加任何启动程序">如何给右键添加任何启动程序</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/08/29/我谈《三十而已》">我谈《三十而已》</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/文集/极客运营手册/">极客运营手册</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/13/ssg-ssr">When to Use Static Generation v.s. Server-side Rendering</a></li><li class="sidebarItem_WJ0y"><a class="sidebarItemLink_Qrfg" href="/blog/2020/09/13/pre-rendering">Two Forms of Pre-rendering</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_UBNu" itemprop="headline">微信数据库破解</h1><div class="container_x5Un margin-vert--md"><time datetime="2022-08-01T00:00:00.000Z" itemprop="datePublished">2022/08/01</time> · <!-- -->阅读需 33 分钟</div></header><div id="post-content" class="markdown" itemprop="articleBody"><ul><li><a href="#%E9%A1%B9%E7%9B%AE%E5%B1%95%E7%A4%BA">项目展示</a><ul><li><a href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E5%BE%AE%E4%BF%A1%E5%A5%BD%E5%8F%8B%E4%BF%A1%E6%81%AF">获取所有微信好友信息</a></li><li><a href="#%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%BE%AE%E4%BF%A1%E5%A5%BD%E5%8F%8B%E7%9A%84%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95">导出与微信好友的聊天记录</a></li><li><a href="#%E7%9B%91%E6%8E%A7%E5%AE%9E%E6%97%B6%E8%81%8A%E5%A4%A9">监控实时聊天</a></li><li><a href="#%E5%85%B6%E4%BB%96">其他</a></li></ul></li><li><a href="#%E5%8A%A8%E6%9C%BA%E8%83%8C%E6%99%AF">动机背景</a></li><li><a href="#%E6%8A%80%E6%9C%AF%E6%A6%82%E8%A7%88">技术概览</a><ul><li><a href="#github-search-until-wechat-decipher-macos">github search until <code>wechat-decipher-macos</code></a></li><li><a href="#macoseavesdropperd"><code>macos/eavesdropper.d</code></a></li><li><a href="#macosdbcrackerd"><code>macos/dbcracker.d</code></a></li><li><a href="#pcbakchatgatherd"><code>pcbakchat/gather.d</code></a></li><li><a href="#develxloggerd"><code>devel/xlogger.d</code></a></li><li><a href="#%E6%80%BB%E7%BB%93">总结</a></li><li><a href="#update2022-02-08-%E5%85%B3%E4%BA%8E%E5%8A%A0%E5%AF%86%E5%AD%97%E6%AE%B5">update@2022-02-08: 关于加密字段</a></li></ul></li><li><a href="#reference">reference</a><ul><li><a href="#%E5%90%84%E5%A4%A7%E5%B9%B3%E5%8F%B0%E4%BB%93%E5%BA%93%E5%90%88%E9%9B%86">各大平台仓库合集</a></li><li><a href="#mac%E7%89%88">mac 版</a></li><li><a href="#windows%E7%89%88">windows 版</a></li><li><a href="#ios%E7%89%88">ios 版</a></li><li><a href="#sqlcipher-%E7%9B%B8%E5%85%B3"><code>sqlcipher</code> 相关</a></li><li><a href="#pragma-%E7%9B%B8%E5%85%B3"><code>pragma</code> 相关</a></li><li><a href="#frida-%E7%9B%B8%E5%85%B3"><code>frida</code> 相关</a></li></ul></li><li><a href="#hack-manual">hack manual</a><ul><li><a href="#download-sqlite">download sqlite</a></li><li><a href="#test-sqlite">test sqlite</a></li><li><a href="#install-openssl-to-replace-the-built-in-libressl-on-macos">install <code>openssl</code> to replace the built-in <code>libressl</code> on MacOS</a><ul><li><a href="#install-openssl-via-brew">install <code>openssl</code> via <code>brew</code></a></li><li><a href="#config-openssl-into-path">config <code>openssl</code> into path</a></li><li><a href="#confirm-openssl">confirm openssl</a></li></ul></li><li><a href="#compile-sqlcipher">compile <code>sqlcipher</code></a></li><li><a href="#update-%E9%9D%99%E6%80%81%E7%BC%96%E8%AF%91">UPDATE: 静态编译</a></li><li><a href="#test-sqlcipher-workflow">test <code>sqlcipher</code> workflow</a><ul><li><a href="#step-1-crypto-a-plain-database-which-is-generated-by-our-sqlite-before">step 1. crypto a plain database (which is generated by our <code>sqlite</code> before)</a></li><li><a href="#step2-test-operate-on-an-encrypted-database-without-key-expect-failure">step2. test: operate on an encrypted database without key (expect: failure)</a></li><li><a href="#step3-test-dump-the-encrypted-database-into-plain-with-key-expect-success">step3. test: dump the encrypted database into plain with key (expect: success)</a></li><li><a href="#step4-test-open-the-decrypted-database-without-key-expect-success">step4. test: open the decrypted database without key (expect: success)</a></li></ul></li><li><a href="#sparklessparkles-decrypt-database">✨✨ decrypt database</a><ul><li><a href="#depreciated-pragma-config-of-sqlcipher-3-defaults">DEPRECIATED: pragma config of sqlcipher 3 defaults</a></li><li><a href="#best-practice-pragma-config-of-sqlcipher-3-defaults">BEST-PRACTICE: pragma config of sqlcipher 3 defaults</a></li><li><a href="#check-salt-of-specific-database-file">check salt of specific database file</a></li><li><a href="#decrypt-and-dump-specific-database-file">decrypt and dump specific database file</a></li><li><a href="#test-dumped-database-file-via-sqlcipher-or-sqlite3">test dumped database file (via <code>sqlcipher</code> or <code>sqlite3</code>)</a></li></ul></li></ul></li><li><a href="#wechat-design">wechat design</a><ul><li><a href="#design-of-contact-fields">design of contact fields</a></li><li><a href="#design-of-user-id-to-contact-id-md5">design of user id to contact id: <code>md5</code></a></li><li><a href="#improve-get-self-id">IMPROVE: get self id</a></li><li><a href="#todo-get-image-from-xml">TODO: get image from xml</a></li></ul></li><li><a href="#py-sqlcipher-instruction">py-sqlcipher instruction</a><ul><li><a href="#compile">compile</a></li><li><a href="#connection">connection</a></li><li><a href="#table">table</a><ul><li><a href="#list-all-the-tables">list all the tables</a></li><li><a href="#list-the-columns-of-table-get-table-schema">list the columns of table (get table schema)</a></li><li><a href="#format-rows-display">format rows display</a></li><li><a href="#list-rows-in-one-table">list rows in one table</a></li></ul></li></ul></li><li><a href="#extended">extended</a><ul><li><a href="#how-to-know-my-openssl-versioninfo">how to know my openssl version/info</a></li><li><a href="#bugfix-error-c-compiler-cannot-create-executables">bugfix: <code>error: C compiler cannot create executables</code></a></li></ul></li><li><a href="#%E6%9C%AC%E9%A1%B9%E7%9B%AE%E5%90%88%E4%BD%9C%E4%BC%99%E4%BC%B4">本项目合作伙伴</a></li></ul><h2 class="anchor anchorWithStickyNavbar_rB0w" id="项目展示">项目展示<a class="hash-link" href="#项目展示" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="获取所有微信好友信息">获取所有微信好友信息<a class="hash-link" href="#获取所有微信好友信息" title="标题的直接链接">​</a></h3><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644136070132-9386a758919031c4082e3fd702273d38499aa3157ce2906861583e87a0f7d41a.png" alt="picture 86" class="img_vXGZ"></p><p>derived from hacked db: <code>Contact/wccontact_new2.db</code></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="导出与微信好友的聊天记录">导出与微信好友的聊天记录<a class="hash-link" href="#导出与微信好友的聊天记录" title="标题的直接链接">​</a></h3><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644136499656-9a9e5597f347af566ceba6f711c905b58bf81370b11c9b551df3ceed6dbe3e10.png" alt="picture 87" class="img_vXGZ"></p><p>derived from hacked dbs: <code>Message/msg_*.db</code></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="监控实时聊天">监控实时聊天<a class="hash-link" href="#监控实时聊天" title="标题的直接链接">​</a></h3><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644136566951-029db895a57dcce825b718f2c02eb4442595ca622b30dc304b0730ca43c83a45.png" alt="picture 88" class="img_vXGZ"></p><p>derived from real-time terminal</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="其他">其他<a class="hash-link" href="#其他" title="标题的直接链接">​</a></h3><h2 class="anchor anchorWithStickyNavbar_rB0w" id="动机背景">动机背景<a class="hash-link" href="#动机背景" title="标题的直接链接">​</a></h2><p>一切，都要从南川的计算机小群里 <code>Shining Lavender</code> 和 <code>Le Penseur</code> 同学聊到“爱”这个高深的话题，继而聊到了“soulmate”，而我最近恰好看了《Intouchables》：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644105366255-7f103adb1dbc36f747db75146f8585756fb59d54ea52e5bf60df4ee4f24ec24b.png" alt="picture 66" class="img_vXGZ"></p><p>所以和 <code>Le Penseur</code> 同学一下探讨到了凌晨……</p><p>上半场刚结束，基友群表示对这个话题也很感兴趣，遂我们又来回肝完了半个通宵。</p><p>下半场也结束后，我发现我很想把这些闪烁智慧与思考、彭拜着荷尔蒙与伤感的青春文字记录整理下来，但是无奈微信未能提供满足我这种需求的便利。</p><p>自然而然地，作为一名合格的程序员，兵来将挡水来土掩，我们又上场了……</p><p>历时一天，彻底拿下！</p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="技术概览">技术概览<a class="hash-link" href="#技术概览" title="标题的直接链接">​</a></h2><p>思路还是比较通用的。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="github-search-until-wechat-decipher-macos">github search until <code>wechat-decipher-macos</code><a class="hash-link" href="#github-search-until-wechat-decipher-macos" title="标题的直接链接">​</a></h3><p>首先，第一步，去 <code>github</code> 搜索是否已经有破解微信聊天记录相关的开源仓库，结果，应有尽有，一应尽全 - <a href="https://github.com/search?q=wechat+history" target="_blank" rel="noopener noreferrer">Search · wechat history</a>：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644107134293-92350d3d13791ae819981fdc8c57d10005f87b3a67af3d83477ca6170566d38d.png" alt="picture 68" class="img_vXGZ"></p><p>可以看到，至少在这一页前几个仓库中，安卓、iOS、mac 都有，windows 倒不确定。</p><p>我目前手机用的是安卓，电脑是 mac，但我用电脑比较多，所以我倾向于选择 mac 的方案，于是第一选择这个仓库 - <a href="https://github.com/nalzok/wechat-decipher-macos" target="_blank" rel="noopener noreferrer">nalzok/wechat-decipher-macos: Scripts to extract chat history from WeChat on macOS</a></p><p>不过这个仓库，起手难度可不低，仓库介绍十分简练，但真的是字字珠玑！</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644107483092-cfb440bb5ad7cb61932c7d7f68c796bc966e40a97e3afec36f715c951008a13e.png" alt="picture 70" class="img_vXGZ"></p><p>对于用户（我）来说，这个仓库的主要功能在前三者，一定要仔细理解，每个字都很宝贵：</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="macoseavesdropperd"><code>macos/eavesdropper.d</code><a class="hash-link" href="#macoseavesdropperd" title="标题的直接链接">​</a></h3><p><code>macos/eavesdropper.d</code>是用于实时、高速打印微信与数据库之间的信息流的，具体什么样子呢？我运行一下给你们看一下。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644108103693-89dccd5c3c7ffd9fa7fcd17120f0a21253dff4a8a8fbe9a28003ae06e6acd5e2.png" alt="picture 72" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644108029952-190572feae187736fdd39670cdd6c0530ca02d572880ef6567b45a92937710e2.png" alt="picture 71" class="img_vXGZ"></p><p>可以看到，我在微信中发送的聊天内容，会被明文显示到控制台中，并且在不同的时间点被打印了两遍。</p><p>当然，这不是微信自己打印的，是我们（他的）脚本打的，并且把结构体都打出来了，这个结构体和最终存到数据库里的数据结构基本是差不多的。</p><p>比如这是我们数据库中的样子：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644108568767-1a6f573f038fc329ebc643aa5d2cae05060209952f9da6572cb7f693e5d866e0.png" alt="picture 73" class="img_vXGZ"></p><p>但是，由于这是用于实时的，也就是过去的就没有了，所以不满足我的需求，因为我也没有深究这个脚本（比如为啥打印两次，强迫症的我接受不了，至少接受不了这么大面积的冗余）。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="macosdbcrackerd"><code>macos/dbcracker.d</code><a class="hash-link" href="#macosdbcrackerd" title="标题的直接链接">​</a></h3><p>其实我一开始没有看懂<code>macos/dbcracker.d</code>这个脚本用来干啥的，并且以为第四个脚本<code>devel/xlogger.d</code>才是我的目标，但显然，这个想法错的离谱。</p><p><code>cracker</code>是“撕裂者”的意思，<code>dbcracker</code>就是“数据库撕裂者”，听起来还是很可怕吧！</p><p><strong>事实上，它真地很可怕 ！</strong></p><p><strong>而且，我后续所有的工作都是基于它完成的！</strong></p><p>但它的操作，就没有第一个脚本 <code>macos/eavesdropper.d</code>那么容易上手了。</p><p>首先，注意它的描述：<code>Since it can only capture secrets when WeChat.app opens these files, you need to perform a login while the script is running.</code>，也就是你需要先运行脚本，然后重启微信，才能看到效果。</p><p>不过经过我的测试，正确流程是这样的，先退出微信登录（或者直接杀掉，然后启动），保留微信在登录界面（但还没有登录），接着运行脚本（否则会报基于没有进程导致的后续错误），然后扫码登录成功，这个时候就能飞速地看到命令行有很多数据在跑了，其实就是微信所有（大部分）的数据库的文件位置、秘钥、参数等。</p><p>值得注意的是，秘钥是用来干啥的。</p><p>一般用惯了<code>mysql</code>或者<code>mongodb</code>之类数据库的人（别”人“了，就是我），其实根本不知道这个秘钥（既然不是用户密码）用来干嘛，这才是本项目的第一大难点。</p><p>这个时候，细心地读下一句：<code>Simply copy &amp; paste the script output to invoke SQLCipher and supply the respective PRAGMAs.</code>，翻译过来就是，把命令行的输简单地出复制粘贴，已启动<code>SQLCipher</code>并分别用于<code>PRAGMA</code>。</p><p>很绕，也一脸懵逼是不，是就对了！</p><p>答案在那个超链接 <a href="https://github.com/sqlcipher/sqlcipher" target="_blank" rel="noopener noreferrer">sqlcipher/sqlcipher: SQLCipher is a standalone fork of SQLite that adds 256 bit AES encryption of database files and other security features.</a> 上，所以你为了使用 A 项目，不得不去先啃 B 项目了。</p><p>但实际上，<code>sqlcipher</code>更难看懂，尤其是一上来就教你怎么编译，非常硬核（然而还有坑）：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644109309058-9d622be690c067975eaea80a80f4a42c9499abc22492987a84ac599e8df57cc1.png" alt="picture 74" class="img_vXGZ"></p><p>编就编吧，还有依赖，看看：</p><div class="language-text codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-text codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">You must define SQLITE_HAS_CODEC and either SQLITE_TEMP_STORE=2 or SQLITE_TEMP_STORE=3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You will need to link against a support cryptographic provider (OpenSSL, LibTomCrypt, CommonCrypto/Security.framework, or NSS)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>让我们定义变量（一开始以为是环境变量，后来发现是头文件内部变量），还要链接一个加密库……</p><p>一脸懵逼吧。</p><p>我一开始也看不懂，然后瞎编了一下。</p><p>结果果然报错了……</p><p>接着就一顿乱搜，然后找到了对本项目影响最大的一篇博客：- <a href="https://blog.csdn.net/u011195398/article/details/85266214" target="_blank" rel="noopener noreferrer">(25 条消息) Mac 终端使用 Sqlcipher 加解密基础过程详解<!-- -->_<!-- -->Martin.Mu `s Special Column-CSDN 博客<!-- -->_<!-- -->mac sqlcipher</a>。</p><p>这个事实充分证明，只要你想干的事情足够大众，你就能找到非常不错的伙伴，或者说，前辈。</p><p>该文章基本包括了<code>sqlcipher</code>如何编译、安装的问题，以及（非常前瞻性地）解决了里面的一些坑，节省了我可期的很多时间。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644130239719-433993ab017e150fd403cf6f0fe102a3602183aa1ae9a2ecea6a158d8b1fda6e.png" alt="picture 75" class="img_vXGZ"></p><p>基于这篇文章，我熟悉了 <code>sqlcipher</code> 的使用，意识到 <code>sqlcipher</code> 是 <code>sqlite3</code> 的加密版，每个数据库可以独立地用一个<code>KEY</code>加密，然后还可以解密，并导出无加密版本的<code>sqlite3</code>。</p><p>所以在那之后，我才真正地意识到 <code>macos/dbcracker.d</code> 是用来干什么的：</p><ol><li>用该脚本，通过监听微信启动时打开数据库的动作，暴露微信所有数据库的文件位置与秘钥信息</li><li>接下来数据库秘钥都有了，做啥就取决于自己了，比如说把所有好友的信息都导出成一张 excel 表这种</li></ol><p>以下是该脚本监控到的数据库，与微信实际数据库对比。</p><p>Almost all (especially the core ones, such as Contacts/Messages relative) the tables are tracked.</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644082483000-9d84d84536dbcbdcee54074954060a9d798375d608d3b1f67c60b4afcf5fd206.png" alt="picture 54" class="img_vXGZ"></p><p>Hence, it&#x27;s pretty good for our further work.</p><p>Also, the <code>db-list.txt</code> is derived from:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644082665967-654ab2912014189f77101b76367871983ab657d7318233475a776c032ba756fe.png" alt="picture 55" class="img_vXGZ"></p><p>And the <code>db-list-tracked.txt</code> is derived from:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644082727437-9dff122b852aacc64580230804b033baf509e62fd1266f8b4d682369ff172228.png" alt="picture 56" class="img_vXGZ"></p><p>The <code>track.log</code> is derived from:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644082780616-f364e35190d91279aa6dd8346429605b7bbc93b8baae3c33a2b6487cd94dfd74.png" alt="picture 57" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="pcbakchatgatherd"><code>pcbakchat/gather.d</code><a class="hash-link" href="#pcbakchatgatherd" title="标题的直接链接">​</a></h3><p>这个脚本其实也挺有用的，它能捕获备份时的数据流。</p><p>在说这个之前，我们有必要明确一下微信中的备份是啥意思（尤指 mac 平台）。</p><p>其实是这样的， 由于登录设备差异，同一个微信账户在不同设备（win、mac、ios、android）上的聊天记录是不完全一致的，一般手机上的才是完整的，电脑上（如果你没有一直登）是不完整的。</p><p>所以 mac 平台上的备份就包括</p><ol><li>从手机备份到 mac</li><li>从 mac 备份到手机</li></ol><p>我一开始以为备份是指把 mac 上的数据备份到另一个文件夹内，这个理解是不对的，其实如果去看微信的数据库设计部分，每个数据库是有单独的<code>.db.bak</code>的，尽管不大（也许里面压根就没有备份的数据，或者是压缩后的），但微信确实都有数据库级别备份的意图。</p><p>那无论是从手机备份到 mac 还是从 mac 备份到手机，都涉及到两台机器之前通信的问题，再明确一点，他们要彼此在同一个局域网内，用 socket 进行文件传送的。</p><p>所以其实 <code>pcbakchat/gather.d</code>就是劫持这部分局域网通信，把所有要备份的聊天记录都曝光出来，达到了给我们自己处理的目的。</p><p>具体可以见本仓库对备份部分的详细说明 - <a href="https://github.com/nalzok/wechat-decipher-macos/tree/main/devel" target="_blank" rel="noopener noreferrer">wechat-decipher-macos/devel at main · nalzok/wechat-decipher-macos</a>：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644130960943-7e25936bcc8028c4eb34ffc5a2c09900211965a997718ded3f559f7fc6a7ae21.png" alt="picture 76" class="img_vXGZ"></p><p>可以看到还是比较复杂的，我一开始本来是走的这个思路，但是当时我还没对微信的数据库有较高的认识，所以当时这个方案跑起来了但是我没用。</p><p>其实这个方案应该最适合我的需求，因为我想获得的好友/群组的信息是已知的、数量不多的，我可以分别对这几个好友/群组进行备份动作，这样可以很方便地直接得到与他们的聊天记录（还可以在备份时选择时间，并且是手机上的聊天记录，也就是更完整）。</p><p>但考虑到我后来一直在研究数据库加解密上，并且在获得数据库秘钥之后，通过操作数据库也能获得我所有想要的聊天记录（因为当时我聊天的部分恰好都在 mac 上），所以 <code>macos/dbcracker.d</code> 已经能够满足我的要求。</p><p>所以本篇也会重点基于 <code>macos/dbcracker.d</code> 进行介绍，尽管 <code>pcbakchat/gather.d</code> 更适合导出与指定好友的（更完整的）聊天记录，更具有“社会”价值，但前者更具有“娱乐”（bushi，研究）价值。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="develxloggerd"><code>devel/xlogger.d</code><a class="hash-link" href="#develxloggerd" title="标题的直接链接">​</a></h3><p>这个其实就是把 mac 微信上所有的消息流都劫持了，打印出非常多的东西，所以只适合“黑客”自己二度开发相要的功能。</p><p>我们的需求没必要用这个，并且它一打开，微信就卡死了……可能是影响了微信的运行速度，然后假死，这是异常行为，可能有封号风险，所以谨慎。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="总结">总结<a class="hash-link" href="#总结" title="标题的直接链接">​</a></h3><p>我们全部的工作，主要还是建立在 - <a href="https://github.com/nalzok/wechat-decipher-macos" target="_blank" rel="noopener noreferrer">nalzok/wechat-decipher-macos: Scripts to extract chat history from WeChat on macOS</a> 的基础上，<code>Qingyao Sun</code>做了出色的工作（尽管部分地方有一些瑕疵），没有他精致（还记得我怎么评价的吗？“字字珠玑”）的项目文档，与合理的项目结构设计，我是不太可能一到两天就“攻破”微信的数据库的，感谢！</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644131537140-b4113df9c6055f65ec8d2cd43d0423a9246884e02b0d9379c85db0315f91c831.png" alt="picture 77" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="update2022-02-08-关于加密字段">update@2022-02-08: 关于加密字段<a class="hash-link" href="#update2022-02-08-关于加密字段" title="标题的直接链接">​</a></h3><p>备份数据库的<code>cipher_page_size</code>不是默认值（1024），而是 4096！</p><p>所以原作中打印出这些信息是很有必要的!</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644311729706-1de6652c04e0493ac7ba53cfeb35af14784e1351923142709da40f726c039501.png" alt="picture 19" class="img_vXGZ"></p><h2 class="anchor anchorWithStickyNavbar_rB0w" id="reference">reference<a class="hash-link" href="#reference" title="标题的直接链接">​</a></h2><blockquote><p>如果您想自己攻破微信的数据库系统，以下是一些我认为比较核心的参考资料，包括各大平台的。</p><p>万变不离其中的是，微信的数据库使用的是基于<code>sqlite3</code>加密的<code>sqlcipher</code>，并且是<code>sqlcipher 3 defaults</code>配置，所以理解与熟悉该数据库才是全部工作的最大攻坚战。当你攻破之后，怎么做，就是你的事情了。</p><p>⚠️ 友情提醒：不要乱动微信的数据库，否则引起的一切后果，与本文无关，本文不涉及任何修改微信数据库的实现</p></blockquote><h3 class="anchor anchorWithStickyNavbar_rB0w" id="各大平台仓库合集">各大平台仓库合集<a class="hash-link" href="#各大平台仓库合集" title="标题的直接链接">​</a></h3><ul><li><a href="https://github.com/search?q=wechat+history" target="_blank" rel="noopener noreferrer">Search · wechat history</a></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="mac-版">mac 版<a class="hash-link" href="#mac-版" title="标题的直接链接">​</a></h3><ul><li>mac 版详细教程：<a href="https://blog.csdn.net/u011195398/article/details/85266214" target="_blank" rel="noopener noreferrer">Mac 终端使用 Sqlcipher 加解密基础过程详解<!-- -->_<!-- -->Martin.Mu `s Special Column-CSDN 博客<!-- -->_<!-- -->mac sqlcipher</a></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="windows-版">windows 版<a class="hash-link" href="#windows-版" title="标题的直接链接">​</a></h3><ul><li>windows 版详细教程：<a href="https://bbs.pediy.com/thread-251303.htm" target="_blank" rel="noopener noreferrer">[原创]PC 版微信数据库解密详细教程-软件逆向-看雪论坛-安全社区|安全招聘|bbs.pediy.com</a></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="ios-版">ios 版<a class="hash-link" href="#ios-版" title="标题的直接链接">​</a></h3><ul><li><a href="https://daily.zhihu.com/story/8807166" target="_blank" rel="noopener noreferrer">知乎日报 - 知乎</a></li><li><a href="https://github.com/stomakun/WechatExport-iOS" target="_blank" rel="noopener noreferrer">stomakun/WechatExport-iOS: Save iOS WeChat history as HTML or TXT with neat layout and picture &amp; audio support.</a></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="sqlcipher-相关"><code>sqlcipher</code> 相关<a class="hash-link" href="#sqlcipher-相关" title="标题的直接链接">​</a></h3><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644134209068-2d046f82a3ae99e9704b64974a0444567cc9955e47a1ef2cc419ce53671d9cd4.png" alt="picture 79" class="img_vXGZ"></p><ul><li><p><code>sqlcipher</code>官方版本（提供了启动指引）：<a href="https://github.com/sqlcipher/sqlcipher" target="_blank" rel="noopener noreferrer">sqlcipher/sqlcipher: SQLCipher is a standalone fork of SQLite that adds 256 bit AES encryption of database files and other security features.</a></p></li><li><p>python 版本<code>sqlcipher</code>: <a href="https://github.com/rigglemania/pysqlcipher3" target="_blank" rel="noopener noreferrer">rigglemania/pysqlcipher3: Python 3 bindings for SQLCipher</a></p></li><li><p>✨可视化软件（前期验证登录帮了大忙）：<a href="https://sqlitebrowser.org/dl/" target="_blank" rel="noopener noreferrer">Downloads - DB Browser for SQLite</a></p></li><li><p><code>sqlcipher</code> （商业）官方网站：<a href="https://www.zetetic.net/sqlcipher/" target="_blank" rel="noopener noreferrer">SQLCipher - Zetetic</a></p></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="pragma-相关"><code>pragma</code> 相关<a class="hash-link" href="#pragma-相关" title="标题的直接链接">​</a></h3><blockquote><p><code>pragma</code> 是 <code>sqlite3</code> 中的一种关键字，具体我也不太懂，我们项目只需要会用很简单的几条语句即可，是操作 <code>sqlcipher</code> 必须的。</p></blockquote><ul><li>✨✨<code>pragma</code>核心语句（包括算法部分）：<a href="https://utelle.github.io/SQLite3MultipleCiphers/docs/configuration/config_sql_pragmas/#pragma-hmac_algorithm" target="_blank" rel="noopener noreferrer">SQL Pragmas | SQLite3 Multiple Ciphers</a></li><li>✨ <code>sqlcipher</code>相关接口实现：<a href="https://github.com/Tencent/sqlcipher/blob/4f37c817eb99e18e4fdc8ac63d67ac33610d66be/src/crypto_impl.c" target="_blank" rel="noopener noreferrer">sqlcipher/crypto_impl.c at 4f37c817eb99e18e4fdc8ac63d67ac33610d66be · Tencent/sqlcipher</a></li><li><code>pragma</code>部分语句（没有算法部分）：<a href="https://www.sqlite.org/pragma.html" target="_blank" rel="noopener noreferrer">Pragma statements supported by SQLite</a></li><li><code>pragma</code>部分语句（也没有算法部分）：<a href="https://www.runoob.com/sqlite/sqlite-pragma.html" target="_blank" rel="noopener noreferrer">SQLite PRAGMA | 菜鸟教程</a></li><li>其他<code>pragma</code>相关问题：<a href="https://juejin.cn/post/6844903983899738126" target="_blank" rel="noopener noreferrer">如何降级加密的 Sqlite 数据库文件 - 掘金</a></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="frida-相关"><code>frida</code> 相关<a class="hash-link" href="#frida-相关" title="标题的直接链接">​</a></h3><blockquote><p><code>frida</code> 是用于逆向的，原以为要用到，后来发现没有（至少我的应用级别没用到），也是捏了一把冷汗。以防需要，所以也补一份。项目底层监控微信部分，应该是用到了 <code>frida</code> 的。</p></blockquote><ul><li><a href="https://frida.re/" target="_blank" rel="noopener noreferrer">Frida • A world-class dynamic instrumentation framework | Inject JavaScript to explore native apps on Windows, macOS, GNU/Linux, iOS, Android, and QNX</a></li></ul><h2 class="anchor anchorWithStickyNavbar_rB0w" id="hack-manual">hack manual<a class="hash-link" href="#hack-manual" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="download-sqlite">download sqlite<a class="hash-link" href="#download-sqlite" title="标题的直接链接">​</a></h3><p>download any sqlite versions from here <a href="https://www.sqlite.org/download.html" target="_blank" rel="noopener noreferrer">SQLite Download Page</a> or directly download mac (x86) version from <a href="https://www.sqlite.org/2022/sqlite-tools-osx-x86-3370200.zip" target="_blank" rel="noopener noreferrer">https://www.sqlite.org/2022/sqlite-tools-osx-x86-3370200.zip</a></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="test-sqlite">test sqlite<a class="hash-link" href="#test-sqlite" title="标题的直接链接">​</a></h3><p>unzip the downloaded sqlite zip, and test the sqlite.</p><div class="language-text codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-text codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">➜  sqlite-tools-osx-x86-3370200 tree .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── sqldiff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── sqlite3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── sqlite3_analyzer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 directories, 3 files</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644051236520-b24b75cf94124fd18e0e540dba9d639924e0b3886bac991f0d816a301f9195ce.png" alt="picture 14" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="install-openssl-to-replace-the-built-in-libressl-on-macos">install <code>openssl</code> to replace the built-in <code>libressl</code> on MacOS<a class="hash-link" href="#install-openssl-to-replace-the-built-in-libressl-on-macos" title="标题的直接链接">​</a></h3><p>!!!warning <code>brew</code> need to be pre-installed</p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="install-openssl-via-brew">install <code>openssl</code> via <code>brew</code><a class="hash-link" href="#install-openssl-via-brew" title="标题的直接链接">​</a></h4><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">brew install openssl</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_rB0w" id="config-openssl-into-path">config <code>openssl</code> into path<a class="hash-link" href="#config-openssl-into-path" title="标题的直接链接">​</a></h4><p>According to the brew instruction on openssl:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644051857192-ba13ebef60caf744ce20b9a323a616f7f32555fd0b5b9005145cda243ecfc645.png" alt="picture 15" class="img_vXGZ"></p><p>We can directly write all the three commands into shell and make them work:</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain"># if you use bash, change $SHELL to be `~/.bashrc`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHELL=~/.zshrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF &gt;&gt; $SHELL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">heredoc&gt; export PATH=&quot;/usr/local/opt/openssl@3/bin:$PATH&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">heredoc&gt; export LDFLAGS=&quot;-L/usr/local/opt/openssl@3/lib&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">heredoc&gt; export CPPFLAGS=&quot;-I/usr/local/opt/openssl@3/include&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">heredoc&gt; export PKG_CONFIG_PATH=&quot;/usr/local/opt/openssl@3/lib/pkgconfig&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">heredoc&gt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source $SHELL</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>result</p></blockquote><p>before changing openssl, the default openssl is libressl:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644052002163-d79b3d78530e7e5b36887fcdef9c06839cbec11de0eb37e30d6304d78168fd2f.png" alt="picture 16" class="img_vXGZ"></p><p>after that it becomes openssl:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644052027060-7263c604b5c8466f67e9a83b5b8900712952f6f2092d8cbde50fc8856536cc5d.png" alt="picture 17" class="img_vXGZ"></p><p>!!!tip 因为将 openssl 的路径加入了 path（并且在默认搜索路径之前），所以现在输入<code>openssl</code>会优先检索到我们的 openssl，如果想换回默认的<code>libressl</code>，则一方面可以在<code>~/.zshrc</code>配置文件中把我们新加入的几句话注释掉，这样每次重启 SHELL 就不会有；同时，我们还要在 SHELL 中重置一下 path，如下：</p><div class="codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-text codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">![picture 19](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644052792755-dfbab4a924d8531c5199ef3f75dc6c635ba7f965452f14a7e7f701cc735d93dd.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">参考:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [How to Reset the PATH Variable on Mac to Default macOS PATH](https://techpp.com/2021/09/13/reset-path-variable-on-mac-guide/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [macos - How do I reset the $PATH variable on Mac OS X? - Super User](https://superuser.com/questions/121870/how-do-i-reset-the-path-variable-on-mac-os-x)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_rB0w" id="confirm-openssl">confirm openssl<a class="hash-link" href="#confirm-openssl" title="标题的直接链接">​</a></h4><p>According to the <code>brew install openssl</code> command result, our openssl source codes are under <code>/usr/local/Cellar/openssl@xxx</code>:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644053094808-83ad1e420d3f10f9f1993392ef81a7937f1cb2feb36d2c8d65ee15b761a803f1.png" alt="picture 20" class="img_vXGZ"></p><p>Have a check:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644053177928-4cadb79f22f3201c1298c4758b50ff84de6761bf3a4c7f399977cd261f04e950.png" alt="picture 21" class="img_vXGZ"></p><p>!!!tip 可以看到，我们其实默认是有一个<code>openssl@1.1</code>的，然后我们新装了一个<code>openssl@3</code>，所以实际上我 follow 的那个帖子并不完全正确。</p><div class="codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-text codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">至少在我们安装homebrew后，就已经有了`openssl`(不单单是mac的`libressl`)。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">这意味着其实我们（可能）没有必要再安装一个`openssl`，直接把目前这个`openssl`相关的信息写入环境变量即可。（待验证这种方式是否有效）</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_rB0w" id="compile-sqlcipher">compile <code>sqlcipher</code><a class="hash-link" href="#compile-sqlcipher" title="标题的直接链接">​</a></h3><p>官方 <a href="https://github.com/sqlcipher/sqlcipher" target="_blank" rel="noopener noreferrer">sqlcipher/sqlcipher: SQLCipher is a standalone fork of SQLite that adds 256 bit AES encryption of database files and other security features.</a>对编译是这么写的：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055146714-d0372f937c55a48d57a16ad23499d9dcacedcffc95c73c8858b6fe4558bbe24f.png" alt="picture 23" class="img_vXGZ"></p><p>在我没有<code>define SQLITE_HAS_CODEC and either SQLITE_TEMP_STORE=2 or SQLITE_TEMP_STORE=3</code>之前（引申阅读： 1. <a href="https://www.leavesongs.com/C/EncryptSqlite.html" target="_blank" rel="noopener noreferrer">VC++下的 sqlite 数据库加密 | 离别歌</a>， 2. <a href="https://sqlite.org/forum/forumpost/775a68525e" target="_blank" rel="noopener noreferrer">SQLite Forum: SQLITE_HAS_CODE is gone?</a>），运行的命令行会报错：</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">./configure --enable-tempstore=yes CFLAGS=&quot;-DSQLITE_HAS_CODEC&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LDFLAGS=&quot;/usr/local/Cellar/openssl@3/3.0.1/lib/libcrypto.a&quot;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055119287-849f7d0ef323bdf71b4812bc1983b56cbdd2b88d5e8ecac4c1537f737e49add9.png" alt="picture 22" class="img_vXGZ"></p><p>但你定义上述变量还比较麻烦，要去某个<code>.h</code>里，我都不知道它们在哪……其次，也不一定只是定义这个问题。</p><p>在我们的中文教程 <a href="https://blog.csdn.net/u011195398/article/details/85266214" target="_blank" rel="noopener noreferrer">(25 条消息) Mac 终端使用 Sqlcipher 加解密基础过程详解<!-- -->_<!-- -->Martin.Mu `s Special Column-CSDN 博客<!-- -->_<!-- -->mac sqlcipher</a> 里他摸索出来的结果是这样的：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055284135-3cff04278bbf581910400b65b3fb0ec043943b1d4a860da1da07a7d11472dbb5.png" alt="picture 24" class="img_vXGZ"></p><p>所以我基于他给出的命令行改成了如下（1. 删除了<code>--prefix=yourlibdir</code>这个参数； 2. 修改了<code>LDFLAGS</code>参数为我们实际的<code>libcrypto.a</code>位置）：</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">./configure  --disable-tcl --disable-shared --enable-static=yes --enable-tempstore=yes --with-crypto-lib=none CFLAGS=&quot;-DSQLITE_HAS_CODEC -DSQLCIPHER_CRYPTO_OPENSSL&quot; LDFLAGS=&quot;/usr/local/Cellar/openssl@3/3.0.1/lib/libcrypto.a&quot;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后一下就编译成功了！</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055366303-2d91dce8f1cfaff53f1b4959720cb43da46acaa813e69590a0ecd728aacc4b01.png" alt="picture 25" class="img_vXGZ"></p><p>接着就是<code>make</code>一下，最终会生成<code>sqlcipher</code>可执行文件：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055403556-233d2ce354ae18db283301899741d5f71fdf97cf2e450720d3cfdafe1d7d9dfe.png" alt="picture 26" class="img_vXGZ"></p><p><del>以上就代表我们的编译过程顺利完成。</del></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="update-静态编译">UPDATE: 静态编译<a class="hash-link" href="#update-静态编译" title="标题的直接链接">​</a></h3><p>刚刚那个编译好像属于动态编译，后续我在编译 python 版本的<code>pysqlcipher3</code>的时候又出现了<code>ld: library not found for -lsqlcipher</code>的问题：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644072227306-9e8a15ed18d00cf7f3ecbfc851c171be72a16050db5299a7cd2782fc6486f870.png" alt="picture 43" class="img_vXGZ"></p><p>所以还是静态编译可能比较好。</p><p>重新回顾一下 <code>sqlcipher</code> 的编译教程，我们只需要知道 <code>libcrypto.a</code>的位置就可以了。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644072262710-734053d18c0c275c54731dc02801ef8d262fba116ac73c43b178013672cd1ba5.png" alt="picture 44" class="img_vXGZ"></p><p>（南川）注意看我是怎么找到 <code>libcrypto.a</code>的位置的，当我只知道他在<code>Cellar</code>下的时候。(其中的<code>realpath</code>命令需要<code>brew install coreutils</code>)</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644072356870-5e184b304747b5c39a498bf21f082075707a60d05890f8ef7fb270cefadb0362.png" alt="picture 45" class="img_vXGZ"></p><p>接着拷贝该位置到安装参数内。</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">(.pyenv) ➜  sqlcipher git:(master) ✗ ./configure --enable-tempstore=yes CFLAGS=&quot;-DSQLITE_HAS_CODEC&quot; LDFLAGS=&quot;/usr/local/Cellar/openssl@3/3.0.1/lib/libcrypto.a&quot;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>但是报错了：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644072484888-a542b44050c96501a77a271bc4b8b68fc56e34f76dd64ff798a7c9f3b7b09f24.png" alt="picture 46" class="img_vXGZ"></p><p>这个问题其实正好就是我们动态编译错过了的但是博主碰到了的问题:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644072522514-62b7f0b1639d262ede4547456661b328e4a6b32fae6c5cace9256df1236fd2e3.png" alt="picture 47" class="img_vXGZ"></p><p>跟着他的经验，也别管他的命令行怎么写的，加上参数：</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">(.pyenv) ➜  sqlcipher git:(master) ✗ ./configure --enable-tempstore=yes CFLAGS=&quot;-DSQLITE_HAS_CODEC&quot; LDFLAGS=&quot;/usr/local/Cellar/openssl@3/3.0.1/lib/libcrypto.a&quot; --with-crypto-lib=none</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>立即通过！然后再运行<code>make install</code>即可。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644072591630-f4c7e1aab4353c3361db72feda9d9bbe9ff572006e4e2424c3625a65c7cc6f62.png" alt="picture 48" class="img_vXGZ"></p><p>注意，<code>install</code>之后，可以看到，其实是把<code>libsqlcipher.a</code>等写入到了<code>/usr/local/lib</code>下面，这个路径要记得，以后其他库一般也会编到这里。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="test-sqlcipher-workflow">test <code>sqlcipher</code> workflow<a class="hash-link" href="#test-sqlcipher-workflow" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_rB0w" id="step-1-crypto-a-plain-database-which-is-generated-by-our-sqlite-before">step 1. crypto a plain database (which is generated by our <code>sqlite</code> before)<a class="hash-link" href="#step-1-crypto-a-plain-database-which-is-generated-by-our-sqlite-before" title="标题的直接链接">​</a></h4><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055516480-7d258b2f3f5c95b8ae22647f6b0221200e0458f1c70f73b597b2b2ee2491dcab.png" alt="picture 27" class="img_vXGZ"></p><p>Among the commands, the <code>attach database XXX as encrypted key YYY</code> would generate a database named XXX, which is encrypted by key YYY.</p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="step2-test-operate-on-an-encrypted-database-without-key-expect-failure">step2. test: operate on an encrypted database without key (expect: failure)<a class="hash-link" href="#step2-test-operate-on-an-encrypted-database-without-key-expect-failure" title="标题的直接链接">​</a></h4><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055718135-17c2ee6027d75abc6637815f057703e25bde0b4bac6d8c31a03694dd5d919c73.png" alt="picture 28" class="img_vXGZ"></p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="step3-test-dump-the-encrypted-database-into-plain-with-key-expect-success">step3. test: dump the encrypted database into plain with key (expect: success)<a class="hash-link" href="#step3-test-dump-the-encrypted-database-into-plain-with-key-expect-success" title="标题的直接链接">​</a></h4><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055830760-6cd688ede765164c9a10e49ba478e98036e517d06d121f8b8f1a222f58d316b1.png" alt="picture 29" class="img_vXGZ"></p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="step4-test-open-the-decrypted-database-without-key-expect-success">step4. test: open the decrypted database without key (expect: success)<a class="hash-link" href="#step4-test-open-the-decrypted-database-without-key-expect-success" title="标题的直接链接">​</a></h4><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644055943131-58c01e04c45846d54c782180d6489b888c3cf84e843252a71be57c6520f78a1c.png" alt="picture 30" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="-decrypt-database">✨✨ decrypt database<a class="hash-link" href="#-decrypt-database" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_rB0w" id="depreciated-pragma-config-of-sqlcipher-3-defaults">DEPRECIATED: pragma config of sqlcipher 3 defaults<a class="hash-link" href="#depreciated-pragma-config-of-sqlcipher-3-defaults" title="标题的直接链接">​</a></h4><p>!!!warning 我的 <code>sqlcipher</code> 版本是 <code>3.36.0</code>，这个版本默认是 <code>sqlcipher 4</code>的配置了（盲猜），而腾讯的加密用的是 <code>sqlcipher 3</code>，所以在解密文件时，必须将配置都对上（可以按照 GUI 软件<code>DB Browser for SQLite</code>一一对上），否则会出现<code>file is not a database</code> 或 <code>out of memory</code>等错误</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644067587138-c2f6c561a856b4619f0fafb2c31d203c22ae2220fe6fe31f89d3b1c6dc18848f.png" alt="picture 31" class="img_vXGZ"></p><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">PRAGMA cipher_compatibility </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRAGMA kdf_algorithm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRAGMA hmac_algorithm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRAGMA kdf_iter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRAGMA cipher_page_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>ref</p></blockquote><ul><li><p>core ref of pragma statements, especially sqlcipher relative: <a href="https://utelle.github.io/SQLite3MultipleCiphers/docs/configuration/config_sql_pragmas/#pragma-hmac_algorithm" target="_blank" rel="noopener noreferrer">SQL Pragmas | SQLite3 Multiple Ciphers</a></p></li><li><p>tencent forked sqlcipher: <a href="https://github.com/Tencent/sqlcipher/tree/4f37c817eb99e18e4fdc8ac63d67ac33610d66be" target="_blank" rel="noopener noreferrer">Tencent/sqlcipher at 4f37c817eb99e18e4fdc8ac63d67ac33610d66be</a></p></li></ul><h4 class="anchor anchorWithStickyNavbar_rB0w" id="best-practice-pragma-config-of-sqlcipher-3-defaults">BEST-PRACTICE: pragma config of sqlcipher 3 defaults<a class="hash-link" href="#best-practice-pragma-config-of-sqlcipher-3-defaults" title="标题的直接链接">​</a></h4><p>As mentioned at: - <a href="https://github.com/rigglemania/pysqlcipher3#sqlcipher-compatibility-issues" target="_blank" rel="noopener noreferrer">rigglemania/pysqlcipher3: Python 3 bindings for SQLCipher</a>, we only need to add one line of <code>PRAGMA cipher_compatibility = 3&quot;</code> after setting <code>&quot;PRAGMA key=&#x27;password&#x27;&quot;</code>.</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644069999876-2b5aae9410cd1110098e3247594c549654da13532919c803314c43565f10892e.png" alt="picture 40" class="img_vXGZ"></p><p>Here is the tested result:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644070069597-642a02966f92de01abff3777591606fdab3c9da26e799787a5d6d26fdf3d5d4b.png" alt="picture 41" class="img_vXGZ"></p><h4 class="anchor anchorWithStickyNavbar_rB0w" id="check-salt-of-specific-database-file">check salt of specific database file<a class="hash-link" href="#check-salt-of-specific-database-file" title="标题的直接链接">​</a></h4><blockquote><p>usage</p></blockquote><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">xxd -p -l 16 -g 0 &#x27;/path/to/foo.db&#x27;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>sample</p></blockquote><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644068254533-1ea78ae0e60ab131144b0ea1cb30d1e9d1e3c1cab3729dccc2ae528c540cf0c7.png" alt="picture 32" class="img_vXGZ"></p><blockquote><p>verification</p></blockquote><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644068327704-ea3ee6ac4f1ecbfceb32f370d0b07091175e6cf250a7c588391b197e4a0c613c.png" alt="picture 34" class="img_vXGZ"></p><blockquote><p>ref</p></blockquote><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644068275641-5eb58026ca08887af94f8d62444540ba7a649c2ff06f7359b5280efeaf6b472e.png" alt="picture 33" class="img_vXGZ"></p><ul><li><a href="https://github.com/nalzok/wechat-decipher-macos/blob/main/macos/dbcracker.d" target="_blank" rel="noopener noreferrer">wechat-decipher-macos/dbcracker.d at main · nalzok/wechat-decipher-macos</a></li></ul><h4 class="anchor anchorWithStickyNavbar_rB0w" id="decrypt-and-dump-specific-database-file">decrypt and dump specific database file<a class="hash-link" href="#decrypt-and-dump-specific-database-file" title="标题的直接链接">​</a></h4><ol><li>open our custom hook script and get the database secret info:</li></ol><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644068620611-aa198000c76e33c4b248a05589b2d22107ad3339584f55104ef9105be3efc2f7.png" alt="picture 35" class="img_vXGZ"></p><ol start="2"><li><p>copy the <code>PRAGMA XXX</code> statements for specific database file</p></li><li><p>dump specific database file after decrypting</p></li></ol><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">ATTACH </span><span class="token keyword" style="color:#00009f">DATABASE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;plaintext.db&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> plaintext </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> sqlcipher_export</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;plaintext&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DETACH </span><span class="token keyword" style="color:#00009f">DATABASE</span><span class="token plain"> plaintext</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644069059270-6a17772f3571e1d5243cd8e94ec3a554277c5b01624e3c665f89072fffcee427.png" alt="picture 37" class="img_vXGZ"></p><blockquote><p>ref</p></blockquote><ul><li>How to decrypt the sqlcipher, when the version matches<a href="https://stackoverflow.com/questions/25132477/how-to-decrypt-an-encrypted-sqlcipher-database-file-on-command-line/53616126" target="_blank" rel="noopener noreferrer">encryption - How to decrypt an encrypted sqlcipher database file on command line? - Stack Overflow</a></li></ul><h4 class="anchor anchorWithStickyNavbar_rB0w" id="test-dumped-database-file-via-sqlcipher-or-sqlite3">test dumped database file (via <code>sqlcipher</code> or <code>sqlite3</code>)<a class="hash-link" href="#test-dumped-database-file-via-sqlcipher-or-sqlite3" title="标题的直接链接">​</a></h4><p>Since the database dumped has been decrypted, so using <code>sqlcipher</code> or <code>sqlite3</code> are both ok!</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644069170316-b3039faeffce4fa085668bb405c45b50a50f5a8721536caa6ca9f800837f0834.png" alt="picture 38" class="img_vXGZ"></p><p>!!!tip As a contrary, if we using <code>sqlite3</code> to open an encrypted database file, then the <code>PRAGMA</code> commands are always invalid, and there would be no way to decrypt the database.</p><div class="codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-text codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">![picture 39](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644069321523-f78eba6a3271f2e2e9cf3c2c04a83fda5e5d6e26f5289e3d3b82ad09af2bd042.png)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_rB0w" id="wechat-design">wechat design<a class="hash-link" href="#wechat-design" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="design-of-contact-fields">design of contact fields<a class="hash-link" href="#design-of-contact-fields" title="标题的直接链接">​</a></h3><p>以某好友资料为例：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644086442066-c16483c3e89a04c951579e2b136fb4aa69ec438102d180434d3508fb8f2c50b5.png" alt="picture 62" class="img_vXGZ"></p><p>对应的可以看到数据表信息为：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644086957667-465fd289b2ac61137c90a5b656c0f8275a4f9a6b5e808bbda57c041373dc2b07.png" alt="picture 64" class="img_vXGZ"></p><p>可以知道，最有用的字段主要如下：</p><div class="language-yaml codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-yaml codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">gUsrName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> wxid（自动、唯一标识号）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">m_nsAliasName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 好友的注册id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">nickname</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 好友自己设置的对外显示的昵称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">m_nsRemark</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 你给好友设置的备注</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其他还有一些拼音相关的有时也比较适合模糊搜索，不过全拼和简拼比较适合中文，英文的话全拼不变，简拼没有（另外也可以看到腾讯的命名规则也不统一，并且还中英文混杂……）：</p><div class="language-yaml codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-yaml codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">m_nsFullPY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 好友昵称全拼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">m_nsShortPY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 好友昵称简拼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">m_nsRemarkPYFull</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 好友备注全拼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">m_nsRemarkPYShort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 好友备注简拼</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_rB0w" id="design-of-user-id-to-contact-id-md5">design of user id to contact id: <code>md5</code><a class="hash-link" href="#design-of-user-id-to-contact-id-md5" title="标题的直接链接">​</a></h3><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644079452379-26017062b0f1704882f915ce6b46afb628ae66436219c84107b993379d33363a.png" alt="picture 51" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644079510590-162cac11502d48cb7941365f272d807dbaeff5cf45edcad396ea28f9d3f3daf3.png" alt="picture 52" class="img_vXGZ"></p><blockquote><p>ref</p></blockquote><ul><li><a href="https://1024tools.com/hash" target="_blank" rel="noopener noreferrer">Hash 在线计算、md5 计算、sha1 计算、sha256 计算、sha512 计算 - 1024Tools</a></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="improve-get-self-id">IMPROVE: get self id<a class="hash-link" href="#improve-get-self-id" title="标题的直接链接">​</a></h3><p>搜索自己的昵称，但是发现没有找到，说明<code>contact</code>表里是没有自己的。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644087070913-43f45ddeca29b284c48142f4d56ed38cf00132bb42ae7429702b35306c5fcedd.png" alt="picture 65" class="img_vXGZ"></p><p>所以，我们需要知道自己的 id 信息在哪里获取。</p><p>UPDATE-2022-02-06：聊天文件是以聊天对象的 md5 值作为数据库名存储的，尽管在聊天记录中基于你和对象的微信 id 使用了一个字段表示聊天方向，但同时还有另外一个整型字段标志着是否是自己，所以尽管在联系人数据库中找不到自己的 id，但不影响对聊天记录中聊天方向的识别。</p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="todo-get-image-from-xml">TODO: get image from xml<a class="hash-link" href="#todo-get-image-from-xml" title="标题的直接链接">​</a></h3><p>要遍历本地找！</p><blockquote><p>sample</p></blockquote><div class="language-xml codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-xml codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- StrRes1 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span class="token plain">\n</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">msg</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n\t</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">aeskey</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">252260f7cd231a2ee75e997483fdbe26</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">encryver</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnthumbaeskey</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">252260f7cd231a2ee75e997483fdbe26</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnthumburl</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">3059020100045230500201000204d3e741cc02030f5bd102041be0cdcb020461fd7c48042b777875706c6f61645f777869645f636b3835787570386231626a32315f3335395f313634343030323337330204011d0a020201000400</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnthumblength</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">2906</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnthumbheight</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">120</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnthumbwidth</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">55</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnmidheight</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnmidwidth</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnhdheight</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnhdwidth</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">cdnmidimgurl</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">3059020100045230500201000204d3e741cc02030f5bd102041be0cdcb020461fd7c48042b777875706c6f61645f777869645f636b3835787570386231626a32315f3335395f313634343030323337330204011d0a020201000400</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">length</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">md5</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">ac0d0d7ae1c546233d2dd8bdfbaa9d37</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">hevc_mid_size</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">77982</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain">\n</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">msg</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-xml codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-xml codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- messageType --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">msgsource</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n\t</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">bizflag</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">bizflag</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n\t</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">sec_msg_node</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n\t\t</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">uuid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">e78ea49721c227614ead30b94f1dea68_</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">uuid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n\t</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">sec_msg_node</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n\t</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">signature</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">v1_IC/iNhD5</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">signature</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">msgsource</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">\n</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>ref</p></blockquote><ul><li>windows version: <a href="https://bbs.125.la/thread-14304868-1-1.html" target="_blank" rel="noopener noreferrer">微信 hook 收到的图片消息怎么转换成图片呢<!-- -->_<!-- -->精易论坛</a></li></ul><h2 class="anchor anchorWithStickyNavbar_rB0w" id="py-sqlcipher-instruction">py-sqlcipher instruction<a class="hash-link" href="#py-sqlcipher-instruction" title="标题的直接链接">​</a></h2><blockquote><p>core ref</p></blockquote><ul><li><p><a href="https://github.com/rigglemania/pysqlcipher3" target="_blank" rel="noopener noreferrer">rigglemania/pysqlcipher3: Python 3 bindings for SQLCipher</a></p></li><li><p><a href="https://charlesleifer.com/blog/encrypted-sqlite-databases-with-python-and-sqlcipher/" target="_blank" rel="noopener noreferrer">charles leifer | Encrypted SQLite Databases with Python and SQLCipher</a></p></li><li><p><a href="https://www.runoob.com/sqlite/sqlite-python.html" target="_blank" rel="noopener noreferrer">SQLite – Python | 菜鸟教程</a></p></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="compile">compile<a class="hash-link" href="#compile" title="标题的直接链接">​</a></h3><p>编译步骤永远都是最烦的哎，不过还好都顺利通过了。</p><p>首先是下载源代码。</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/rigglemania/pysqlcipher3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd pysqlcipher3</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644135188856-49a3c5122a1ed7c310f07f68401278000dd70331083c333a7e55789ec6f0f97f.png" alt="picture 80" class="img_vXGZ"></p><p>其次是编译，有两种方案。</p><p><del>由于我现在系统中已经静态编译过 <code>sqlcipher</code> 已经有了 <code>libsqlcipher</code>，所以我直接<code>python setup.py install</code> 就能成功。</del></p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">find /usr/local/lib -name libsqlcipher.a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># output: /usr/local/lib/libsqlcipher.a</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644135240001-f7a7915f534bb6401b77ab8ddbb6b6d02d26e50868e209c415eb755377ab7a07.png" alt="picture 81" class="img_vXGZ"></p><p>否则的话，我需要把在 <code>sqlcipher</code> 动态编译产生的 <code>sqlite.[ch]</code> 文件都拷贝到当前目录下。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644135275190-5f582dbc1de9d6719751b59ae25a5141f99dd7d5153c3a59cce7ac8636f89715.png" alt="picture 82" class="img_vXGZ"></p><p>再编译<code>python setup.py build_amalgamation</code>又会发现<code>src/python3/connection.h</code>报错找不到<code>sqlcipher.h</code>了。</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644135531747-a3367cfc37c9ea6b6cd703b9c6ca2226d37e63863a7a87ce408584f09bb0fdd5.png" alt="picture 83" class="img_vXGZ"></p><p>所以我们再……把 <code>amalgamation</code> 文件夹拷贝到 <code>src/python3/</code>下，并重命名为<code>sqlcipher</code>……（真忙啊……）</p><p>然后编译：</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">python setup.py build_amalgamation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python setup.py install</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>成功通过！</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644135629542-210ab9f8ec0d0f66cc1175fac733cb59b5afd897a7485eef8b0a402f24b8bd27.png" alt="picture 84" class="img_vXGZ"></p><p>这样，你才能在 python 中使用 <code>from pysqlcipher3 import dbapi2 as sqlite</code>。</p><p>测试是否有 <code>pysqlcipher</code>：</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644135674098-023717b49ca1c8d9104288088799b163690013c4c3004efffec37fa333576f1f.png" alt="picture 85" class="img_vXGZ"></p><h3 class="anchor anchorWithStickyNavbar_rB0w" id="connection">connection<a class="hash-link" href="#connection" title="标题的直接链接">​</a></h3><p>如果是已解密/未加密的数据库，则使用 <code>sqlite3</code> 或者 <code>sqlcipher</code> 皆可。d</p><p>但如果是加密的数据库，则必须使用 <code>sqlcipher</code> 进入解密。</p><p>以下皆以 <code>sqlcipher</code> 演示。</p><p>命令行版：</p><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 一句话搞定</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlcipher DB</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">PATH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 验证</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> PRAGMA </span><span class="token keyword" style="color:#00009f">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;XXXX&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> PRAGMA cipher_compatibility </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 测试</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>python 版：</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Python 3.9.10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pysqlcipher3 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> dbapi2 </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sqlite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pysqlcipher3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dbapi2 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">auth_db</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ddb_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> db_key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Connection</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;dp_path&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> db_path</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sqlite</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">db_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;PRAGMA key = &quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">db_key</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;PRAGMA cipher_compatibility = 3;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">commit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;authenticated </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">db_file</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> conn</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_rB0w" id="table">table<a class="hash-link" href="#table" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_rB0w" id="list-all-the-tables">list all the tables<a class="hash-link" href="#list-all-the-tables" title="标题的直接链接">​</a></h4><p>If you are using pure <code>sqlite/sqlcipher</code>, then using <code>.tables</code> can list all the tables. However, it won&#x27;t in the py program.</p><p>In programme, I need to using the following:</p><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> name </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> sqlite_master </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;table&quot;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And the python may be:</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">tables </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;SELECT name FROM sqlite_master WHERE type = &quot;table&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And the sample result of tx-contact table is:</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644075446587-2f42b7d6a6f49cf9436ac7617a6dd20a65954db0da8d17f1967fb36032097367.png" alt="picture 49" class="img_vXGZ"></p><blockquote><p>ref</p></blockquote><ul><li><a href="https://stackoverflow.com/questions/82875/how-can-i-list-the-tables-in-a-sqlite-database-file-that-was-opened-with-attach" target="_blank" rel="noopener noreferrer">sql - How can I list the tables in a SQLite database file that was opened with ATTACH? - Stack Overflow</a></li></ul><h4 class="anchor anchorWithStickyNavbar_rB0w" id="list-the-columns-of-table-get-table-schema">list the columns of table (get table schema)<a class="hash-link" href="#list-the-columns-of-table-get-table-schema" title="标题的直接链接">​</a></h4><p>In sql, we can use:</p><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- to list all the tables in the database:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- to show the schema for a given tablename:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">schema</span><span class="token plain"> tablename</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Otherwise:</p><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">PRAGMA table_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And to get column names in py:</p><div class="language-py codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-py codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;PRAGMA table_info(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">table_name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>ref</p></blockquote><ul><li><a href="https://www.sqlitetutorial.net/sqlite-tutorial/sqlite-describe-table/" target="_blank" rel="noopener noreferrer">SQLite Describe Table</a></li></ul><h4 class="anchor anchorWithStickyNavbar_rB0w" id="format-rows-display">format rows display<a class="hash-link" href="#format-rows-display" title="标题的直接链接">​</a></h4><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- to show current configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- to show rows of columns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">headers </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">mode</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">columns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nullvalue </span><span class="token operator" style="color:#393A34">-</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>ref</p></blockquote><ul><li><p><a href="https://dba.stackexchange.com/questions/40656/how-to-properly-format-sqlite-shell-output" target="_blank" rel="noopener noreferrer">How to properly format sqlite shell output? - Database Administrators Stack Exchange</a></p></li><li><p><a href="https://dba.stackexchange.com/questions/40656/how-to-properly-format-sqlite-shell-output/219988" target="_blank" rel="noopener noreferrer">How to properly format sqlite shell output? - Database Administrators Stack Exchange</a></p></li><li><p><a href="http://www.infinitezest.com/articles/creating-user-friendly-output-from-sqlite.aspx" target="_blank" rel="noopener noreferrer">infiniteZest.com: Creating User Friendly Output from SQLite</a></p></li><li><p><a href="https://stackoverflow.com/questions/947215/how-to-get-a-list-of-column-names-on-sqlite3-database" target="_blank" rel="noopener noreferrer">sqlite - How to get a list of column names on Sqlite3 database? - Stack Overflow</a></p></li></ul><h4 class="anchor anchorWithStickyNavbar_rB0w" id="list-rows-in-one-table">list rows in one table<a class="hash-link" href="#list-rows-in-one-table" title="标题的直接链接">​</a></h4><div class="language-sql codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sql codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> XXXTABLE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- limit rows, skip/offset rows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LIMIT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">OFFSET</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>sample</p></blockquote><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644075527796-64ff73b5b33e8d861f0fa9ccc81f5329e323e459977abe720cfed5e7e7ee8b91.png" alt="picture 50" class="img_vXGZ"></p><blockquote><p>ref</p></blockquote><ul><li><a href="https://stackoverflow.com/questions/10491492/sqlite-with-skip-offset-only-not-limit" target="_blank" rel="noopener noreferrer">SQLite with skip (offset) only (not limit) - Stack Overflow</a></li></ul><h2 class="anchor anchorWithStickyNavbar_rB0w" id="extended">extended<a class="hash-link" href="#extended" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rB0w" id="how-to-know-my-openssl-versioninfo">how to know my openssl version/info<a class="hash-link" href="#how-to-know-my-openssl-versioninfo" title="标题的直接链接">​</a></h3><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl version -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LibreSSL 2.8.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">built on: date not available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">platform: information not available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options:  bn(64,64) rc4(16x,int) des(idx,cisc,16,int) blowfish(idx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">compiler: information not available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPENSSLDIR: &quot;/private/etc/ssl&quot;</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>the <code>OPENSSLDIR</code> is the config info for openssl other than the src files.</p><div class="language-sh codeBlockContainer_jDV4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vx7S"><pre tabindex="0" class="prism-code language-sh codeBlock_Gebt thin-scrollbar"><code class="codeBlockLines_FJaf"><span class="token-line" style="color:#393A34"><span class="token plain">$ tree /private/etc/ssl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/private/etc/ssl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── cert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── certs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── openssl.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── x509v3.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 directory, 3 files</span><br></span></code></pre><div class="buttonGroup_cUGO"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_OqsO" aria-hidden="true"><svg class="copyButtonIcon_PgCn" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_bsQG" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And as mentioned from <a href="https://blog.csdn.net/u011195398/article/details/85266214" target="_blank" rel="noopener noreferrer">Mac 终端使用 Sqlcipher 加解密基础过程详解<!-- -->_<!-- -->Martin.Mu `s Special Column-CSDN 博客<!-- -->_<!-- -->mac sqlcipher</a>, the built-in <code>openssl</code> on MacOS may not be suitable for our project target.</p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644050865960-53d51937372a7a78dc69ae4400596947dff31b8a528f5344aff55677334f6d3e.png" alt="picture 13" class="img_vXGZ"></p><blockquote><p>ref</p></blockquote><ul><li><a href="https://phoenixnap.com/kb/how-to-check-openssl-version" target="_blank" rel="noopener noreferrer">How to Check or Find the OpenSSL Version Easy Way</a></li></ul><h3 class="anchor anchorWithStickyNavbar_rB0w" id="bugfix-error-c-compiler-cannot-create-executables">bugfix: <code>error: C compiler cannot create executables</code><a class="hash-link" href="#bugfix-error-c-compiler-cannot-create-executables" title="标题的直接链接">​</a></h3><blockquote><p>ref</p></blockquote><ul><li><p>一个 mac 用户碰到了这个问题，然后在 github 询问：<a href="https://github.com/sqlcipher/sqlcipher/issues/378" target="_blank" rel="noopener noreferrer">Installation on MacOS Catalina, C compiler cannot create executables · Issue #378 · sqlcipher/sqlcipher</a></p></li><li><p>上个用户被开发者劝退，说来这里问，但是这里没有得到回复😢：<a href="https://discuss.zetetic.net/t/sqlcipher-installation-on-macos-catalina-c-compiler-cannot-create-executables/4807" target="_blank" rel="noopener noreferrer">SQLCipher Installation on MacOS Catalina, C compiler cannot create executables - SQLCipher - Zetetic Community Discussion</a></p></li><li><p>这里看起来讨论的更热烈些，但和 <code>sqlcipher</code>无关： <a href="https://askubuntu.com/questions/647583/how-to-fix-configure-error-c-compiler-cannot-create-executables" target="_blank" rel="noopener noreferrer">command line - how to fix configure: error: C compiler cannot create executables - Ask Ubuntu</a></p></li></ul><h2 class="anchor anchorWithStickyNavbar_rB0w" id="本项目合作伙伴">本项目合作伙伴<a class="hash-link" href="#本项目合作伙伴" title="标题的直接链接">​</a></h2><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644139731203-958d64fdabac5af3a2cfdd96b1bf5d863b81d1363f8b116649256388ae8ae438.png" alt="某攻防工程师，w哥" class="img_vXGZ"></p><p><img loading="lazy" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/mac-wechat-hack-1644139704659-4a00c03e7eed677c88c5d56b7e6853eef631a646b24f5e4dab2f9ad1d0884d25.png" alt="某支持工程师，z妹" class="img_vXGZ"></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_WmAe"><div class="col margin-top--sm"><a href="https://github.com/markshawn2020/docusaurus/edit/master/my-documents/blog/2022/08-01-wechat-hack.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_IMw_" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2022/08/03/taiwan-data-research"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">关于台湾进出口临时政策与历史数据的研究</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2022/07/11/prose-I-am-me"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">札记 | 我与我周旋久，我亦是我</div></a></nav></main><div class="col col--2"><div class="tableOfContents_RLlU thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#项目展示" class="table-of-contents__link toc-highlight">项目展示</a><ul><li><a href="#获取所有微信好友信息" class="table-of-contents__link toc-highlight">获取所有微信好友信息</a></li><li><a href="#导出与微信好友的聊天记录" class="table-of-contents__link toc-highlight">导出与微信好友的聊天记录</a></li><li><a href="#监控实时聊天" class="table-of-contents__link toc-highlight">监控实时聊天</a></li><li><a href="#其他" class="table-of-contents__link toc-highlight">其他</a></li></ul></li><li><a href="#动机背景" class="table-of-contents__link toc-highlight">动机背景</a></li><li><a href="#技术概览" class="table-of-contents__link toc-highlight">技术概览</a><ul><li><a href="#github-search-until-wechat-decipher-macos" class="table-of-contents__link toc-highlight">github search until <code>wechat-decipher-macos</code></a></li><li><a href="#macoseavesdropperd" class="table-of-contents__link toc-highlight"><code>macos/eavesdropper.d</code></a></li><li><a href="#macosdbcrackerd" class="table-of-contents__link toc-highlight"><code>macos/dbcracker.d</code></a></li><li><a href="#pcbakchatgatherd" class="table-of-contents__link toc-highlight"><code>pcbakchat/gather.d</code></a></li><li><a href="#develxloggerd" class="table-of-contents__link toc-highlight"><code>devel/xlogger.d</code></a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li><li><a href="#update2022-02-08-关于加密字段" class="table-of-contents__link toc-highlight">update@2022-02-08: 关于加密字段</a></li></ul></li><li><a href="#reference" class="table-of-contents__link toc-highlight">reference</a><ul><li><a href="#各大平台仓库合集" class="table-of-contents__link toc-highlight">各大平台仓库合集</a></li><li><a href="#mac-版" class="table-of-contents__link toc-highlight">mac 版</a></li><li><a href="#windows-版" class="table-of-contents__link toc-highlight">windows 版</a></li><li><a href="#ios-版" class="table-of-contents__link toc-highlight">ios 版</a></li><li><a href="#sqlcipher-相关" class="table-of-contents__link toc-highlight"><code>sqlcipher</code> 相关</a></li><li><a href="#pragma-相关" class="table-of-contents__link toc-highlight"><code>pragma</code> 相关</a></li><li><a href="#frida-相关" class="table-of-contents__link toc-highlight"><code>frida</code> 相关</a></li></ul></li><li><a href="#hack-manual" class="table-of-contents__link toc-highlight">hack manual</a><ul><li><a href="#download-sqlite" class="table-of-contents__link toc-highlight">download sqlite</a></li><li><a href="#test-sqlite" class="table-of-contents__link toc-highlight">test sqlite</a></li><li><a href="#install-openssl-to-replace-the-built-in-libressl-on-macos" class="table-of-contents__link toc-highlight">install <code>openssl</code> to replace the built-in <code>libressl</code> on MacOS</a></li><li><a href="#compile-sqlcipher" class="table-of-contents__link toc-highlight">compile <code>sqlcipher</code></a></li><li><a href="#update-静态编译" class="table-of-contents__link toc-highlight">UPDATE: 静态编译</a></li><li><a href="#test-sqlcipher-workflow" class="table-of-contents__link toc-highlight">test <code>sqlcipher</code> workflow</a></li><li><a href="#-decrypt-database" class="table-of-contents__link toc-highlight">✨✨ decrypt database</a></li></ul></li><li><a href="#wechat-design" class="table-of-contents__link toc-highlight">wechat design</a><ul><li><a href="#design-of-contact-fields" class="table-of-contents__link toc-highlight">design of contact fields</a></li><li><a href="#design-of-user-id-to-contact-id-md5" class="table-of-contents__link toc-highlight">design of user id to contact id: <code>md5</code></a></li><li><a href="#improve-get-self-id" class="table-of-contents__link toc-highlight">IMPROVE: get self id</a></li><li><a href="#todo-get-image-from-xml" class="table-of-contents__link toc-highlight">TODO: get image from xml</a></li></ul></li><li><a href="#py-sqlcipher-instruction" class="table-of-contents__link toc-highlight">py-sqlcipher instruction</a><ul><li><a href="#compile" class="table-of-contents__link toc-highlight">compile</a></li><li><a href="#connection" class="table-of-contents__link toc-highlight">connection</a></li><li><a href="#table" class="table-of-contents__link toc-highlight">table</a></li></ul></li><li><a href="#extended" class="table-of-contents__link toc-highlight">extended</a><ul><li><a href="#how-to-know-my-openssl-versioninfo" class="table-of-contents__link toc-highlight">how to know my openssl version/info</a></li><li><a href="#bugfix-error-c-compiler-cannot-create-executables" class="table-of-contents__link toc-highlight">bugfix: <code>error: C compiler cannot create executables</code></a></li></ul></li><li><a href="#本项目合作伙伴" class="table-of-contents__link toc-highlight">本项目合作伙伴</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Core</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/archive">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Docusaurus</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/category/guides" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://joshcena.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Case: Joshua Chen<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://vercel.com/markshawn2020/docusaurus/deployments" target="_blank" rel="noopener noreferrer" class="footer__link-item">Vercel Deploy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://analytics.google.com/analytics/web/#/p324822374/reports/reportinghub?params=_u.dateOption%3DthisWeekSatToToday" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Analytics<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ap-east-1.console.aws.amazon.com/ec2/home?region=ap-east-1#InstanceDetails:instanceId=i-02fffe2800e2025e1" target="_blank" rel="noopener noreferrer" class="footer__link-item">AWS EC2 Monitor (VPN)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Rdzz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.aacdcb6f.js"></script>
<script src="/assets/js/main.c22735e8.js"></script>
</body>
</html>